<!-- Styles specific to Employee Scheduling -->
<style>
    /* ... (نفس كود الـ CSS) ... */
</style>

<!-- This container will be inserted into dash.html's #featureSections -->
<div class="employee-schedule-body">
    <!-- Main Content -->
    <div class="main-container">
        <div class="page-header">
            <h1 class="page-title">Employee Schedule (Simplified V4)</h1>
        </div>
        <div class="schedule-controls">
            <div class="week-navigation">
                <button class="btn btn-outline" id="schedule-prevWeekBtn" disabled><i class="fas fa-chevron-left"></i></button>
                <div class="week-display" id="schedule-weekDisplay">Waiting for JS...</div>
                <button class="btn btn-outline" id="schedule-nextWeekBtn" disabled><i class="fas fa-chevron-right"></i></button>
            </div>
        </div>
        <div class="schedule-container">
            <table class="schedule-table">
                <thead>
                    <tr><th>Employee</th><th>Mon</th><th>Tue</th><th>Wed</th><th>Thu</th><th>Fri</th><th>Sat</th><th>Sun</th></tr>
                </thead>
                <tbody id="schedule-table-body">
                    <tr><td colspan="8" style="text-align: center; padding: 2rem; color: var(--gray);">Waiting for JS execution...</td></tr>
                </tbody>
            </table>
        </div>
    </div>
</div> <!-- End of .employee-schedule-body -->

<script>
    // Put a log *outside* any function first. Does this even appear?
    console.log("!!! [SIMPLIFIED V4] Script tag STARTING to parse !!!");

    finitializeEmployeeSchedule(
  { id: 1, name: 'Admin', role: 'admin' },
  [
    { id: 101, name: 'Ahmed Ali', email: 'ahmed@test.com' },
    { id: 102, name: 'Sara Hassan', email: 'sara@test.com' }
  ]
);


        // Check for dashboardApp just in case
        if (typeof window.dashboardApp?.showErrorMessage !== 'function') {
             console.error("[SIMPLIFIED V4] dashboardApp or showErrorMessage is missing!");
             alert("CRITICAL ERROR: dashboardApp missing!"); // Fallback alert
             return;
        }
        const showErrorMessage = window.dashboardApp.showErrorMessage;
        console.log("[SIMPLIFIED V4] dashboardApp seems ok.");

        // Find elements *immediately* and log results
        // Use a slight delay before trying to access DOM elements fully
        setTimeout(() => {
            console.log("[SIMPLIFIED V4 - Timeout] Attempting to find elements...");
            const weekDisplay = document.getElementById('schedule-weekDisplay');
            const scheduleTableBody = document.getElementById('schedule-table-body');
            console.log("[SIMPLIFIED V4 - Timeout] Finding elements results:", { weekDisplay, scheduleTableBody });

            if (!weekDisplay || !scheduleTableBody) {
                console.error("[SIMPLIFIED V4 - Timeout] Critical elements weekDisplay or scheduleTableBody NOT FOUND!");
                showErrorMessage("Error: Schedule UI elements could not be found even after delay.");
                // Try updating a known element for visual feedback
                 const titleElement = document.querySelector('.employee-schedule-body .page-title');
                 if (titleElement) titleElement.innerHTML += ' <span style="color:red;">(Error finding elements!)</span>';
                return;
            }
            console.log("[SIMPLIFIED V4 - Timeout] Essential elements found.");

            // Start the main logic within a try block
            try {
                console.log("[SIMPLIFIED V4 - Timeout] Entering try block...");

                // 1. Update Week Display
                console.log("[SIMPLIFIED V4 - Timeout] Attempting to update week display...");
                weekDisplay.textContent = "Week Display OK (V4)"; // Changed text
                console.log("[SIMPLIFIED V4 - Timeout] Week display updated.");

                // 2. Clear Table Body
                console.log("[SIMPLIFIED V4 - Timeout] Attempting to clear table body...");
                scheduleTableBody.innerHTML = ''; // Clear "Waiting..." message
                console.log("[SIMPLIFIED V4 - Timeout] Table body cleared.");

                // 3. Define Fake Employee Data
                const fakeEmployees = [ { id: 1, name: "Tester Alpha" }, { id: 2, name: "Tester Beta" } ];
                console.log("[SIMPLIFIED V4 - Timeout] Using fake data:", fakeEmployees);

                // 4. Render Fake Data
                console.log("[SIMPLIFIED V4 - Timeout] Attempting to render fake data...");
                fakeEmployees.forEach((employee, index) => {
                    const tr = document.createElement('tr');
                    const nameTd = document.createElement('td');
                    nameTd.className = `employee-name employee-${index + 1}`;
                    nameTd.textContent = employee.name;
                    tr.appendChild(nameTd);
                    for (let i = 0; i < 7; i++) {
                        const td = document.createElement('td');
                        td.textContent = `OK ${i+1}`; // Simple success indicator
                        tr.appendChild(td);
                    }
                    scheduleTableBody.appendChild(tr);
                });
                console.log("[SIMPLIFIED V4 - Timeout] Fake data rendered.");

                console.log("--- [SIMPLIFIED V4] Initialization Successful ---");

            } catch (error) {
                 console.error("<<<<< CAUGHT ERROR during SIMPLIFIED V4 initialization >>>>>", error);
                 if(scheduleTableBody) scheduleTableBody.innerHTML = `<tr><td colspan="8" style="color:red; text-align:center;">Error: ${error.message}</td></tr>`;
                 showErrorMessage(`Simplified Init Error: ${error.message}`);
            }
        }, 200); // Increased delay slightly more to 200ms

    } // End of initializeEmployeeSchedule

    console.log("!!! [SIMPLIFIED V4] Script tag FINISHED parsing !!!");
</script>
