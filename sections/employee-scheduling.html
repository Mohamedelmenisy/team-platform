<!-- Note: Removed DOCTYPE, html, head, body tags -->
<!-- Note: Removed <header> section as it's provided by dash.html -->

<!-- Styles specific to Employee Scheduling -->
<!-- Note: Removed :root and potentially conflicting global styles. -->
<!-- Consider scoping these styles further if needed (e.g., using a parent class) -->
<style>
    /* Styles specific to this section (employee schedule) */
    .employee-schedule-body { /* Use a more specific class or ID for the container if needed */
        /* background-color: var(--light); Applied by dash.html */
        /* color: var(--dark); Applied by dash.html */
        /* Add padding if needed, though dash.html's .content-section likely provides it */
    }

    /* Main Content Styling Adjustments */
    .employee-schedule-body .main-container {
        max-width: 100%; /* Take full width within the dashboard content area */
        margin: 0; /* Reset margin */
        padding: 0; /* Reset padding, rely on dash.html's .content-section */
    }

    .employee-schedule-body .page-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem; /* Adjusted margin */
        flex-wrap: wrap;
        gap: 1rem;
    }

    .employee-schedule-body .page-title {
        font-size: 1.5rem; /* Adjusted size */
        color: var(--primary-dark);
        font-weight: 600; /* Adjusted weight */
    }

     /* Container for header buttons */
     .employee-schedule-body .page-header > div {
         display: flex;
         gap: 0.75rem;
         flex-wrap: wrap; /* Allow buttons to wrap on small screens */
     }

    /* Schedule Controls */
    .employee-schedule-body .schedule-controls {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
        background-color: var(--white);
        padding: 1rem;
        border-radius: 8px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        flex-wrap: wrap;
        gap: 1rem;
    }

    .employee-schedule-body .week-navigation {
        display: flex;
        align-items: center;
        gap: 0.75rem; /* Adjusted gap */
    }

    .employee-schedule-body .week-display {
        font-weight: 600;
        min-width: 180px;
        text-align: center;
        color: var(--dark); /* Ensure text color matches theme */
    }

    /* Use button styles from main dashboard (.btn, .btn-primary, etc.) */
    /* No need to redefine .btn styles here if dash.html defines them globally */

    /* Schedule Table */
    .employee-schedule-body .schedule-container {
        background-color: var(--white);
        border-radius: 8px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        overflow-x: auto; /* Enable horizontal scrolling for the table */
        border: 1px solid var(--light-gray); /* Add subtle border to container */
    }

    .employee-schedule-body .schedule-table {
        width: 100%;
        min-width: 700px; /* Minimum width before scrollbar appears */
        border-collapse: collapse; /* Use collapse for cleaner lines */
        /* border-spacing: 0; Removed */
        /* margin-top: 0px; */
    }

    .employee-schedule-body .schedule-table thead th {
        padding: 0.8rem 0.5rem; /* Adjusted padding */
        text-align: center;
        background-color: var(--primary); /* Use dashboard variable */
        color: white;
        font-weight: 600;
        position: sticky;
        top: 0; /* Make header sticky */
        z-index: 10; /* Ensure header stays above content */
        border-bottom: 2px solid var(--primary-dark); /* Add bottom border */
        border-left: 1px solid var(--primary-light); /* Add subtle vertical separators */
    }
    .employee-schedule-body .schedule-table thead th:first-child {
        border-left: none; /* Remove left border on first header cell */
        min-width: 150px; /* Give employee name more space */
        text-align: left;
        padding-left: 1rem;
        position: sticky; /* Make employee header cell sticky too */
        left: 0;
        z-index: 11; /* Above other header cells */
         border-right: 1px solid var(--primary-dark); /* Separator line */
    }
    /* Add top borders to first row headers if radius needed on container instead */
    /* .employee-schedule-body .schedule-table thead tr:first-child th:first-child { border-top-left-radius: 8px; } */
    /* .employee-schedule-body .schedule-table thead tr:first-child th:last-child { border-top-right-radius: 8px; } */


    .employee-schedule-body .schedule-table tbody td {
        padding: 0.75rem 0.5rem; /* Adjusted padding */
        text-align: center;
        background-color: var(--white); /* Use variable */
        border-bottom: 1px solid var(--light-gray); /* Horizontal row separation */
        border-left: 1px solid var(--light-gray); /* Vertical cell separation */
        color: var(--dark); /* Ensure text color */
        vertical-align: middle; /* Align content vertically */
        height: 60px; /* Ensure consistent row height */
    }

    .employee-schedule-body .schedule-table tbody tr:last-child td {
        border-bottom: none; /* Remove bottom border for last row */
    }
     .employee-schedule-body .schedule-table tbody td:first-child {
        /* Styles for the sticky employee name cell */
        position: sticky;
        left: 0;
        background-color: var(--white); /* Match row background */
        border-right: 1px solid var(--dark-gray); /* Stronger separator */
        z-index: 5; /* Lower than header */
        font-weight: 500;
        text-align: left;
        padding-left: 1rem;
        white-space: nowrap;
        border-left: none; /* Remove default left border */
    }
     /* Add left/right borders to first/last cell - Handled by td style now */
     /* Round corners for first/last cell of last row */
     /* .employee-schedule-body .schedule-table tbody tr:last-child td:first-child { border-bottom-left-radius: 8px; } */
     /* .employee-schedule-body .schedule-table tbody tr:last-child td:last-child { border-bottom-right-radius: 8px; } */


    .employee-schedule-body .employee-name {
        /* Mostly handled by td:first-child styles now */
        /* font-weight: 500; Adjusted weight */
        /* text-align: left; */
        /* padding: 0.75rem 1rem; Adjusted padding */
        /* white-space: nowrap; */
    }

    /* Employee name colors - These can stay as they are specific */
    .employee-schedule-body .employee-1 { color: #3b82f6; }
    .employee-schedule-body .employee-2 { color: #10b981; }
    .employee-schedule-body .employee-3 { color: #8b5cf6; }
    .employee-schedule-body .employee-4 { color: #ec4899; }
    .employee-schedule-body .employee-5 { color: #f59e0b; }
    .employee-schedule-body .employee-6 { color: #14b8a6; }
    /* Add more as needed */

    /* Shift Styles */
    .employee-schedule-body .shift {
        padding: 0.3rem 0.6rem; /* Adjusted padding */
        border-radius: 4px;
        font-size: 0.8rem; /* Adjusted size */
        font-weight: 500;
        white-space: nowrap;
        display: inline-block; /* Ensure it takes space */
        margin-bottom: 0.25rem; /* Space between shift and edit link */
    }

    .employee-schedule-body .shift-morning { background-color: #dbeafe; color: #1e40af; }
    .employee-schedule-body .shift-afternoon { background-color: #e0f2fe; color: #0c4a6e; }
    .employee-schedule-body .shift-night { background-color: #ede9fe; color: #5b21b6; }
    .employee-schedule-body .day-off { background-color: #f0fdf4; color: #166534; }
    .employee-schedule-body .sick-leave { background-color: #fee2e2; color: #991b1b; }
    .employee-schedule-body .vacation { background-color: #ffedd5; color: #9a3412; }

    /* Compact day headers */
    .employee-schedule-body .day-header {
        display: flex;
        flex-direction: column;
        gap: 0.15rem; /* Adjusted gap */
        align-items: center; /* Center header content */
    }

    .employee-schedule-body .day-name {
        font-weight: 600;
        font-size: 0.85rem; /* Adjusted size */
    }

    .employee-schedule-body .day-date {
        font-size: 0.75rem; /* Adjusted size */
        opacity: 0.8; /* Adjusted opacity */
    }

    /* Modal Styles (Rely on dash.html modals if possible, otherwise prefix IDs) */
    /* Example prefixing: #schedule-employeeModal, #schedule-shiftModal */
    .employee-schedule-body .modal { /* If using separate modals */
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.6); /* Darker backdrop */
        z-index: 1050; /* Ensure above dashboard content */
        justify-content: center;
        align-items: center;
        padding: 1rem; /* Add padding for smaller screens */
    }

    .employee-schedule-body .modal-content {
        background-color: var(--white);
        width: 90%;
        max-width: 500px; /* Slightly smaller max-width */
        border-radius: 8px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        padding: 1.5rem; /* Adjusted padding */
        max-height: 90vh;
        overflow-y: auto;
         display: flex; /* Use flex for layout */
         flex-direction: column;
    }

    .employee-schedule-body .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
        padding-bottom: 1rem; /* Add padding */
        border-bottom: 1px solid var(--light-gray); /* Add separator */
        flex-shrink: 0; /* Prevent header from shrinking */
    }

    .employee-schedule-body .modal-title {
        font-size: 1.25rem; /* Adjusted size */
        font-weight: 600;
        color: var(--dark); /* Use theme color */
    }

    .employee-schedule-body .close-modal {
        background: none;
        border: none;
        font-size: 1.75rem; /* Larger close button */
        cursor: pointer;
        color: var(--gray);
        line-height: 1;
        padding: 0;
    }
     .employee-schedule-body .close-modal:hover {
         color: var(--dark);
     }

      .employee-schedule-body .modal-body {
         flex-grow: 1; /* Allow body to take up space */
         overflow-y: auto; /* Scroll only body if needed */
         /* padding removed, handled by modal-content */
      }

    .employee-schedule-body .form-group {
        margin-bottom: 1rem; /* Adjusted margin */
    }

    .employee-schedule-body .form-group label {
        display: block;
        margin-bottom: 0.5rem;
        font-weight: 500;
        color: var(--dark);
        font-size: 0.9rem; /* Smaller label */
    }

    .employee-schedule-body .form-control {
        width: 100%;
        padding: 0.6rem 0.75rem; /* Adjusted padding */
        border: 1px solid var(--light-gray);
        border-radius: 6px;
        font-size: 0.95rem; /* Adjusted size */
        background-color: var(--white); /* Theme support */
        color: var(--dark); /* Theme support */
        box-sizing: border-box; /* Include padding in width */
    }
    .employee-schedule-body .form-control:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 3px rgba(var(--primary-rgb, 59, 130, 246), 0.2); /* Use RGB version if defined */
    }
     .employee-schedule-body .form-control[readonly] {
         background-color: var(--light-gray);
         cursor: not-allowed;
     }
     .employee-schedule-body textarea.form-control {
         min-height: 80px;
     }

    .employee-schedule-body .form-actions {
        display: flex;
        justify-content: flex-end;
        gap: 0.75rem; /* Adjusted gap */
        margin-top: 1.5rem; /* Adjusted margin */
        padding-top: 1rem; /* Add padding */
        border-top: 1px solid var(--light-gray); /* Add separator */
        flex-shrink: 0; /* Prevent footer from shrinking */
    }

    /* Admin Controls within table cells */
    .employee-schedule-body .admin-controls {
        /* Padding/alignment handled by td */
        /* min-height: 50px; /* Set by TD style */
    }

    .employee-schedule-body .edit-shift {
        cursor: pointer;
        color: var(--primary);
        font-size: 0.75rem; /* Smaller edit text */
        display: none; /* Hide by default, shown on hover by JS if admin */
        margin-top: 0.25rem;
        opacity: 0.7;
        transition: opacity 0.2s;
        display: block; /* Make it block to appear below shift */
        text-align: center; /* Center align */
    }
     .employee-schedule-body .edit-shift:hover {
         opacity: 1;
         text-decoration: underline;
     }

    /* Show edit button on cell hover if admin */
    .employee-schedule-body td.admin-controls:hover .edit-shift.admin-visible {
        display: block; /* Use block display */
    }


    /* Confirmation Dialog (Rely on dash.html's #confirmModal) - No styles needed here */

    /* Responsive Design Adjustments */
    @media (max-width: 768px) {
        .employee-schedule-body .schedule-controls {
            flex-direction: column;
            gap: 1rem;
            align-items: stretch; /* Stretch items */
        }
         .employee-schedule-body .week-navigation {
             justify-content: space-between; /* Space out nav buttons */
             width: 100%;
         }
         .employee-schedule-body .schedule-controls > .btn-primary {
             width: 100%; /* Full width save button */
             justify-content: center;
         }

        .employee-schedule-body .page-header {
            flex-direction: column;
            align-items: flex-start;
            gap: 0.5rem; /* Reduced gap */
            margin-bottom: 1.5rem;
        }
         .employee-schedule-body .page-header > div { /* Button container */
             width: 100%;
             display: flex;
             gap: 0.5rem;
         }
          .employee-schedule-body .page-header > div > .btn {
              flex-grow: 1; /* Make buttons share space */
              justify-content: center;
          }

        /* Mobile Table: Stack cells vertically */
        .employee-schedule-body .schedule-table thead {
            display: none; /* Hide header on mobile */
        }

        .employee-schedule-body .schedule-table tbody tr {
            display: block; /* Make rows stack */
            margin-bottom: 1rem; /* Space between employee blocks */
            border: 1px solid var(--light-gray);
            border-radius: 4px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
        }

        .employee-schedule-body .schedule-table tbody td {
            display: block; /* Stack cells */
            width: 100%;
            text-align: right; /* Align content (shift) to the right */
            padding-left: 50%; /* Create space for label */
            position: relative;
            border-bottom: 1px dashed var(--light-gray); /* Lighter separator */
            border-left: none; /* Remove vertical table borders */
            height: auto; /* Reset height */
            min-height: 40px; /* Ensure minimum height */
            box-sizing: border-box;
        }
        .employee-schedule-body .schedule-table tbody tr td:last-child {
            border-bottom: none; /* Remove border on last cell of the block */
        }

        .employee-schedule-body .schedule-table tbody td::before {
            content: attr(data-label); /* Use data-label for day/date */
            position: absolute;
            left: 10px; /* Padding from left edge */
            width: calc(50% - 20px); /* Width of the label area */
            padding-right: 10px;
            white-space: nowrap;
            text-align: left;
            font-weight: bold;
            color: var(--gray);
            font-size: 0.8rem;
            top: 50%; /* Center vertically */
            transform: translateY(-50%); /* Adjust vertical centering */
        }

         /* Special handling for Employee Name cell */
         .employee-schedule-body .schedule-table tbody td:first-child {
             position: static; /* Unstick */
             display: block;
             width: 100%;
             background-color: var(--light); /* Different background */
             font-weight: 600;
             text-align: center; /* Center name */
             padding: 0.75rem 1rem; /* Adjust padding */
             border-bottom: 1px solid var(--dark-gray); /* Stronger separator */
             border-right: none; /* Remove right border */
             z-index: auto;
             white-space: normal;
         }
         .employee-schedule-body .schedule-table tbody td:first-child::before {
             content: none; /* Remove the "data-label" pseudo element */
         }

         /* Adjust admin controls for stacked view */
         .employee-schedule-body .admin-controls {
             /* TD styles handle most of it */
         }
         .employee-schedule-body .edit-shift {
             /* Edit link appears below shift */
             display: block; /* Ensure it's block */
             text-align: right; /* Align edit link to the right */
             padding-right: 10px; /* Add padding to align with shift */
             margin-top: 0; /* Reset margin */
              opacity: 1; /* Make it always visible on mobile? Or keep hover? */
         }
         /* Always show edit shift on mobile if admin */
         .employee-schedule-body .edit-shift.admin-visible {
             display: block; /* Override hover display */
         }

    }
    @media (max-width: 480px) {
         .employee-schedule-body .page-title {
             font-size: 1.3rem;
         }
         .employee-schedule-body .shift {
             font-size: 0.75rem;
             padding: 0.2rem 0.4rem;
         }
          .employee-schedule-body .edit-shift {
              font-size: 0.7rem;
          }
          .employee-schedule-body .modal-content {
              padding: 1rem;
          }
           .employee-schedule-body .form-actions {
               flex-direction: column;
               gap: 0.5rem;
           }
            .employee-schedule-body .form-actions .btn {
                width: 100%;
                justify-content: center;
            }
         /* Further reduce label size on smallest screens */
         .employee-schedule-body .schedule-table tbody td::before {
             font-size: 0.75rem;
         }
    }
</style>

<!-- This container will be inserted into dash.html's #featureSections -->
<div class="employee-schedule-body">
    <!-- Main Content (Removed header) -->
    <div class="main-container">
        <div class="page-header">
            <h1 class="page-title">Employee Schedule</h1>
            <div>
                <!-- Buttons might be controlled by dash.html permissions -->
                <button class="btn btn-primary" id="schedule-addEmployeeBtn" style="display: none;"> <!-- Prefixed ID, hidden initially -->
                    <i class="fas fa-plus"></i> Add Employee
                </button>
                <button class="btn btn-secondary" id="schedule-sendRemindersBtn" style="display: none; background-color: var(--secondary);"> <!-- Prefixed ID, hidden initially -->
                    <i class="fas fa-envelope"></i> Send Reminders
                </button>
            </div>
        </div>

        <!-- Schedule Controls -->
        <div class="schedule-controls">
            <div class="week-navigation">
                <button class="btn btn-outline" id="schedule-prevWeekBtn" title="Previous Week"> <!-- Prefixed ID -->
                    <i class="fas fa-chevron-left"></i>
                </button>
                <div class="week-display" id="schedule-weekDisplay">Loading...</div> <!-- Prefixed ID -->
                <button class="btn btn-outline" id="schedule-nextWeekBtn" title="Next Week"> <!-- Prefixed ID -->
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
            <button class="btn btn-primary" id="schedule-saveScheduleBtn" style="display: none;"> <!-- Prefixed ID, hidden initially -->
                <i class="fas fa-save"></i> Save Schedule
            </button>
        </div>

        <!-- Schedule Table -->
        <div class="schedule-container">
            <table class="schedule-table">
                <thead>
                    <tr>
                        <!-- Headers will be populated by JS -->
                        <th>Employee</th>
                        <th>Mon</th>
                        <th>Tue</th>
                        <th>Wed</th>
                        <th>Thu</th>
                        <th>Fri</th>
                        <th>Sat</th>
                        <th>Sun</th>
                    </tr>
                </thead>
                <tbody id="schedule-table-body"> <!-- Added ID for JS targeting -->
                    <!-- Employee rows will be populated by JS -->
                    <tr>
                        <td colspan="8" style="text-align: center; padding: 2rem; color: var(--gray);">Loading schedule...</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Add Employee Modal -->
    <!-- Consider using the main dashboard's modal system if possible -->
    <div class="modal" id="schedule-employeeModal"> <!-- Prefixed ID -->
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Add New Employee</h2>
                <button class="close-modal" id="schedule-closeEmployeeModal" title="Close">×</button> <!-- Prefixed ID -->
            </div>
            <div class="modal-body">
                <form id="schedule-employeeForm"> <!-- Prefixed ID -->
                    <div class="form-group">
                        <label for="schedule-empName">Full Name</label>
                        <input type="text" id="schedule-empName" class="form-control" required> <!-- Prefixed ID -->
                    </div>
                    <div class="form-group">
                        <label for="schedule-empEmail">Email</label>
                        <input type="email" id="schedule-empEmail" class="form-control" required> <!-- Prefixed ID -->
                    </div>
                    <!-- Removed Position and Role as these might come from main user data -->
                    <!-- Hidden submit button to allow form submission via Enter key -->
                     <button type="submit" style="display: none;" aria-hidden="true"></button>
                </form>
            </div>
             <div class="form-actions">
                 <button type="button" class="btn btn-outline" id="schedule-cancelEmployeeBtn">Cancel</button> <!-- Prefixed ID -->
                 <!-- Link submit button to the form -->
                 <button type="submit" class="btn btn-primary" form="schedule-employeeForm">Add Employee</button>
             </div>
        </div>
    </div>

    <!-- Edit Shift Modal -->
    <div class="modal" id="schedule-shiftModal"> <!-- Prefixed ID -->
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Edit Shift</h2>
                <button class="close-modal" id="schedule-closeShiftModal" title="Close">×</button> <!-- Prefixed ID -->
            </div>
            <div class="modal-body">
                <form id="schedule-shiftForm"> <!-- Prefixed ID -->
                    <input type="hidden" id="schedule-shiftEmpId"> <!-- Store employee ID -->
                    <input type="hidden" id="schedule-shiftDateKey"> <!-- Store date key -->
                    <div class="form-group">
                        <label for="schedule-shiftEmployee">Employee</label>
                        <input type="text" id="schedule-shiftEmployee" class="form-control" readonly> <!-- Prefixed ID -->
                    </div>
                    <div class="form-group">
                        <label for="schedule-shiftDate">Date</label>
                         <!-- Change type to text and display formatted date, store YYYY-MM-DD in hidden input or dataset -->
                        <input type="text" id="schedule-shiftDateDisplay" class="form-control" readonly>
                        <input type="date" id="schedule-shiftDate" class="form-control" required style="display:none;"> <!-- Keep for potential editing/validation, but hide -->
                    </div>
                    <div class="form-group">
                        <label for="schedule-shiftType">Shift Type</label>
                        <select id="schedule-shiftType" class="form-control" required> <!-- Prefixed ID -->
                            <option value="day-off">Day Off</option>
                            <option value="morning">Morning (9AM-5PM)</option>
                            <option value="afternoon">Afternoon (12PM-8PM)</option>
                            <option value="night">Night (5PM-1AM)</option>
                            <option value="sick-leave">Sick Leave</option>
                            <option value="vacation">Vacation</option>
                            <option value="custom">Custom</option>
                        </select>
                    </div>
                    <div class="form-group" id="schedule-customShiftGroup" style="display: none;"> <!-- Prefixed ID -->
                        <label for="schedule-customShift">Custom Shift Times</label>
                        <input type="text" id="schedule-customShift" class="form-control" placeholder="e.g., 10AM-6PM"> <!-- Prefixed ID -->
                    </div>
                    <div class="form-group">
                        <label for="schedule-shiftNotes">Notes (Optional)</label>
                        <textarea id="schedule-shiftNotes" class="form-control" rows="3"></textarea> <!-- Prefixed ID -->
                    </div>
                     <!-- Hidden submit button -->
                     <button type="submit" style="display: none;" aria-hidden="true"></button>
                </form>
            </div>
             <div class="form-actions">
                 <button type="button" class="btn btn-danger" id="schedule-deleteShiftBtn">Delete Shift</button> <!-- Prefixed ID -->
                 <button type="button" class="btn btn-outline" id="schedule-cancelShiftBtn">Cancel</button> <!-- Prefixed ID -->
                 <button type="submit" class="btn btn-primary" form="schedule-shiftForm">Save Changes</button>
             </div>
        </div>
    </div>

    <!-- Confirmation Dialog is expected to be provided by dash.html -->
    <!-- Example ID: #confirmModal -->

</div> <!-- End of .employee-schedule-body -->


<script>
    // Explicitly attach to window to be sure
    window.initializeEmployeeSchedule = function(dashboardCurrentUser, dashboardTeamMembers) {
        // ====> ONLY THIS LINE SHOULD BE ACTIVE INSIDE THE FUNCTION FOR NOW <====
        console.log("***** YES! initializeEmployeeSchedule was FOUND and EXECUTED! *****");

        /*  COMMENT OUT EVERYTHING ELSE BELOW INSIDE THIS FUNCTION

        console.log('initializeEmployeeSchedule function started.'); // <<< أول رسالة يجب أن تراها

        // --- Check received data immediately ---
        console.log('Received dashboardCurrentUser:', dashboardCurrentUser);
        console.log('Received dashboardTeamMembers:', dashboardTeamMembers);

        if (!dashboardCurrentUser || !dashboardTeamMembers) {
            console.error("FATAL: Received data is null or undefined!");
            // Display error and stop execution
            const container = document.querySelector('.employee-schedule-body');
            if(container) container.innerHTML = '<div style="color:red; text-align:center; padding:2rem;">Error: Missing required data from dashboard.</div>';
            return;
        }
         if (!Array.isArray(dashboardTeamMembers)) {
             console.error("FATAL: Received team members data is not an array!", dashboardTeamMembers);
              const container = document.querySelector('.employee-schedule-body');
             if(container) container.innerHTML = '<div style="color:red; text-align:center; padding:2rem;">Error: Invalid team member data format.</div>';
            return;
         }
        // --- End data check ---

        // Ensure the dashboardApp global object exists for accessing shared functions/data
        if (typeof window.dashboardApp === 'undefined') {
            console.error("FATAL: dashboardApp global object not found. Cannot initialize schedule.");
            const container = document.querySelector('.employee-schedule-body');
            if(container) container.innerHTML = '<div style="color:red; text-align:center; padding:2rem;">Error: Could not link to main dashboard functions.</div>';
            return;
        }
        // Use functions from dashboardApp
        const showConfirmModal = window.dashboardApp.showConfirmModal;
        // ... (Keep commenting out all variables, helpers, initialize() call, etc.) ...

         */ // ====> END OF COMMENTED OUT SECTION <====

    }; // End of initializeEmployeeSchedule function

    // Add a simple log outside the function to see if the script tag itself runs
    console.log("--- Script tag in employee-scheduling.html finished parsing ---");

</script>
