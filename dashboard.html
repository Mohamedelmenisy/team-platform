<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TeamFlow | Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Favicon links -->
    <link rel="icon" type="image/png" sizes="32x32" href="https://img.icons8.com/fluency/48/000000/group-task.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://img.icons8.com/fluency/32/000000/group-task.png">
    <link rel="apple-touch-icon" sizes="180x180" href="https://img.icons8.com/fluency/180/000000/group-task.png">
    <style>
        :root {
            --primary: #2563eb; --primary-dark: #1e3a8a; --primary-light: #dbeafe; --secondary: #10b981; --danger: #ef4444; --warning: #f59e0b; --dark: #1e293b; --light: #f8fafc; --gray: #64748b; --light-gray: #e2e8f0; --white: #ffffff; --sidebar-width: 280px; --sidebar-bg: #1e3a8a; --sidebar-text: rgba(255,255,255,0.9); --sidebar-hover: rgba(255,255,255,0.1); --sidebar-active: rgba(255,255,255,0.2); --sidebar-divider: rgba(255,255,255,0.1); --success: #10b981; --team-manager: #ef4444; --compact-padding: 0.5rem; --normal-padding: 1rem; --spacious-padding: 1.5rem;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        body { background-color: var(--primary-light); color: var(--dark); display: flex; min-height: 100vh; transition: background-color 0.3s ease, color 0.3s ease; }
        .sidebar { width: var(--sidebar-width); background-color: var(--sidebar-bg); height: 100vh; position: fixed; overflow-y: auto; transition: all 0.3s; z-index: 100; display: flex; flex-direction: column; }
        .sidebar-header { padding: 1.5rem; border-bottom: 1px solid var(--sidebar-divider); display: flex; align-items: center; justify-content: space-between; }
        .logo { font-size: 1.25rem; font-weight: 700; color: var(--white); display: flex; align-items: center; gap: 0.75rem; } .logo-icon { color: var(--white); font-size: 1.5rem; }
        .sidebar-menu { padding: 1rem 0; flex-grow: 1; overflow-y: auto; } .menu-title { padding: 0.75rem 1.5rem; font-size: 0.75rem; font-weight: 600; text-transform: uppercase; color: rgba(255,255,255,0.6); letter-spacing: 0.5px; }
        .menu-item { display: flex; align-items: center; padding: 0.75rem 1.5rem; color: var(--sidebar-text); text-decoration: none; transition: all 0.2s; border-left: 3px solid transparent; margin: 0.25rem 0; } .menu-item:hover { background-color: var(--sidebar-hover); color: var(--white); } .menu-item.active { background-color: var(--sidebar-active); color: var(--white); border-left-color: var(--white); } .menu-item i { margin-right: 0.75rem; font-size: 1.1rem; width: 24px; text-align: center; }
        .menu-divider { height: 1px; background-color: var(--sidebar-divider); margin: 1rem 1.5rem; } .main-content { flex: 1; margin-left: var(--sidebar-width); transition: all 0.3s; }
        .top-nav { background-color: var(--white); padding: var(--normal-padding) 2rem; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--light-gray); position: sticky; top: 0; z-index: 90; transition: padding 0.3s ease, background-color 0.3s ease, border-color 0.3s ease; } body.compact .top-nav { padding: var(--compact-padding) 1rem; } body.spacious .top-nav { padding: var(--spacious-padding) 2rem; }
        .search-bar { position: relative; width: 400px; } .search-bar input { width: 100%; padding: 0.75rem 1rem 0.75rem 2.5rem; border: 1px solid var(--light-gray); border-radius: 6px; font-size: 0.9rem; transition: all 0.2s; background-color: var(--white); color: var(--dark); } .search-bar input:focus { outline: none; border-color: var(--primary); box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1); } .search-icon { position: absolute; left: 1rem; top: 50%; transform: translateY(-50%); color: var(--gray); } .search-results { position: absolute; top: 100%; left: 0; width: 100%; background-color: var(--white); border: 1px solid var(--light-gray); border-radius: 0 0 6px 6px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); z-index: 100; display: none; max-height: 300px; overflow-y: auto; } .search-results.active { display: block; } .search-result-item { padding: 0.75rem 1rem; cursor: pointer; transition: background-color 0.2s; color: var(--dark); } .search-result-item:hover { background-color: var(--primary-light); }
        .user-menu { display: flex; align-items: center; gap: 1.5rem; } .notification-icon { position: relative; color: var(--gray); cursor: pointer; font-size: 1.1rem; } .notification-badge { position: absolute; top: -5px; right: -5px; background-color: var(--danger); color: white; border-radius: 50%; width: 18px; height: 18px; display: flex; align-items: center; justify-content: center; font-size: 0.65rem; font-weight: 600; } .user-profile { display: flex; align-items: center; gap: 0.75rem; position: relative; } .user-avatar { width: 36px; height: 36px; border-radius: 50%; background-color: var(--primary); color: white; display: flex; align-items: center; justify-content: center; font-weight: 600; cursor: pointer; background-size: cover; background-position: center; } .user-profile-details { display: flex; align-items: center; cursor: pointer; } .user-name { font-weight: 500; color: var(--dark); } .user-status { font-size: 0.8rem; color: var(--success); margin-left: 0.5rem; font-weight: 600; text-shadow: 0 0 4px rgba(16, 185, 129, 0.4); } .user-dropdown { position: absolute; top: 100%; right: 0; background-color: var(--white); border: 1px solid var(--light-gray); border-radius: 6px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); width: 200px; z-index: 100; display: none; } .user-dropdown.active { display: block; } .dropdown-item { padding: 0.75rem 1rem; display: flex; align-items: center; gap: 0.75rem; color: var(--dark); text-decoration: none; transition: background-color 0.2s; } .dropdown-item:hover { background-color: var(--light); } .dropdown-item i { width: 20px; text-align: center; }
        .content-area { padding: 2rem; min-height: calc(100vh - 70px); transition: padding 0.3s ease; } body.compact .content-area { padding: 1rem; } body.spacious .content-area { padding: 3rem; }
        .welcome-section { background-color: var(--primary-dark); color: var(--white); padding: 2rem; border-radius: 8px; margin-bottom: 2rem; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); transition: padding 0.3s ease, margin-bottom 0.3s ease, background-color 0.3s ease; } body.compact .welcome-section { padding: 1rem; margin-bottom: 1rem; } body.spacious .welcome-section { padding: 3rem; margin-bottom: 3rem; } .welcome-title { font-size: 1.5rem; font-weight: 700; margin-bottom: 0.5rem; } body.compact .welcome-title { font-size: 1.25rem; } .welcome-subtitle { font-size: 1rem; opacity: 0.9; margin-top: 0.25rem; margin-bottom: 1.5rem; font-weight: 400; } body.compact .welcome-subtitle { font-size: 0.9rem; margin-bottom: 1rem;} .user-info { display: flex; align-items: center; gap: 1.5rem; margin-top: 1.5rem; } body.compact .user-info { flex-direction: column; text-align: center; gap: 1rem; margin-top: 1rem; } .user-info-avatar { width: 80px; height: 80px; border-radius: 50%; background-color: var(--primary-light); color: var(--primary); display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 1.75rem; background-size: cover; background-position: center; position: relative; cursor: default; } body.compact .user-info-avatar { width: 60px; height: 60px; font-size: 1.25rem; } .user-info-details { flex: 1; } .user-info-name { font-weight: 600; font-size: 1.25rem; margin-bottom: 0.25rem; } body.compact .user-info-name { font-size: 1rem; } .user-info-title { opacity: 0.9; font-size: 0.9rem; margin-bottom: 0.5rem; color: var(--light-gray); font-weight: 600; } .user-info-title.role-admin { color: var(--team-manager); } body.compact .user-info-title { font-size: 0.8rem; } .user-info-email { display: flex; align-items: center; gap: 0.5rem; font-size: 0.9rem; opacity: 0.9; }
        .stats-section { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin-bottom: 2rem; transition: gap 0.3s ease, margin-bottom 0.3s ease; } body.compact .stats-section { gap: 1rem; margin-bottom: 1rem; } body.spacious .stats-section { gap: 2rem; margin-bottom: 3rem; } .stat-card { background-color: var(--white); border-radius: 8px; padding: 1.5rem; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.08); transition: transform 0.2s, box-shadow 0.2s, padding 0.3s ease, background-color 0.3s ease; position: relative; overflow: hidden; } body.compact .stat-card { padding: 1rem; } body.spacious .stat-card { padding: 2rem; } .stat-card:hover { transform: translateY(-4px); box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1); } .stat-card::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 5px; background: linear-gradient(90deg, var(--primary), var(--secondary)); opacity: 0.9; } .stat-title { font-size: 0.9rem; color: var(--gray); margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem; } body.compact .stat-title { font-size: 0.8rem; } .stat-title i { color: var(--primary); } .stat-value { font-size: 1.75rem; font-weight: 700; color: var(--primary-dark); display: flex; align-items: center; justify-content: space-between; } body.compact .stat-value { font-size: 1.5rem; } .stat-trend { display: flex; align-items: center; font-size: 0.9rem; font-weight: 500; } body.compact .stat-trend { font-size: 0.8rem; } .trend-up { color: var(--secondary); } .trend-down { color: var(--danger); } .trend-neutral { color: var(--gray); }
        .activity-section { background-color: var(--white); border-radius: 8px; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1); padding: 1.5rem; transition: padding 0.3s ease, background-color 0.3s ease; } body.compact .activity-section { padding: 1rem; } body.spacious .activity-section { padding: 2rem; } .section-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; transition: margin-bottom 0.3s ease; flex-wrap: wrap; gap: 0.5rem; } body.compact .section-header { margin-bottom: 1rem; } body.spacious .section-header { margin-bottom: 2rem; } .section-title { font-size: 1.25rem; font-weight: 600; color: var(--dark); } body.compact .section-title { font-size: 1.1rem; } .live-badge { display: inline-flex; align-items: center; background-color: var(--danger); color: white; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.75rem; font-weight: 600; margin-left: 0.5rem; animation: pulse 2s infinite; } @keyframes pulse { 0% { transform: scale(1); opacity: 1; } 50% { transform: scale(1.05); opacity: 0.8; } 100% { transform: scale(1); opacity: 1; } } .section-header > div { display: flex; align-items: center; gap: 1rem;} .view-all, .delete-all { font-weight: 500; cursor: pointer; transition: color 0.2s, background-color 0.2s; padding: 0.5rem; border-radius: 4px; font-size: 0.9rem; } .view-all { color: var(--primary); } .view-all:hover { color: var(--primary-dark); text-decoration: underline; background-color: var(--primary-light); } .delete-all { color: var(--danger); } .delete-all:hover { color: #dc2626; text-decoration: underline; background-color: rgba(239, 68, 68, 0.1); } .activity-list { list-style: none; padding-left: 0; } .activity-item { display: flex; padding: 1rem 0; border-bottom: 1px solid var(--light-gray); align-items: center; transition: background-color 0.3s, padding 0.3s ease, border-color 0.3s ease; } body.compact .activity-item { padding: 0.75rem 0; } body.spacious .activity-item { padding: 1.25rem 0; } .activity-item:last-child { border-bottom: none; } .activity-item.new-activity { background-color: rgba(37, 99, 235, 0.08); animation: highlightNewActivity 2.5s ease-out forwards; } @keyframes highlightNewActivity { 0% { background-color: rgba(37, 99, 235, 0.15); } 100% { background-color: transparent; } } .activity-icon { width: 40px; height: 40px; border-radius: 50%; background-color: rgba(37, 99, 235, 0.1); color: var(--primary); display: flex; align-items: center; justify-content: center; margin-right: 1rem; flex-shrink: 0; transition: width 0.3s, height 0.3s, margin-right 0.3s, font-size 0.3s; } body.compact .activity-icon { width: 32px; height: 32px; margin-right: 0.75rem; font-size: 0.9rem; } .activity-content { flex: 1; } .activity-message { margin-bottom: 0.25rem; color: var(--dark); } body.compact .activity-message { font-size: 0.9rem; } .activity-time { font-size: 0.8rem; color: var(--gray); } body.compact .activity-time { font-size: 0.7rem; } .activity-actions { display: flex; gap: 0.5rem; margin-left: auto; padding-left: 1rem; } .delete-activity { color: var(--danger); cursor: pointer; opacity: 1; transition: opacity 0.2s, background-color 0.2s; padding: 0.5rem; border-radius: 4px; } .delete-activity:hover { background-color: rgba(239, 68, 68, 0.1); }
        .content-section { display: none; background-color: var(--white); border-radius: 8px; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1); padding: 2rem; transition: padding 0.3s ease, background-color 0.3s ease; } .content-section.active { display: block; } body.compact .content-section { padding: 1rem; } body.spacious .content-section { padding: 3rem; } .section-main-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; transition: margin-bottom 0.3s ease; } body.compact .section-main-header { margin-bottom: 1.5rem; } body.spacious .section-main-header { margin-bottom: 3rem; } .section-main-title { font-size: 1.5rem; font-weight: 600; color: var(--primary-dark); } body.compact .section-main-title { font-size: 1.25rem; }
        .profile-header-text { margin-bottom: 2rem; color: var(--gray); font-size: 0.95rem;} .profile-avatar-section { text-align: center; margin-bottom: 2rem; } #profileAvatarLarge { width: 120px; height: 120px; border-radius: 50%; background-color: var(--primary-light); color: var(--primary-dark); display: inline-flex; align-items: center; justify-content: center; font-weight: 600; font-size: 3rem; background-size: cover; background-position: center; margin-bottom: 1rem; border: 3px solid var(--white); box-shadow: 0 2px 4px rgba(0,0,0,0.1); } #uploadPhotoButton { margin-top: 0.5rem;}
        .data-form { display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; transition: gap 0.3s ease; } body.compact .data-form { gap: 1rem; } body.spacious .data-form { gap: 2rem; } .form-group { margin-bottom: 1rem; transition: margin-bottom 0.3s ease; } body.compact .form-group { margin-bottom: 0.75rem; } body.spacious .form-group { margin-bottom: 1.5rem; } .form-group label { display: block; margin-bottom: 0.5rem; font-weight: 500; color: var(--dark); transition: margin-bottom 0.3s ease, font-size 0.3s ease; } body.compact .form-group label { margin-bottom: 0.25rem; font-size: 0.9rem; } .form-control { width: 100%; padding: 0.75rem; border: 1px solid var(--light-gray); border-radius: 6px; font-size: 1rem; background-color: var(--white); color: var(--dark); transition: border-color 0.2s, box-shadow 0.2s, padding 0.3s ease, font-size 0.3s ease, background-color 0.3s ease, color 0.3s ease; } body.compact .form-control { padding: 0.5rem; font-size: 0.9rem; } body.spacious .form-control { padding: 1rem; } .form-control:focus { outline: none; border-color: var(--primary); box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1); } .form-control[readonly] { background-color: var(--light-gray); cursor: not-allowed; } .form-actions { grid-column: span 2; display: flex; justify-content: flex-end; gap: 1rem; margin-top: 1rem; transition: margin-top 0.3s ease; } body.compact .form-actions { margin-top: 0.5rem; } body.spacious .form-actions { margin-top: 2rem; }
        .btn { padding: 0.75rem 1.5rem; border-radius: 6px; font-weight: 500; cursor: pointer; transition: all 0.2s; border: none; display: inline-flex; align-items: center; gap: 0.5rem; } body.compact .btn { padding: 0.5rem 1rem; font-size: 0.9rem; } body.spacious .btn { padding: 1rem 2rem; } .btn-primary { background-color: var(--primary); color: white; } .btn-primary:hover:not(:disabled) { background-color: var(--primary-dark); } .btn-outline { background-color: transparent; border: 1px solid var(--primary); color: var(--primary); } .btn-outline:hover:not(:disabled) { background-color: var(--primary-light); } .btn-danger { background-color: var(--danger); color: white; } .btn-danger:hover:not(:disabled) { background-color: #dc2626; } .btn-success { background-color: var(--success); color: white; } .btn-success:hover:not(:disabled) { background-color: #0d9f6e; } .btn:disabled { opacity: 0.6; cursor: not-allowed; }
        .settings-tabs { display: flex; border-bottom: 1px solid var(--light-gray); margin-bottom: 2rem; transition: margin-bottom 0.3s ease, border-color 0.3s ease; overflow-x: auto; } body.compact .settings-tabs { margin-bottom: 1.5rem; } body.spacious .settings-tabs { margin-bottom: 3rem; } .settings-tab { padding: 0.75rem 1.5rem; cursor: pointer; border-bottom: 2px solid transparent; font-weight: 500; color: var(--gray); transition: all 0.2s; white-space: nowrap; } body.compact .settings-tab { padding: 0.5rem 1rem; font-size: 0.9rem; } body.spacious .settings-tab { padding: 1rem 2rem; } .settings-tab:hover { color: var(--primary); } .settings-tab.active { color: var(--primary); border-bottom-color: var(--primary); } .settings-tab.disabled { color: var(--light-gray); cursor: not-allowed; pointer-events: none; }
        .settings-panel { display: none; } .settings-panel.active { display: block; animation: fadeInPanel 0.5s ease-out; } @keyframes fadeInPanel { from { opacity: 0; } to { opacity: 1; } } .switch { position: relative; display: inline-block; width: 50px; height: 24px; flex-shrink: 0; } body.compact .switch { width: 40px; height: 20px; } .switch input { opacity: 0; width: 0; height: 0; } .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; } .slider:before { position: absolute; content: ""; height: 16px; width: 16px; left: 4px; bottom: 4px; background-color: white; transition: .4s; } body.compact .slider:before { height: 14px; width: 14px; left: 3px; bottom: 3px; } input:checked + .slider { background-color: var(--primary); } input:checked + .slider:before { transform: translateX(26px); } body.compact input:checked + .slider:before { transform: translateX(20px); } .slider.round { border-radius: 34px; } .slider.round:before { border-radius: 50%; }
        .team-management { margin-top: 1.5rem; } body.compact .team-management { margin-top: 1rem; } body.spacious .team-management { margin-top: 2rem; } .team-management h3, .add-member-form h4 { color: var(--dark); margin-bottom: 1rem; } .team-list { margin-top: 1rem; } body.compact .team-list { margin-top: 0.75rem; } body.spacious .team-list { margin-top: 1.5rem; } .team-member-card { display: flex; align-items: center; padding: 1rem; border: 1px solid var(--light-gray); border-radius: 8px; margin-bottom: 1rem; transition: all 0.2s; background-color: var(--white); } body.compact .team-member-card { padding: 0.75rem; margin-bottom: 0.75rem; } body.spacious .team-member-card { padding: 1.25rem; margin-bottom: 1.25rem; } .team-member-card:hover { box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05); border-color: var(--primary); } .member-avatar { width: 50px; height: 50px; border-radius: 50%; background-color: var(--light-gray); margin-right: 1rem; display: flex; align-items: center; justify-content: center; font-weight: 600; background-size: cover; background-position: center; color: var(--primary-dark); transition: width 0.3s, height 0.3s, margin-right 0.3s, font-size 0.3s; flex-shrink: 0; } body.compact .member-avatar { width: 40px; height: 40px; margin-right: 0.75rem; font-size: 0.9rem; } .member-details { flex: 1; min-width: 0; } .member-name { font-weight: 500; margin-bottom: 0.25rem; color: var(--dark); white-space: nowrap; overflow: hidden; text-overflow: ellipsis;} body.compact .member-name { font-size: 0.9rem; } .member-email { font-size: 0.9rem; color: var(--gray); white-space: nowrap; overflow: hidden; text-overflow: ellipsis;} body.compact .member-email { font-size: 0.8rem; } .member-role { padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.8rem; font-weight: 500; margin: 0 1rem; flex-shrink: 0; } body.compact .member-role { font-size: 0.7rem; margin: 0 0.75rem; } .role-admin { background-color: rgba(239, 68, 68, 0.1); color: var(--danger); } .role-senior { background-color: rgba(37, 99, 235, 0.1); color: var(--primary); } .role-supervisor { background-color: rgba(245, 158, 11, 0.1); color: var(--warning); } .role-member { background-color: rgba(16, 185, 129, 0.1); color: var(--secondary); } .member-actions { display: flex; gap: 0.5rem; flex-shrink: 0; } .member-actions .btn-sm { padding: 0.3rem 0.6rem; font-size: 0.8rem; } .add-member-form { margin-top: 2rem; padding: 1.5rem; border: 1px dashed var(--light-gray); border-radius: 8px; background-color: var(--light); } body.compact .add-member-form { margin-top: 1.5rem; padding: 1rem; } body.spacious .add-member-form { margin-top: 3rem; padding: 2rem; }
        body.light-theme { --primary-light: #f1f5f9; --light: #ffffff; --white: #ffffff; --dark: #1e293b; --gray: #64748b; --light-gray: #e2e8f0; background-color: var(--primary-light); } body.dark-theme { --primary: #3b82f6; --primary-dark: #1e40af; --primary-light: #1e293b; --light: #334155; --white: #0f172a; --dark: #e2e8f0; --gray: #94a3b8; --light-gray: #334155; background-color: var(--white); } body.dark-theme .top-nav { background-color: var(--primary-light); border-bottom-color: var(--light-gray); } body.dark-theme .stat-card, body.dark-theme .activity-section, body.dark-theme .content-section, body.dark-theme .team-member-card, body.dark-theme .add-member-form { background-color: var(--primary-light); } body.dark-theme .search-bar input, body.dark-theme .form-control { background-color: var(--light); border-color: var(--light-gray); color: var(--dark); } body.dark-theme .form-control[readonly] { background-color: var(--primary-light); } body.dark-theme .search-results { background-color: var(--light); border-color: var(--light-gray); } body.dark-theme .search-result-item:hover { background-color: var(--primary-light); } body.dark-theme .user-dropdown { background-color: var(--light); border-color: var(--light-gray); } body.dark-theme .dropdown-item:hover { background-color: var(--primary-light); } body.dark-theme .notifications-container { background-color: var(--primary-light); } body.dark-theme .notification-list-item:hover { background-color: var(--light); } body.dark-theme .notification-list-item.unread { background-color: rgba(59, 130, 246, 0.1); } body.dark-theme .confirm-container { background-color: var(--light); } body.dark-theme .theme-option div { border-color: var(--light-gray); } body.dark-theme .theme-option[data-theme="dark"] div { border-color: var(--primary); } body.dark-theme .back-button:hover { background-color: var(--light); } body.dark-theme .notifications-footer { background-color: var(--primary-light); } body.dark-theme .welcome-section { background-color: var(--primary-dark); color: var(--white); } body.dark-theme .user-info-title { color: var(--light-gray); } body.dark-theme .user-info-title.role-admin { color: var(--team-manager); } body.dark-theme .user-info-email { color: var(--light-gray); } body.dark-theme .welcome-subtitle { color: var(--light-gray); } body.blue-theme { --primary-light: #dbeafe; --light: #eff6ff; --white: #ffffff; --dark: #1e293b; background-color: var(--primary-light); }
        .theme-option { display: flex; flex-direction: column; align-items: center; } .theme-option div { width: 60px; height: 40px; border: 2px solid var(--light-gray); border-radius: 6px; cursor: pointer; transition: border-color 0.2s; } .theme-option span { text-align: center; display: block; margin-top: 0.5rem; font-size: 0.9rem; color: var(--dark); } .theme-option:hover div { border-color: var(--primary); } .theme-option.selected div { border-color: var(--primary); border-width: 3px; }
        .notifications-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); z-index: 1000; display: none; justify-content: flex-end; } .notifications-container { width: 400px; max-width: 100%; background-color: var(--white); height: 100vh; overflow-y: auto; animation: slideIn 0.3s ease-out; box-shadow: -2px 0 10px rgba(0, 0, 0, 0.1); display: flex; flex-direction: column; } @keyframes slideIn { from { transform: translateX(100%); } to { transform: translateX(0); } } .notifications-header { padding: 1.5rem; border-bottom: 1px solid var(--light-gray); display: flex; justify-content: space-between; align-items: center; background-color: var(--primary); color: white; flex-shrink: 0; } .notifications-title { font-size: 1.25rem; font-weight: 600; } .close-notifications { background: none; border: none; font-size: 1.25rem; cursor: pointer; color: white; } .notifications-body { flex-grow: 1; overflow-y: auto; } .notification-list-item { padding: 1rem 1.5rem; border-bottom: 1px solid var(--light-gray); transition: background-color 0.2s; display: flex; gap: 1rem; align-items: center; cursor: pointer; } .notification-list-item:hover { background-color: var(--light); } .notification-list-item.unread { background-color: rgba(37, 99, 235, 0.05); font-weight: 500; } .notification-list-item:last-child { border-bottom: none; } .notification-icon-wrapper { width: 40px; height: 40px; border-radius: 50%; background-color: rgba(37, 99, 235, 0.1); color: var(--primary); display: flex; align-items: center; justify-content: center; flex-shrink: 0; } .notification-content { flex: 1; min-width: 0; } .notification-message { margin-bottom: 0.25rem; color: var(--dark); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; } .notification-time { font-size: 0.8rem; color: var(--gray); } .delete-notification { color: var(--danger); cursor: pointer; opacity: 0.6; transition: opacity 0.2s; margin-left: auto; padding: 0.5rem; flex-shrink: 0; } .delete-notification:hover { opacity: 1; } .no-notifications-message { text-align: center; padding: 2rem; color: var(--gray); } .notifications-footer { padding: 1rem 1.5rem; border-top: 1px solid var(--light-gray); display: flex; justify-content: space-between; flex-shrink: 0; background-color: var(--light); }
        .confirm-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.6); z-index: 1100; display: none; justify-content: center; align-items: center; backdrop-filter: blur(3px); } .confirm-container { background-color: var(--white); border-radius: 8px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15); width: 400px; max-width: 90%; padding: 2rem; animation: fadeInScale 0.3s ease-out; } @keyframes fadeInScale { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } } .confirm-title { font-size: 1.25rem; font-weight: 600; margin-bottom: 1rem; color: var(--dark); } .confirm-message { margin-bottom: 1.5rem; line-height: 1.5; color: var(--gray); } .confirm-actions { display: flex; justify-content: flex-end; gap: 1rem; }
        .success-message { position: fixed; top: 20px; right: 20px; background-color: var(--success); color: white; padding: 1rem 1.5rem; border-radius: 6px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); display: flex; align-items: center; gap: 0.75rem; z-index: 1200; transform: translateX(120%); transition: transform 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55); } .success-message.show { transform: translateX(0); } .success-message i { font-size: 1.25rem; }
        @media (max-width: 992px) { .sidebar { transform: translateX(-100%); width: 250px; } .sidebar.active { transform: translateX(0); box-shadow: 2px 0 10px rgba(0,0,0,0.1); } .main-content { margin-left: 0; } .search-bar { width: 250px; } .team-member-card { flex-wrap: wrap; } } @media (max-width: 768px) { .top-nav { flex-direction: column; gap: 1rem; padding: 1rem; } .search-bar { width: 100%; order: 2; } .user-menu { width: 100%; justify-content: space-between; order: 1; } .content-area { padding: 1.5rem; } .data-form { grid-template-columns: 1fr; } .form-actions { grid-column: span 1; } .user-info { flex-direction: column; text-align: center; } .user-info-avatar { margin-bottom: 1rem; } .stats-section { grid-template-columns: 1fr; } .settings-tabs { flex-wrap: wrap; } .settings-tab { padding: 0.5rem 1rem; } .confirm-container { width: 90%; } .team-member-card { flex-direction: column; align-items: flex-start; gap: 0.5rem; } .member-role { margin: 0.5rem 0; } .member-actions { margin-top: 0.5rem; } .profile-avatar-section { margin-bottom: 1.5rem; } #profileAvatarLarge { width: 100px; height: 100px; font-size: 2.5rem; } .add-member-form .data-form { grid-template-columns: 1fr; align-items: stretch; } .add-member-form .data-form > div { margin-bottom: 1rem; } .add-member-form .data-form > div:last-child { margin-top: 0; } } @media (max-width: 480px) { .section-header > div { justify-content: center; width: 100%; } .welcome-section { padding: 1.5rem; } .stats-section { gap: 0.75rem; } .stat-card { padding: 1rem; } }
        .back-button { display: inline-flex; align-items: center; gap: 0.75rem; color: var(--primary); font-weight: 500; cursor: pointer; margin-bottom: 1.5rem; padding: 0.6rem 1.2rem; border-radius: 6px; transition: background-color 0.2s, border-color 0.2s, color 0.2s; border: 1px solid transparent; font-size: 0.9rem; } .back-button:hover { background-color: var(--primary-light); border-color: var(--primary); color: var(--primary-dark); } .back-button i { transition: transform 0.2s; font-size: 0.8rem; } .back-button:hover i { transform: translateX(-3px); }
        #notificationSound { display: none; } .d-none { display: none !important; } .connection-status { padding: 0.75rem 1.5rem; margin-top: auto; border-top: 1px solid var(--sidebar-divider); display: flex; align-items: center; gap: 0.5rem; color: rgba(16, 185, 129, 0.9); font-size: 0.85rem; flex-shrink: 0; } .status-dot { width: 8px; height: 8px; border-radius: 50%; background-color: var(--success); animation: pulseStatus 2s infinite; } @keyframes pulseStatus { 0%, 100% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.4); } 50% { box-shadow: 0 0 0 5px rgba(16, 185, 129, 0); } } .password-error { color: var(--danger); font-size: 0.85rem; margin-top: 0.25rem; display: none; } .spinner { width: 18px; height: 18px; border: 2px solid rgba(255,255,255,0.3); border-radius: 50%; border-top-color: white; animation: spin 1s ease-in-out infinite; display: none; } @keyframes spin { to { transform: rotate(360deg); } } .loading-text { display: none; font-size: 0.9rem; color: var(--gray); margin-left: 0.5rem; } .btn-outline .spinner { border-color: rgba(37, 99, 235, 0.3); border-top-color: var(--primary); } .placeholder-content { text-align: center; padding: 4rem 2rem; color: var(--gray); border: 2px dashed var(--light-gray); border-radius: 8px; margin-top: 2rem; min-height: 300px; display: flex; flex-direction: column; justify-content: center; align-items: center; } .placeholder-content h2 { color: var(--dark); margin-bottom: 1rem; } .placeholder-content .loading-indicator { font-size: 1.2rem; margin-top: 1rem; display: flex; align-items: center; gap: 0.5rem; } .placeholder-content .error-message { color: var(--danger); font-weight: 500; margin-top: 1rem; line-height: 1.5; }
    </style>
</head>
<body class="blue-theme">
    <audio id="notificationSound" preload="auto"><source src="https://assets.mixkit.co/sfx/preview/mixkit-positive-interface-beep-221.mp3" type="audio/mpeg">Your browser does not support the audio element.</audio>
    <div class="success-message" id="successMessage"><i class="fas fa-check-circle"></i><span id="successMessageText">Action successful!</span></div>
    <aside class="sidebar" id="sidebar"> <div class="sidebar-header"><div class="logo"><i class="fas fa-users-cog logo-icon"></i><span>TeamFlow</span></div></div> <div class="sidebar-menu"> <div class="menu-title">Navigation</div> <a href="#dashboard" class="menu-item active" data-feature="dashboard"><i class="fas fa-tachometer-alt"></i><span>Dashboard</span></a> <a href="#projects" class="menu-item" data-feature="projects"><i class="fas fa-briefcase"></i><span>Projects</span></a> <a href="#reports-analytics" class="menu-item" data-feature="reports-analytics"><i class="fas fa-chart-line"></i><span>Reports & Analytics</span></a> <a href="#team-members-view" class="menu-item" data-feature="team-members-view"><i class="fas fa-users"></i><span>Team Members</span></a> <div class="menu-title">Core Features</div> <a href="#file-sharing" class="menu-item" data-feature="file-sharing"><i class="fas fa-file-upload"></i><span>File Sharing</span></a> <a href="#data-management" class="menu-item" data-feature="data-management"><i class="fas fa-database"></i><span>Data Management</span></a> <a href="#project-tracking" class="menu-item" data-feature="project-tracking"><i class="fas fa-project-diagram"></i><span>Project Tracking</span></a> <a href="#task-management" class="menu-item" data-feature="task-management"><i class="fas fa-tasks"></i><span>Task Management</span></a> <div class="menu-title">Team Tools</div> <a href="#employee-scheduling" class="menu-item" data-feature="employee-scheduling"><i class="fas fa-user-clock"></i><span>Employee Scheduling</span></a> <a href="#team-calendar" class="menu-item" data-feature="team-calendar"><i class="fas fa-calendar-alt"></i><span>Team Calendar</span></a> <a href="#deadline-tracking" class="menu-item" data-feature="deadline-tracking"><i class="fas fa-clock"></i><span>Deadline Tracking</span></a> <a href="#innovation-hub" class="menu-item" data-feature="innovation-hub"><i class="fas fa-lightbulb"></i><span>Innovation Hub</span></a> <div class="menu-divider"></div> <a href="#settings" class="menu-item" data-feature="settings"><i class="fas fa-cog"></i><span>Settings</span></a> </div> <div class="connection-status"><div class="status-dot"></div><span>Online</span></div> </aside>
    <main class="main-content"> <nav class="top-nav"> <div class="search-bar"> <i class="fas fa-search search-icon"></i> <input type="text" placeholder="Search..." id="searchInput" autocomplete="off"> <div class="search-results" id="searchResults"></div> </div> <div class="user-menu"> <div class="notification-icon" id="notificationIcon"> <i class="fas fa-bell"></i> <span class="notification-badge" style="display: none;">0</span> </div> <div class="user-profile"> <div class="user-avatar" id="userAvatar">ME</div> <div class="user-profile-details"> <span class="user-name" id="userName">Mohamed Elmenisy</span> <span class="user-status"> â€¢ Connected</span> </div> <div class="user-dropdown" id="userDropdown"> <a href="#profile" class="dropdown-item" id="profileLink"><i class="fas fa-user"></i><span>Profile</span></a> <a href="#settings" class="dropdown-item" id="settingsLink"><i class="fas fa-cog"></i><span>Settings</span></a> <a href="#" class="dropdown-item" id="logoutLink"><i class="fas fa-sign-out-alt"></i><span>Logout</span></a> </div> </div> </div> </nav> <div class="content-area"> <div class="back-button" id="backButton" style="display: none;"><i class="fas fa-arrow-left"></i><span>Back to Dashboard</span></div> <div id="dashboardContent" class="content-section active"> <div class="welcome-section"> <h2 class="welcome-title">Welcome, <span id="welcomeName">Mohamed</span>!</h2> <p class="welcome-subtitle">Here's what's happening today.</p> <div class="user-info"> <div class="user-info-avatar" id="profileAvatar">ME</div> <div class="user-info-details"> <div class="user-info-name">Mohamed Elmenisy</div> <div class="user-info-title" id="userInfoRoleTitle">Administrator</div> <div class="user-info-email"> <i class="fas fa-envelope"></i> <span id="userEmail">m.elsayed@thechefz.co</span> </div> </div> </div> </div> <div class="stats-section"> <div class="stat-card"> <div class="stat-title"><i class="fas fa-users"></i>Team Members</div> <div class="stat-value"> <span id="teamMembersCount">0</span> <span class="stat-trend trend-neutral" id="teamMembersTrend"><i class="fas fa-minus"></i> 0%</span> </div> </div> <div class="stat-card"> <div class="stat-title"><i class="fas fa-check-circle"></i>Tasks Done</div> <div class="stat-value"> <span id="tasksCompleted">0</span> <span class="stat-trend trend-neutral" id="tasksCompletedTrend"><i class="fas fa-minus"></i> 0%</span> </div> </div> <div class="stat-card"> <div class="stat-title"><i class="fas fa-project-diagram"></i>Active Projects</div> <div class="stat-value"> <span id="activeProjects">0</span> <span class="stat-trend trend-neutral" id="activeProjectsTrend"><i class="fas fa-minus"></i> 0%</span> </div> </div> <div class="stat-card"> <div class="stat-title"><i class="fas fa-calendar-times"></i>Deadlines</div> <div class="stat-value"> <span id="upcomingDeadlines">0</span> <span class="stat-trend trend-neutral" id="upcomingDeadlinesTrend"><i class="fas fa-minus"></i> 0%</span> </div> </div> </div> <div class="activity-section"> <div class="section-header"> <h3 class="section-title">Recent Activity <span class="live-badge">LIVE</span></h3> <div> <span class="view-all" id="viewAllActivity" style="display: none;">Show All</span> <span class="delete-all" id="deleteAllActivity" style="display: none;">Delete All</span> </div> </div> <ul class="activity-list" id="activityList"> <li style="text-align: center; padding: 2rem; color: var(--gray);"> Loading... </li> </ul> </div> </div> <div class="content-section" id="profileContent"> <div class="section-main-header"> <h2 class="section-main-title">Profile</h2> </div> <p class="profile-header-text">Your info.</p> <div class="profile-avatar-section"> <label>Avatar</label> <div id="profileAvatarLarge">ME</div> <button type="button" class="btn btn-outline btn-sm" id="uploadPhotoButton"> <i class="fas fa-upload"></i> Upload Photo </button> <input type="file" id="profileAvatarInput" accept="image/*" style="display: none;"> </div> <form class="data-form" id="profileForm"> <div class="form-group"> <label for="firstName">First Name</label> <input type="text" id="firstName" class="form-control"> </div> <div class="form-group"> <label for="lastName">Last Name</label> <input type="text" id="lastName" class="form-control"> </div> <div class="form-group" style="grid-column: span 2;"> <label for="fullNameDisplay">Full Name</label> <input type="text" id="fullNameDisplay" class="form-control" readonly> </div> <div class="form-group"> <label for="jobTitle">Job Title</label> <input type="text" id="jobTitle" class="form-control"> </div> <div class="form-group"> <label for="email">Email</label> <input type="email" id="email" class="form-control" readonly> </div> <div class="form-group"> <label for="phone">Phone</label> <input type="tel" id="phone" class="form-control"> </div> <div class="form-group"> <label for="department">Department</label> <input type="text" id="department" class="form-control"> </div> <div class="form-actions"> <button type="button" class="btn btn-outline" id="cancelProfileBtn">Cancel</button> <button type="submit" class="btn btn-primary">Save</button> </div> </form> </div> <div class="content-section" id="settingsContent"> <div class="section-main-header"> <h2 class="section-main-title">Settings</h2> </div> <div class="settings-tabs"> <div class="settings-tab active" data-tab="preferences">Preferences</div> <div class="settings-tab" data-tab="account">Account</div> <div class="settings-tab" data-tab="security">Security</div> <div class="settings-tab" data-tab="notifications">Notifications</div> <div class="settings-tab" data-tab="team" id="teamSettingsTab">Team</div> <div class="settings-tab" data-tab="collaboration">Collaboration</div> <div class="settings-tab" data-tab="danger" id="dangerZoneTab">Danger Zone</div> </div> <div class="settings-panel active" id="preferencesPanel"> <h3 class="section-title">Preferences</h3> <form class="data-form" id="preferencesForm"> <div class="form-group"> <label>Theme</label> <div style="display: flex; gap: 1rem; margin-top: 0.5rem;"> <div class="theme-option" data-theme="light"><div style="background-color: #f1f5f9;"></div><span>Light</span></div> <div class="theme-option" data-theme="dark"><div style="background-color: #0f172a;"></div><span>Dark</span></div> <div class="theme-option selected" data-theme="blue"><div style="background-color: #dbeafe;"></div><span>Blue</span></div> </div> <input type="hidden" id="selectedTheme" value="blue"> </div> <div class="form-group"> <label for="layoutDensity">Layout</label> <select id="layoutDensity" class="form-control"> <option value="compact">Compact</option> <option value="normal" selected>Normal</option> <option value="spacious">Spacious</option> </select> </div> <div class="form-group"> <label for="language">Language</label> <select id="language" class="form-control"> <option value="en" selected>English</option> <option value="ar">Arabic</option> <option value="es">Spanish</option> </select> </div> <div class="form-group"> <label for="dateFormat">Date Format</label> <select id="dateFormat" class="form-control"> <option value="mm/dd/yyyy">MM/DD/YYYY</option> <option value="dd/mm/yyyy" selected>DD/MM/YYYY</option> <option value="yyyy-mm-dd">YYYY-MM-DD</option> </select> </div> <div class="form-group"> <label for="region">Region</label> <input type="text" id="region" class="form-control" placeholder="Cairo" disabled> </div> <div class="form-group"> <label for="weekStart">Week Start</label> <select id="weekStart" class="form-control"> <option value="sun" selected>Sunday</option> </select> </div> <div class="form-group" style="grid-column: span 2;"> <label for="defaultHomepage">Homepage</label> <select id="defaultHomepage" class="form-control" disabled> <option selected>Dashboard</option> <option>Tasks</option> <option>Calendar</option> </select> </div> <div class="form-actions"> <button type="button" class="btn btn-outline" id="cancelPreferencesBtn">Cancel</button> <button type="submit" class="btn btn-primary" id="savePreferencesBtn"> <span class="btn-text">Save</span> <div class="spinner" id="preferencesSpinner"></div> <span class="loading-text" id="preferencesLoadingText">Saving...</span> </button> </div> </form> </div> <div class="settings-panel" id="accountPanel"> <h3 class="section-title">Account</h3> <form class="data-form" id="accountForm"> <div class="form-group"> <label for="acc_firstName">First Name</label> <input type="text" id="acc_firstName" class="form-control" readonly> </div> <div class="form-group"> <label for="acc_lastName">Last Name</label> <input type="text" id="acc_lastName" class="form-control" readonly> </div> <div class="form-group"> <label for="acc_email">Email</label> <input type="email" id="acc_email" class="form-control" readonly> </div> <div class="form-group"> <label for="timezone">Timezone</label> <select id="timezone" class="form-control"> <option value="utc">UTC</option> <option value="cairo" selected>Cairo (UTC+2)</option> <option value="new_york">New York (UTC-5)</option> </select> </div> <div class="form-actions"> <button type="button" class="btn btn-outline" id="cancelAccountBtn">Cancel</button> <button type="submit" class="btn btn-primary" id="saveAccountBtn"> <span class="btn-text">Save</span> <div class="spinner" id="accountSpinner"></div> <span class="loading-text" id="accountLoadingText">Saving...</span> </button> </div> <div class="form-group" style="grid-column: span 2; margin-top: 2rem;"> <label style="color: var(--danger);">Account Deletion</label> <p style="color: var(--gray); font-size: 0.9rem; margin-bottom: 1rem;">Permanently delete account.</p> <button type="button" class="btn btn-danger" id="deleteAccountBtn" disabled>Delete Account</button> </div> </form> </div> <div class="settings-panel" id="securityPanel"> <h3 class="section-title">Security</h3> <form class="data-form" id="securityForm"> <div class="form-group" style="grid-column: span 2;"> <label>2FA</label> <div style="display: flex; align-items: center; gap: 1rem;"> <label class="switch"> <input type="checkbox" id="twoFactorAuth" checked> <span class="slider round"></span> </label> <span>Enabled</span> </div> <p style="color: var(--gray); font-size: 0.9rem; margin-top: 0.5rem;">Requires code.</p> </div> <div class="form-group"> <label for="currentPassword">Current Password</label> <input type="password" id="currentPassword" class="form-control" autocomplete="current-password"> <div class="password-error" id="currentPasswordError">Incorrect</div> </div> <div class="form-group"> <label for="newPassword">New Password</label> <input type="password" id="newPassword" class="form-control" autocomplete="new-password"> <small>Min 8 chars.</small> </div> <div class="form-group"> <label for="confirmPassword">Confirm New</label> <input type="password" id="confirmPassword" class="form-control" autocomplete="new-password"> <div class="password-error" id="passwordMatchError">No match</div> </div> <div class="form-actions"> <button type="button" class="btn btn-outline" id="cancelSecurityBtn">Cancel</button> <button type="submit" class="btn btn-primary" id="saveSecurityBtn"> <span class="btn-text">Update</span> <div class="spinner" id="securitySpinner"></div> <span class="loading-text" id="securityLoadingText">Updating...</span> </button> </div> <div class="form-group" style="grid-column: span 2; margin-top: 2rem;"> <label>Integrations</label> <div style="display: flex; align-items: center; justify-content: space-between; padding: 0.5rem 0;"> <span>Slack</span> <button class="btn btn-outline" disabled>Connect</button> </div> <div style="display: flex; align-items: center; justify-content: space-between; padding: 0.5rem 0;"> <span>SSO</span> <button class="btn btn-outline" disabled>Configure</button> </div> </div> </form> </div> <div class="settings-panel" id="notificationsPanel"> <h3 class="section-title">Notifications</h3> <form class="data-form" id="notificationsForm"> <div class="form-group"> <label>Email</label> <div style="margin-top: 0.5rem; display: flex; flex-direction: column; gap: 0.75rem;"> <div style="display: flex; align-items: center; justify-content: space-between;"> <span>Tasks</span> <label class="switch"> <input type="checkbox" id="emailTasks" checked> <span class="slider round"></span> </label> </div> <div style="display: flex; align-items: center; justify-content: space-between;"> <span>Deadlines</span> <label class="switch"> <input type="checkbox" id="emailDeadlines" checked> <span class="slider round"></span> </label> </div> <div style="display: flex; align-items: center; justify-content: space-between;"> <span>Updates</span> <label class="switch"> <input type="checkbox" id="emailUpdates"> <span class="slider round"></span> </label> </div> <div style="display: flex; align-items: center; justify-content: space-between;"> <span>Summary</span> <label class="switch"> <input type="checkbox" id="emailSummary" disabled> <span class="slider round"></span> </label> </div> </div> </div> <div class="form-group"> <label>In-App</label> <div style="margin-top: 0.5rem; display: flex; flex-direction: column; gap: 0.75rem;"> <div style="display: flex; align-items: center; justify-content: space-between;"> <span>Messages</span> <label class="switch"> <input type="checkbox" id="pushMessages" checked> <span class="slider round"></span> </label> </div> <div style="display: flex; align-items: center; justify-content: space-between;"> <span>Team Updates</span> <label class="switch"> <input type="checkbox" id="pushTeamUpdates"> <span class="slider round"></span> </label> </div> <div style="display: flex; align-items: center; justify-content: space-between;"> <span>Sound</span> <label class="switch"> <input type="checkbox" id="soundNotifications" checked> <span class="slider round"></span> </label> </div> </div> </div> <div class="form-actions"> <button type="button" class="btn btn-outline" id="cancelNotificationsBtn">Cancel</button> <button type="submit" class="btn btn-primary" id="saveNotificationsBtn"> <span class="btn-text">Save</span> <div class="spinner" id="notificationsSpinner"></div> <span class="loading-text" id="notificationsLoadingText">Saving...</span> </button> </div> </form> </div> <div class="settings-panel" id="teamPanel"> <div class="team-management"> <h3>Team Members</h3> <div class="team-list" id="teamList"> <div style="text-align: center; padding: 2rem; color: var(--gray);">Loading...</div> </div> <div class="add-member-form"> <h4>Invite Member</h4> <form id="inviteMemberForm" class="data-form" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); align-items: end; gap: 1rem;"> <div class="form-group" style="margin-bottom: 0;"> <label for="inviteMemberEmail">Email</label> <input type="email" id="inviteMemberEmail" class="form-control" placeholder="user@example.com" required> </div> <div class="form-group" style="margin-bottom: 0;"> <label for="inviteMemberRole">Role</label> <select id="inviteMemberRole" class="form-control" required> <option value="member">Member</option> <option value="senior">Senior</option> <option value="supervisor">Supervisor</option> <option value="admin">Admin</option> </select> </div> <div style="grid-column: 1 / -1; margin-top: 1rem;"> <button type="submit" class="btn btn-primary">Send Invite</button> </div> </form> </div> </div> </div> <div class="settings-panel" id="collaborationPanel"> <h3 class="section-title">Collaboration</h3> <form class="data-form" id="collaborationForm"> <div class="form-group" style="grid-column: span 2;"> <label>Calendar Access</label> <p>Control calendar visibility.</p> <button type="button" class="btn btn-outline" disabled>Manage</button> </div> <div class="form-group" style="grid-column: span 2;"> <label>Chat Integration</label> <p>Connect chat platform.</p> <button type="button" class="btn btn-outline" disabled>Configure</button> </div> <div class="form-actions"> <button type="button" class="btn btn-outline" disabled>Cancel</button> <button type="submit" class="btn btn-primary" disabled>Save</button> </div> </form> </div> <div class="settings-panel" id="dangerPanel"> <h3 class="section-title" style="color: var(--danger);">Danger Zone</h3> <p style="color: var(--gray);">Admin only. Actions are permanent.</p> <div style="margin-top: 1.5rem; border: 1px solid var(--danger); border-radius: 6px; padding: 1.5rem; display: flex; flex-direction: column; gap: 1.5rem;"> <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem;"> <div> <strong style="color: var(--dark);">Delete Team Data</strong> <p>Delete projects, tasks, files.</p> </div> <button class="btn btn-danger" disabled>Delete Data</button> </div> <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem;"> <div> <strong style="color: var(--dark);">Transfer Ownership</strong> <p>Transfer admin control.</p> </div> <button class="btn btn-warning" disabled>Transfer</button> </div> <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem;"> <div> <strong style="color: var(--dark);">Delete Workspace</strong> <p>Delete entire workspace.</p> </div> <button class="btn btn-danger" disabled>Delete Workspace</button> </div> </div> </div> </div> <div id="featureSectionsContainer" style="display: none;"> <div id="featureSections"> <div class="placeholder-content" id="featurePlaceholder"> <h2 id="featureTitle">Feature Content Area</h2> <p id="featureDescription">Select a feature.</p> <div class="loading-indicator" style="display: none;"> <i class="fas fa-spinner fa-spin"></i> Loading... </div> <div class="error-message" style="display: none;"> Error loading. </div> </div> </div> </div> </div> </main>
    <div class="notifications-modal" id="notificationsModal"> <div class="notifications-container"> <div class="notifications-header"> <h3 class="notifications-title">Notifications</h3> <button class="close-notifications" id="closeNotifications">Ã—</button> </div> <div class="notifications-body" id="notificationsBody"> <div class="no-notifications-message">Loading...</div> </div> <div class="notifications-footer"> <button class="btn btn-outline btn-sm" id="markAllReadBtn">Mark All Read</button> <button class="btn btn-danger btn-sm" id="deleteAllNotificationsBtn">Delete All</button> </div> </div> </div>
    <div class="confirm-modal" id="confirmModal"> <div class="confirm-container"> <h3 class="confirm-title" id="confirmTitle">Confirm</h3> <div class="confirm-message" id="confirmMessage">Are you sure?</div> <div class="confirm-actions"> <button class="btn btn-outline" id="cancelConfirmBtn">Cancel</button> <button class="btn btn-danger" id="confirmBtn">Confirm</button> </div> </div> </div>

    <script>
        // --- Global Functions & Variables ---
        window.showConfirmModal = showConfirmModal;
        window.hideConfirmModal = hideConfirmModal;
        window.showSuccessMessage = showSuccessMessage;
        window.saveData = saveData;
        let currentUser = {};
        let teamMembers = [];

        document.addEventListener('DOMContentLoaded', function() {
            console.log("[DEBUG] DOMContentLoaded event fired.");

            // --- DOM Elements Cache ---
            // Cache elements reliably after DOM is loaded
            const sidebar = document.getElementById('sidebar');
            const menuItems = document.querySelectorAll('.menu-item');
            // ... (cache all other elements needed) ...
            const featureSectionsContainer = document.getElementById('featureSectionsContainer');
            const featureSections = document.getElementById('featureSections');
            const featurePlaceholder = document.getElementById('featurePlaceholder');
            const featureTitle = document.getElementById('featureTitle');
            const featureDescription = document.getElementById('featureDescription');
            const featureLoadingIndicator = featurePlaceholder?.querySelector('.loading-indicator');
            const featureErrorMessage = featurePlaceholder?.querySelector('.error-message');
            const confirmModal = document.getElementById('confirmModal');
            const confirmTitle = document.getElementById('confirmTitle');
            const confirmMessage = document.getElementById('confirmMessage');
            const cancelConfirmBtn = document.getElementById('cancelConfirmBtn');
            let confirmBtn = document.getElementById('confirmBtn');
            const successMessage = document.getElementById('successMessage');
            const successMessageText = document.getElementById('successMessageText');
             // Add more element caching here...

            // --- State Variables ---
            let activities = [];
            let notifications = [];
            let currentFeature = 'dashboard';
            let currentSettingsTab = 'preferences';
            let activityIntervalId = null;
            let confirmCallback = null;
            let cancelCallback = null;

            // --- Constants ---
            const MAX_ACTIVITIES_DISPLAYED = 5;
            const UPDATE_INTERVAL = 60000;
            const SIMULATED_DELAY = 300; // Shorter delay for testing
            const NEW_ACTIVITY_HIGHLIGHT_DURATION = 2500;
            const DEFAULT_USER = { id: 1, name: 'Default User', email: 'default@example.com', title: 'Member', department: 'General', phone: '', avatar: '', initials: 'DU', role: 'member', password: 'password', preferences: { language: 'en', timezone: 'utc', dateFormat: 'dd/mm/yyyy', theme: 'blue', layoutDensity: 'normal', soundNotifications: true, weekStart: 'sun' }, notificationPreferences: { email: { tasks: true, deadlines: true, updates: false }, push: { messages: true, teamUpdates: false } }, security: { twoFactorEnabled: false }, stats: { teamMembers: 0, tasksCompleted: 0, activeProjects: 0, upcomingDeadlines: 0, teamMembersTrend: 'neutral', tasksCompletedTrend: 'neutral', activeProjectsTrend: 'neutral', upcomingDeadlinesTrend: 'neutral' } };

            // --- Initialization ---
            function initDashboard() {
                console.log("[DEBUG] initDashboard started.");
                loadData();
                updateUserUI(); // Ensure UI reflects loaded data first
                loadTeamMembers(); // Ensure team list UI is updated
                loadActivities();
                loadNotifications();
                updateStats(); // Ensure stats reflect loaded team size etc.
                applyUserPreferences(); // Apply theme/layout AND load settings form data
                applyRBAC();
                handleInitialNavigation(); // Load content based on hash or default
                startActivityTimeUpdater();
                setupEventListeners(); // Setup listeners LAST, after everything is ready
                console.log("[DEBUG] initDashboard finished.");
            }

            // --- Data Handling ---
             function isObject(item) { return (item && typeof item === 'object' && !Array.isArray(item)); }
             function deepMerge(target, source) { let output = Object.assign({}, target); if (isObject(target) && isObject(source)) { Object.keys(source).forEach(key => { if (isObject(source[key])) { if (!(key in target)) Object.assign(output, { [key]: source[key] }); else output[key] = deepMerge(target[key], source[key]); } else { Object.assign(output, { [key]: source[key] }); } }); } return output; }
             function loadData() { try { const storedUser = JSON.parse(localStorage.getItem('currentUser')); currentUser = deepMerge(DEFAULT_USER, storedUser || {}); teamMembers = JSON.parse(localStorage.getItem('teamMembers')) || []; activities = JSON.parse(localStorage.getItem('activities')) || []; notifications = JSON.parse(localStorage.getItem('notifications')) || []; console.log("[DEBUG] Data loaded. User role:", currentUser?.role, "Team size:", teamMembers?.length); } catch (e) { console.error("[DEBUG] Error loading data from localStorage:", e); currentUser = DEFAULT_USER; teamMembers = []; activities = []; notifications = []; }}
             function saveData() { try { localStorage.setItem('currentUser', JSON.stringify(currentUser)); localStorage.setItem('teamMembers', JSON.stringify(teamMembers)); localStorage.setItem('activities', JSON.stringify(activities)); localStorage.setItem('notifications', JSON.stringify(notifications)); console.log("[DEBUG] Data saved."); } catch (e) { console.error("[DEBUG] Error saving data to localStorage:", e); }}
             function clearUserData() { localStorage.removeItem('currentUser'); localStorage.removeItem('teamMembers'); localStorage.removeItem('activities'); localStorage.removeItem('notifications'); console.log("[DEBUG] User data cleared.");}

            // --- UI Update Functions ---
            function updateUserUI() { console.log("[DEBUG] Updating User UI"); /* ... (Implementation) ... */ }
            function applyUserPreferences() { console.log("[DEBUG] Applying User Preferences"); /* ... (Implementation) ... */ }
            function applyRBAC() { console.log("[DEBUG] Applying RBAC"); /* ... (Implementation) ... */ }
            function loadSettingsFormData() { console.log("[DEBUG] Loading Settings Form Data"); /* ... (Implementation) ... */ }
            function updateStats() { console.log("[DEBUG] Updating Stats"); /* ... (Implementation) ... */ }
            function updateTrendIndicator(element, trend) { /* ... (Implementation) ... */ }
            function updateNotificationBadge() { /* ... (Implementation) ... */ }
            function loadActivities(showAll = false) { console.log("[DEBUG] Loading Activities", showAll ? "(Show All)" : ""); /* ... (Implementation, ensure escapeHtml) ... */ }
            function loadNotifications() { console.log("[DEBUG] Loading Notifications"); /* ... (Implementation, ensure escapeHtml) ... */ }
            function getTimeAgo(timestamp) { /* ... (Implementation) ... */ return "time ago"; /* Simplified */ }
            function updateActivityTimes() { /* ... (Implementation) ... */ }
            function startActivityTimeUpdater() { console.log("[DEBUG] Starting Activity Time Updater"); if (activityIntervalId) clearInterval(activityIntervalId); updateActivityTimes(); activityIntervalId = setInterval(updateActivityTimes, UPDATE_INTERVAL); }
            function loadTeamMembers() { console.log("[DEBUG] Loading Team Members"); /* ... (Implementation, ensure escapeHtml) ... */ }

            // --- Feature/Section Loading ---
            function setActiveFeature(featureId, settingsTab = null) {
                console.log(`[DEBUG] --- setActiveFeature called with: ${featureId}, Tab: ${settingsTab} ---`);
                // Simplified RBAC Check
                if (featureId === 'settings' && settingsTab === 'danger' && currentUser?.role !== 'admin') { console.warn("Access denied: Danger Zone."); setActiveFeature('dashboard'); return; }

                currentFeature = featureId; currentSettingsTab = settingsTab || (featureId === 'settings' ? (currentSettingsTab || 'preferences') : null);
                let hash = `#${featureId}`; if (featureId === 'settings' && currentSettingsTab) { hash += `-${currentSettingsTab}`; } if (window.location.hash !== hash) { history.pushState({ feature: featureId, tab: currentSettingsTab }, '', hash); }

                menuItems.forEach(item => item?.classList.remove('active'));
                const activeMenuItem = document.querySelector(`.menu-item[data-feature="${featureId}"]`); if (activeMenuItem) activeMenuItem.classList.add('active');

                // Hide all static sections first
                document.querySelectorAll('.content-section').forEach(section => section.classList.remove('active'));
                // Hide dynamic container
                if(featureSectionsContainer) featureSectionsContainer.style.display = 'none';
                // Hide placeholder explicitly
                 if(featurePlaceholder) featurePlaceholder.style.display = 'none';


                console.log(`[DEBUG] Handling feature display for: ${featureId}`);
                if (featureId === 'dashboard') { const el = document.getElementById('dashboardContent'); if(el) el.classList.add('active'); else console.error("dashboardContent missing!"); updateStats(); loadActivities(); }
                else if (featureId === 'profile') { const el = document.getElementById('profileContent'); if(el) el.classList.add('active'); else console.error("profileContent missing!"); updateUserUI(); }
                else if (featureId === 'settings') { const el = document.getElementById('settingsContent'); if(el) el.classList.add('active'); else console.error("settingsContent missing!"); applyRBAC(); activateSettingsTab(currentSettingsTab || 'preferences'); }
                else {
                    // Handle dynamic features
                     console.log(`[DEBUG] Handling dynamic feature: ${featureId}`);
                     if (!featureSectionsContainer || !featureSections || !featurePlaceholder) { console.error("Dynamic feature elements missing!"); return; }
                     featureSectionsContainer.style.display = 'block'; // Show container
                     featureSections.innerHTML = ''; // Clear previous
                     featurePlaceholder.style.display = 'flex'; // Show placeholder
                     if(featureTitle) featureTitle.textContent = `Loading ${featureId}...`; if(featureDescription) featureDescription.textContent = ''; if(featureLoadingIndicator) featureLoadingIndicator.style.display = 'flex'; if(featureErrorMessage) featureErrorMessage.style.display = 'none';

                    const filePath = `sections/${featureId}.html`; console.log(`[DEBUG] Fetching: ${filePath}`);
                    fetch(filePath)
                        .then(response => { console.log(`[DEBUG] Fetch status for ${filePath}: ${response.status}`); if (!response.ok) { throw new Error(`HTTP ${response.status}: ${response.statusText}`); } return response.text(); })
                        .then(html => {
                             console.log(`[DEBUG] Fetched content for ${featureId}`); if (!featureSections) return; featureSections.innerHTML = html; if(featurePlaceholder) featurePlaceholder.style.display = 'none'; // Hide placeholder on success

                             // ----- Call Initialization Function -----
                             if (featureId === 'employee-scheduling') {
                                 if (typeof initializeEmployeeSchedule === 'function') {
                                     console.log("[DEBUG] Calling initializeEmployeeSchedule...");
                                     try { initializeEmployeeSchedule(JSON.parse(JSON.stringify(currentUser || DEFAULT_USER)), JSON.parse(JSON.stringify(teamMembers || []))); console.log("[DEBUG] initializeEmployeeSchedule OK."); }
                                     catch (err) { console.error(`[DEBUG] Error executing initializeEmployeeSchedule:`, err); if(featurePlaceholder) { featurePlaceholder.style.display = 'flex'; if(featureTitle) featureTitle.textContent=`Error Initializing`; if(featureDescription) featureDescription.textContent=`${err.message}`; if(featureLoadingIndicator) featureLoadingIndicator.style.display='none'; if(featureErrorMessage) featureErrorMessage.style.display='block'; } }
                                 } else { console.warn(`[DEBUG] Init function 'initializeEmployeeSchedule' not found.`); if(featurePlaceholder){ featurePlaceholder.style.display = 'flex'; if(featureTitle) featureTitle.textContent=`${featureId} (No Script)`; if(featureLoadingIndicator) featureLoadingIndicator.style.display='none'; } }
                             }
                             // ----- End Initialization Call -----
                        })
                        .catch(error => {
                            console.error(`[DEBUG] Error loading feature '${featureId}':`, error); if(featurePlaceholder) { featurePlaceholder.style.display = 'flex'; if(featureTitle) featureTitle.textContent=`Error Loading`; if(featureDescription) featureDescription.textContent=`${error.message}`; if(featureLoadingIndicator) featureLoadingIndicator.style.display='none'; if(featureErrorMessage) featureErrorMessage.style.display='block'; }
                        });
                }
                const backBtn = document.getElementById('backButton'); if(backBtn) backBtn.style.display = featureId !== 'dashboard' ? 'inline-flex' : 'none';
                window.scrollTo(0, 0);
                console.log(`[DEBUG] setActiveFeature finished for: ${featureId}`);
            }

            function activateSettingsTab(tabId) { /* ... (Implementation) ... */ }
            function handleInitialNavigation() { console.log("[DEBUG] Handling Initial Navigation"); /* ... (Implementation) ... */ }

            // --- Modals ---
            function showConfirmModal(config) { console.log("[DEBUG] showConfirmModal called"); if (!confirmModal || !confirmTitle || !confirmMessage || !confirmBtn || !cancelConfirmBtn) { console.error("Confirm modal elements missing!"); if (confirm(config.message || 'Are you sure?')) { if(config.onConfirm) config.onConfirm(); } else { if(config.onCancel) config.onCancel(); } return; } confirmTitle.textContent = config.title || 'Confirm'; confirmMessage.innerHTML = config.message || 'Are you sure?'; confirmBtn.textContent = config.confirmText || 'Confirm'; cancelConfirmBtn.textContent = config.cancelText || 'Cancel'; confirmBtn.className = `btn ${config.confirmClass || 'btn-danger'}`; const newConfirmBtn = confirmBtn.cloneNode(true); confirmBtn.parentNode.replaceChild(newConfirmBtn, confirmBtn); confirmBtn = newConfirmBtn; const newCancelBtn = cancelConfirmBtn.cloneNode(true); cancelConfirmBtn.parentNode.replaceChild(newCancelBtn, cancelConfirmBtn); cancelConfirmBtn = newCancelBtn; confirmCallback = config.onConfirm || null; cancelCallback = config.onCancel || null; confirmBtn.addEventListener('click', handleConfirm); cancelConfirmBtn.addEventListener('click', handleCancel); confirmModal.style.display = 'flex'; confirmBtn.focus(); }
            function hideConfirmModal() { console.log("[DEBUG] hideConfirmModal called"); if (!confirmModal) return; confirmModal.style.display = 'none'; confirmBtn?.removeEventListener('click', handleConfirm); cancelConfirmBtn?.removeEventListener('click', handleCancel); confirmCallback = null; cancelCallback = null; }
            function handleConfirm() { if (confirmCallback) confirmCallback(); hideConfirmModal(); }
            function handleCancel() { if (cancelCallback) cancelCallback(); hideConfirmModal(); }
            function showSuccessMessage(message) { console.log(`[DEBUG] Success: ${message}`); if (!successMessage || !successMessageText) return; successMessageText.textContent = message; successMessage.classList.add('show'); setTimeout(() => { successMessage.classList.remove('show'); }, 3000); }

            // --- Action Handlers (Placeholders - Implement full logic) ---
            function handleProfileSave(e) { e.preventDefault(); console.log("[DEBUG] Profile Save triggered"); showSuccessMessage("Profile Save Placeholder"); }
            function handleProfileCancel() { console.log("[DEBUG] Profile Cancel triggered"); setActiveFeature('dashboard'); }
            function handleSettingsSave(formId, panelId, successMsg) { console.log(`[DEBUG] Settings Save triggered for ${panelId}`); showSuccessMessage(`${successMsg} (Placeholder)`); }
            function handleSettingsCancel(panelId) { console.log(`[DEBUG] Settings Cancel triggered for ${panelId}`); loadSettingsFormData(); }
            function handleInviteMember(e) { e.preventDefault(); console.log("[DEBUG] Invite Member triggered"); showSuccessMessage("Invite Sent (Placeholder)"); inviteMemberForm?.reset(); }
            function handleEditMemberClick(e) { const id = e.target.closest('.team-member-card')?.dataset.id; console.log(`[DEBUG] Edit Member ${id} triggered`); showSuccessMessage(`Edit ${id} Placeholder`); }
            function handleDeleteMemberClick(e) { const card = e.target.closest('.team-member-card'); const id = card?.dataset.id; const name = card?.querySelector('.member-name')?.textContent || `member ${id}`; console.log(`[DEBUG] Delete Member ${id} triggered`); showConfirmModal({ title:'Delete?', message:`Remove ${name}?`, onConfirm: () => { console.log("Confirmed delete"); showSuccessMessage("Delete Placeholder"); } }); }
            function handleDeleteActivityClick(e) { const id = e.target.closest('.activity-item')?.dataset.id; console.log(`[DEBUG] Delete Activity ${id} triggered`); showConfirmModal({ title:'Delete?', message:'Delete activity?', onConfirm: () => { showSuccessMessage("Delete Placeholder"); } }); }
            function handleDeleteAllActivities() { console.log("[DEBUG] Delete All Activities triggered"); showConfirmModal({ title:'Delete All?', message:'Delete all activities?', onConfirm: () => { showSuccessMessage("Delete All Placeholder"); } }); }
            function markNotificationAsRead(id, el) { console.log(`[DEBUG] Mark Notification ${id} as read`); const n = notifications.find(notif => notif.id == id); if (n && !n.read) { n.read = true; saveData(); el?.classList.remove('unread'); updateNotificationBadge(); } }
            function handleMarkAllNotificationsRead() { console.log("[DEBUG] Mark All Notifications Read triggered"); showSuccessMessage("Mark All Read Placeholder"); }
            function handleDeleteNotificationClick(id) { console.log(`[DEBUG] Delete Notification ${id} triggered`); showConfirmModal({ title:'Delete?', message:'Delete notification?', onConfirm: () => { showSuccessMessage("Delete Placeholder"); } }); }
            function handleDeleteAllNotifications() { console.log("[DEBUG] Delete All Notifications triggered"); showConfirmModal({ title:'Delete All?', message:'Delete all notifications?', onConfirm: () => { showSuccessMessage("Delete All Placeholder"); } }); }
            function handleAvatarUpload(e) { console.log("[DEBUG] Avatar Upload triggered"); showSuccessMessage("Avatar Upload Placeholder"); }
            function handleLogout() { console.log("[DEBUG] Logout triggered"); showConfirmModal({ title: 'Logout?', message: 'Are you sure?', confirmText: 'Logout', confirmClass: 'btn-danger', onConfirm: () => { showSuccessMessage("Logging out..."); setTimeout(() => { window.location.href = 'login.html'; }, 500); } }); }
            function escapeHtml(unsafe) { if (typeof unsafe !== 'string') return unsafe; return unsafe.replace(/&/g, "&").replace(/</g, "<").replace(/>/g, ">").replace(/"/g, """).replace(/'/g, "'"); }
            function addActivity(icon, message) { /* ... */ }
            function addNotification(icon, message) { /* ... */ }
            function playNotificationSound() { /* ... */ }
            function handleSearch() { /* ... */ }

            // --- Event Listener Setup ---
            function setupEventListeners() {
                console.log("[DEBUG] Setting up event listeners...");
                menuItems.forEach(item => { item.addEventListener('click', (e) => { e.preventDefault(); console.log(`[DEBUG] Menu item clicked: ${item.dataset.feature}`); setActiveFeature(item.dataset.feature); }); });
                if(backButton) backButton.addEventListener('click', () => { console.log("[DEBUG] Back button clicked"); setActiveFeature('dashboard'); });
                window.addEventListener('popstate', (event) => { console.log("[DEBUG] Popstate event"); if (event.state) { setActiveFeature(event.state.feature, event.state.tab); } else { handleInitialNavigation(); } });
                // ... (Add listeners for other elements like search, user dropdown, modals, forms etc.) ...
                 // Add remaining listeners, checking for element existence
                if(searchInput) { searchInput.addEventListener('input', handleSearch); searchInput.addEventListener('focus', handleSearch); }
                document.addEventListener('click', (e) => { if (!e.target.closest('.search-bar') && searchResults) { searchResults.classList.remove('active'); searchResults.innerHTML = ''; } });
                if(userAvatar) userAvatar.addEventListener('click', () => userDropdown?.classList.toggle('active'));
                if(userProfileDetails) userProfileDetails.addEventListener('click', () => userDropdown?.classList.toggle('active'));
                if(profileLink) profileLink.addEventListener('click', (e) => { e.preventDefault(); userDropdown?.classList.remove('active'); setActiveFeature('profile'); });
                if(settingsLink) settingsLink.addEventListener('click', (e) => { e.preventDefault(); userDropdown?.classList.remove('active'); setActiveFeature('settings'); });
                if(logoutLink) logoutLink.addEventListener('click', (e) => { e.preventDefault(); userDropdown?.classList.remove('active'); handleLogout(); });
                document.addEventListener('click', (e) => { if (!e.target.closest('.user-profile') && userDropdown) userDropdown.classList.remove('active'); });
                if(notificationIcon) notificationIcon.addEventListener('click', () => { if(notificationsModal) notificationsModal.style.display = 'flex'; loadNotifications(); });
                if(closeNotifications) closeNotifications.addEventListener('click', () => { if(notificationsModal) notificationsModal.style.display = 'none'; });
                if(notificationsModal) notificationsModal.addEventListener('click', (e) => { if (e.target === notificationsModal) notificationsModal.style.display = 'none'; });
                if(markAllReadBtn) markAllReadBtn.addEventListener('click', handleMarkAllNotificationsRead);
                if(deleteAllNotificationsBtn) deleteAllNotificationsBtn.addEventListener('click', handleDeleteAllNotifications);
                if(viewAllActivity) viewAllActivity.addEventListener('click', () => loadActivities(true));
                if(deleteAllActivity) deleteAllActivity.addEventListener('click', handleDeleteAllActivities);
                if(profileForm) profileForm.addEventListener('submit', handleProfileSave);
                if(cancelProfileBtn) cancelProfileBtn.addEventListener('click', handleProfileCancel);
                if(uploadPhotoButton) uploadPhotoButton.addEventListener('click', () => profileAvatarInput?.click());
                if(profileAvatarInput) profileAvatarInput.addEventListener('change', handleAvatarUpload);
                settingsTabs.forEach(tab => { tab.addEventListener('click', () => { if (!tab.classList.contains('disabled')) { activateSettingsTab(tab.dataset.tab); } }); });
                if(preferencesForm) preferencesForm.addEventListener('submit', (e) => { e.preventDefault(); handleSettingsSave('preferencesForm', 'preferencesPanel', 'Preferences saved.'); });
                if(cancelPreferencesBtn) cancelPreferencesBtn.addEventListener('click', () => handleSettingsCancel('preferencesPanel'));
                if(accountForm) accountForm.addEventListener('submit', (e) => { e.preventDefault(); handleSettingsSave('accountForm', 'accountPanel', 'Account settings saved.'); });
                if(cancelAccountBtn) cancelAccountBtn.addEventListener('click', () => handleSettingsCancel('accountPanel'));
                if(securityForm) securityForm.addEventListener('submit', (e) => { e.preventDefault(); handleSettingsSave('securityForm', 'securityPanel', 'Security settings updated.'); });
                if(cancelSecurityBtn) cancelSecurityBtn.addEventListener('click', () => handleSettingsCancel('securityPanel'));
                if(notificationsForm) notificationsForm.addEventListener('submit', (e) => { e.preventDefault(); handleSettingsSave('notificationsForm', 'notificationsPanel', 'Notification settings saved.'); });
                if(cancelNotificationsBtn) cancelNotificationsBtn.addEventListener('click', () => handleSettingsCancel('notificationsPanel'));
                themeOptions.forEach(option => { option.addEventListener('click', function() { const theme = this.dataset.theme; if(document.getElementById('selectedTheme')) document.getElementById('selectedTheme').value = theme; currentUser.preferences.theme = theme; applyUserPreferences(); }); });
                if(layoutDensitySelect) layoutDensitySelect.addEventListener('change', function() { currentUser.preferences.layoutDensity = this.value; applyUserPreferences(); });
                if(inviteMemberForm) inviteMemberForm.addEventListener('submit', handleInviteMember);
                document.addEventListener('keydown', (e) => { if (e.key === 'Escape') { if (confirmModal?.style.display === 'flex') { hideConfirmModal(); } if (notificationsModal?.style.display === 'flex') { notificationsModal.style.display = 'none'; } } });
                console.log("[DEBUG] Event listeners setup complete.");
            }

            // --- Run Initialization ---
            initDashboard();
        });
    </script>
</body>
</html>
