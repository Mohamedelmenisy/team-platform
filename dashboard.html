<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TeamFlow | Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Favicon links -->
    <link rel="icon" type="image/png" sizes="32x32" href="https://img.icons8.com/fluency/48/000000/group-task.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://img.icons8.com/fluency/32/000000/group-task.png">
    <link rel="apple-touch-icon" sizes="180x180" href="https://img.icons8.com/fluency/180/000000/group-task.png">
    <link rel="manifest" href="site.webmanifest">
    <style>
        :root {
            --primary: #2563eb;
            --primary-dark: #1e3a8a;
            --primary-light: #dbeafe;
            --secondary: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --dark: #1e293b;
            --light: #f8fafc;
            --gray: #64748b;
            --light-gray: #e2e8f0;
            --white: #ffffff;
            --sidebar-width: 280px;
            --sidebar-bg: #1e3a8a;
            --sidebar-text: rgba(255,255,255,0.9);
            --sidebar-hover: rgba(255,255,255,0.1);
            --sidebar-active: rgba(255,255,255,0.2);
            --sidebar-divider: rgba(255,255,255,0.1);
            --success: #10b981;
            --team-manager: #ef4444;
            --compact-padding: 0.5rem;
            --normal-padding: 1rem;
            --spacious-padding: 1.5rem;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--primary-light);
            color: var(--dark);
            display: flex;
            min-height: 100vh;
            transition: all 0.3s ease;
        }
        
        /* Sidebar Styles */
        .sidebar {
            width: var(--sidebar-width);
            background-color: var(--sidebar-bg);
            height: 100vh;
            position: fixed;
            overflow-y: auto;
            transition: all 0.3s;
            z-index: 100;
        }
        
        .sidebar-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--sidebar-divider);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .logo {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--white);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .logo-icon {
            color: var(--white);
            font-size: 1.5rem;
        }
        
        .sidebar-menu {
            padding: 1rem 0;
        }
        
        .menu-title {
            padding: 0.75rem 1.5rem;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            color: rgba(255,255,255,0.6);
            letter-spacing: 0.5px;
        }
        
        .menu-item {
            display: flex;
            align-items: center;
            padding: 0.75rem 1.5rem;
            color: var(--sidebar-text);
            text-decoration: none;
            transition: all 0.2s;
            border-left: 3px solid transparent;
            margin: 0.25rem 0;
        }
        
        .menu-item:hover {
            background-color: var(--sidebar-hover);
            color: var(--white);
        }
        
        .menu-item.active {
            background-color: var(--sidebar-active);
            color: var(--white);
            border-left-color: var(--white);
        }
        
        .menu-item i {
            margin-right: 0.75rem;
            font-size: 1.1rem;
            width: 24px;
            text-align: center;
        }
        
        .menu-divider {
            height: 1px;
            background-color: var(--sidebar-divider);
            margin: 1rem 1.5rem;
        }
        
        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: var(--sidebar-width);
            transition: all 0.3s;
        }
        
        /* Top Navigation */
        .top-nav {
            background-color: var(--white);
            padding: var(--normal-padding) 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--light-gray);
            position: sticky;
            top: 0;
            z-index: 90;
        }
        
        /* Compact layout */
        body.compact .top-nav {
            padding: var(--compact-padding) 1rem;
        }
        
        /* Spacious layout */
        body.spacious .top-nav {
            padding: var(--spacious-padding) 2rem;
        }
        
        .search-bar {
            position: relative;
            width: 400px;
        }
        
        .search-bar input {
            width: 100%;
            padding: 0.75rem 1rem 0.75rem 2.5rem;
            border: 1px solid var(--light-gray);
            border-radius: 6px;
            font-size: 0.9rem;
            transition: all 0.2s;
        }
        
        .search-bar input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }
        
        .search-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
        }
        
        .search-results {
            position: absolute;
            top: 100%;
            left: 0;
            width: 100%;
            background-color: var(--white);
            border: 1px solid var(--light-gray);
            border-radius: 0 0 6px 6px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            z-index: 100;
            display: none;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .search-results.active {
            display: block;
        }
        
        .search-result-item {
            padding: 0.75rem 1rem;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .search-result-item:hover {
            background-color: var(--primary-light);
        }
        
        .user-menu {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }
        
        .notification-icon {
            position: relative;
            color: var(--gray);
            cursor: pointer;
        }
        
        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: var(--danger);
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.65rem;
            font-weight: 600;
        }
        
        .user-profile {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            position: relative;
        }
        
        .user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            cursor: pointer;
            background-size: cover;
            background-position: center;
        }
        
        .user-name {
            font-weight: 500;
            cursor: pointer;
        }
        
        .user-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background-color: var(--white);
            border: 1px solid var(--light-gray);
            border-radius: 6px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            width: 200px;
            z-index: 100;
            display: none;
        }
        
        .user-dropdown.active {
            display: block;
        }
        
        .dropdown-item {
            padding: 0.75rem 1rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            color: var(--dark);
            text-decoration: none;
            transition: background-color 0.2s;
        }
        
        .dropdown-item:hover {
            background-color: var(--light);
        }
        
        .dropdown-item i {
            width: 20px;
            text-align: center;
        }
        
        /* Content Area */
        .content-area {
            padding: 2rem;
            min-height: calc(100vh - 70px);
        }
        
        /* Compact layout */
        body.compact .content-area {
            padding: 1rem;
        }
        
        /* Spacious layout */
        body.spacious .content-area {
            padding: 3rem;
        }
        
        .welcome-section {
            background-color: var(--primary);
            color: var(--white);
            padding: 2rem;
            border-radius: 8px;
            margin-bottom: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        /* Compact layout */
        body.compact .welcome-section {
            padding: 1rem;
            margin-bottom: 1rem;
        }
        
        /* Spacious layout */
        body.spacious .welcome-section {
            padding: 3rem;
            margin-bottom: 3rem;
        }
        
        .welcome-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        
        /* Compact layout */
        body.compact .welcome-title {
            font-size: 1.25rem;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            margin-top: 1.5rem;
        }
        
        /* Compact layout */
        body.compact .user-info {
            flex-direction: column;
            text-align: center;
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .user-info-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background-color: var(--primary-light);
            color: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 1.75rem;
            background-size: cover;
            background-position: center;
            position: relative;
            cursor: pointer;
        }
        
        /* Compact layout */
        body.compact .user-info-avatar {
            width: 60px;
            height: 60px;
            font-size: 1.25rem;
        }
        
        .avatar-upload {
            position: absolute;
            bottom: 0;
            right: 0;
            background-color: var(--white);
            color: var(--primary);
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            border: 2px solid var(--primary);
            cursor: pointer;
        }
        
        /* Compact layout */
        body.compact .avatar-upload {
            width: 24px;
            height: 24px;
            font-size: 0.6rem;
        }
        
        .user-info-details {
            flex: 1;
        }
        
        .user-info-name {
            font-weight: 600;
            font-size: 1.25rem;
            margin-bottom: 0.25rem;
        }
        
        /* Compact layout */
        body.compact .user-info-name {
            font-size: 1rem;
        }
        
        .user-info-title {
            opacity: 0.9;
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
            color: var(--team-manager);
            font-weight: 600;
        }
        
        /* Compact layout */
        body.compact .user-info-title {
            font-size: 0.8rem;
        }
        
        .user-info-email {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .user-info-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            opacity: 0.9;
            color: var(--success);
        }
        
        /* Stats Section */
        .stats-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        /* Compact layout */
        body.compact .stats-section {
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        /* Spacious layout */
        body.spacious .stats-section {
            gap: 2rem;
            margin-bottom: 3rem;
        }
        
        .stat-card {
            background-color: var(--white);
            border-radius: 8px;
            padding: 1.5rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s, box-shadow 0.2s;
            position: relative;
            overflow: hidden;
        }
        
        /* Compact layout */
        body.compact .stat-card {
            padding: 1rem;
        }
        
        /* Spacious layout */
        body.spacious .stat-card {
            padding: 2rem;
        }
        
        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--primary-dark));
        }
        
        .stat-title {
            font-size: 0.9rem;
            color: var(--gray);
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        /* Compact layout */
        body.compact .stat-title {
            font-size: 0.8rem;
        }
        
        .stat-title i {
            color: var(--primary);
        }
        
        .stat-value {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--primary-dark);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        /* Compact layout */
        body.compact .stat-value {
            font-size: 1.5rem;
        }
        
        .stat-trend {
            display: flex;
            align-items: center;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        /* Compact layout */
        body.compact .stat-trend {
            font-size: 0.8rem;
        }
        
        .trend-up {
            color: var(--secondary);
        }
        
        .trend-down {
            color: var(--danger);
        }
        
        .trend-neutral {
            color: var(--gray);
        }
        
        /* Activity Section */
        .activity-section {
            background-color: var(--white);
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
        }
        
        /* Compact layout */
        body.compact .activity-section {
            padding: 1rem;
        }
        
        /* Spacious layout */
        body.spacious .activity-section {
            padding: 2rem;
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        
        /* Compact layout */
        body.compact .section-header {
            margin-bottom: 1rem;
        }
        
        /* Spacious layout */
        body.spacious .section-header {
            margin-bottom: 2rem;
        }
        
        .section-title {
            font-size: 1.25rem;
            font-weight: 600;
        }
        
        /* Compact layout */
        body.compact .section-title {
            font-size: 1.1rem;
        }
        
        .live-badge {
            display: inline-flex;
            align-items: center;
            background-color: var(--danger);
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-left: 0.5rem;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.05); opacity: 0.8; }
            100% { transform: scale(1); opacity: 1; }
        }
        
        .view-all {
            color: var(--primary);
            font-weight: 500;
            cursor: pointer;
            transition: color 0.2s;
            padding: 0.5rem;
            border-radius: 4px;
        }
        
        .view-all:hover {
            color: var(--primary-dark);
            text-decoration: underline;
            background-color: var(--primary-light);
        }
        
        .delete-all {
            color: var(--danger);
            font-weight: 500;
            cursor: pointer;
            transition: color 0.2s;
            padding: 0.5rem;
            border-radius: 4px;
            margin-left: 1rem;
        }
        
        .delete-all:hover {
            color: #dc2626;
            text-decoration: underline;
            background-color: rgba(239, 68, 68, 0.1);
        }
        
        .activity-list {
            list-style: none;
        }
        
        .activity-item {
            display: flex;
            padding: 1rem 0;
            border-bottom: 1px solid var(--light-gray);
            align-items: center;
            transition: background-color 0.3s;
        }
        
        /* Compact layout */
        body.compact .activity-item {
            padding: 0.75rem 0;
        }
        
        /* Spacious layout */
        body.spacious .activity-item {
            padding: 1.25rem 0;
        }
        
        .activity-item:last-child {
            border-bottom: none;
        }
        
        .activity-item.new-activity {
            background-color: rgba(37, 99, 235, 0.05);
            animation: highlight 2s;
        }

        @keyframes highlight {
            0% { background-color: rgba(37, 99, 235, 0.2); }
            100% { background-color: rgba(37, 99, 235, 0.05); }
        }
        
        .activity-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: rgba(37, 99, 235, 0.1);
            color: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 1rem;
            flex-shrink: 0;
        }
        
        /* Compact layout */
        body.compact .activity-icon {
            width: 32px;
            height: 32px;
            margin-right: 0.75rem;
            font-size: 0.9rem;
        }
        
        .activity-content {
            flex: 1;
        }
        
        .activity-message {
            margin-bottom: 0.25rem;
        }
        
        /* Compact layout */
        body.compact .activity-message {
            font-size: 0.9rem;
        }
        
        .activity-time {
            font-size: 0.8rem;
            color: var(--gray);
        }
        
        /* Compact layout */
        body.compact .activity-time {
            font-size: 0.7rem;
        }
        
        .activity-actions {
            display: flex;
            gap: 0.5rem;
            margin-left: auto;
            padding-left: 1rem;
        }
        
        .delete-activity {
            color: var(--danger);
            cursor: pointer;
            opacity: 1;
            transition: opacity 0.2s;
            padding: 0.5rem;
            border-radius: 4px;
        }
        
        .delete-activity:hover {
            background-color: rgba(239, 68, 68, 0.1);
        }
        
        /* Profile Content */
        .profile-content {
            display: none;
            background-color: var(--white);
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            padding: 2rem;
        }
        
        /* Compact layout */
        body.compact .profile-content {
            padding: 1rem;
        }
        
        /* Spacious layout */
        body.spacious .profile-content {
            padding: 3rem;
        }
        
        .profile-content.active {
            display: block;
        }
        
        .profile-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }
        
        /* Compact layout */
        body.compact .profile-header {
            margin-bottom: 1.5rem;
        }
        
        /* Spacious layout */
        body.spacious .profile-header {
            margin-bottom: 3rem;
        }
        
        .profile-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--primary-dark);
        }
        
        /* Compact layout */
        body.compact .profile-title {
            font-size: 1.25rem;
        }
        
        .profile-form {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }
        
        /* Compact layout */
        body.compact .profile-form {
            gap: 1rem;
        }
        
        /* Spacious layout */
        body.spacious .profile-form {
            gap: 2rem;
        }
        
        .form-group {
            margin-bottom: 1rem;
        }
        
        /* Compact layout */
        body.compact .form-group {
            margin-bottom: 0.75rem;
        }
        
        /* Spacious layout */
        body.spacious .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--dark);
        }
        
        /* Compact layout */
        body.compact .form-group label {
            margin-bottom: 0.25rem;
            font-size: 0.9rem;
        }
        
        .form-control {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--light-gray);
            border-radius: 6px;
            font-size: 1rem;
        }
        
        /* Compact layout */
        body.compact .form-control {
            padding: 0.5rem;
            font-size: 0.9rem;
        }
        
        /* Spacious layout */
        body.spacious .form-control {
            padding: 1rem;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }
        
        .form-actions {
            grid-column: span 2;
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
            margin-top: 1rem;
        }
        
        /* Compact layout */
        body.compact .form-actions {
            margin-top: 0.5rem;
        }
        
        /* Spacious layout */
        body.spacious .form-actions {
            margin-top: 2rem;
        }
        
        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        /* Compact layout */
        body.compact .btn {
            padding: 0.5rem 1rem;
            font-size: 0.9rem;
        }
        
        /* Spacious layout */
        body.spacious .btn {
            padding: 1rem 2rem;
        }
        
        .btn-primary {
            background-color: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: var(--primary-dark);
        }
        
        .btn-outline {
            background-color: transparent;
            border: 1px solid var(--primary);
            color: var(--primary);
        }
        
        .btn-outline:hover {
            background-color: var(--primary-light);
        }
        
        .btn-danger {
            background-color: var(--danger);
            color: white;
        }
        
        .btn-danger:hover {
            background-color: #dc2626;
        }

        .btn-success {
            background-color: var(--success);
            color: white;
        }
        
        .btn-success:hover {
            background-color: #0d9f6e;
        }
        
        /* Settings Content */
        .settings-content {
            display: none;
            background-color: var(--white);
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            padding: 2rem;
        }
        
        /* Compact layout */
        body.compact .settings-content {
            padding: 1rem;
        }
        
        /* Spacious layout */
        body.spacious .settings-content {
            padding: 3rem;
        }
        
        .settings-content.active {
            display: block;
        }
        
        .settings-tabs {
            display: flex;
            border-bottom: 1px solid var(--light-gray);
            margin-bottom: 2rem;
        }
        
        /* Compact layout */
        body.compact .settings-tabs {
            margin-bottom: 1.5rem;
        }
        
        /* Spacious layout */
        body.spacious .settings-tabs {
            margin-bottom: 3rem;
        }
        
        .settings-tab {
            padding: 0.75rem 1.5rem;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            font-weight: 500;
            color: var(--gray);
            transition: all 0.2s;
        }
        
        /* Compact layout */
        body.compact .settings-tab {
            padding: 0.5rem 1rem;
            font-size: 0.9rem;
        }
        
        /* Spacious layout */
        body.spacious .settings-tab {
            padding: 1rem 2rem;
        }
        
        .settings-tab:hover {
            color: var(--primary);
        }
        
        .settings-tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }
        
        .settings-panel {
            display: none;
        }
        
        .settings-panel.active {
            display: block;
        }
        
        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        
        /* Compact layout */
        body.compact .switch {
            width: 40px;
            height: 20px;
        }
        
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
        }
        
        /* Compact layout */
        body.compact .slider:before {
            height: 14px;
            width: 14px;
        }
        
        input:checked + .slider {
            background-color: var(--primary);
        }
        
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        
        /* Compact layout */
        body.compact input:checked + .slider:before {
            transform: translateX(20px);
        }
        
        .slider.round {
            border-radius: 34px;
        }
        
        .slider.round:before {
            border-radius: 50%;
        }
        
        /* Team Management */
        .team-management {
            margin-top: 1.5rem;
        }
        
        /* Compact layout */
        body.compact .team-management {
            margin-top: 1rem;
        }
        
        /* Spacious layout */
        body.spacious .team-management {
            margin-top: 2rem;
        }
        
        .team-list {
            margin-top: 1rem;
        }
        
        /* Compact layout */
        body.compact .team-list {
            margin-top: 0.75rem;
        }
        
        /* Spacious layout */
        body.spacious .team-list {
            margin-top: 1.5rem;
        }
        
        .team-member-card {
            display: flex;
            align-items: center;
            padding: 1rem;
            border: 1px solid var(--light-gray);
            border-radius: 8px;
            margin-bottom: 1rem;
            transition: all 0.2s;
        }
        
        /* Compact layout */
        body.compact .team-member-card {
            padding: 0.75rem;
            margin-bottom: 0.75rem;
        }
        
        /* Spacious layout */
        body.spacious .team-member-card {
            padding: 1.25rem;
            margin-bottom: 1.25rem;
        }
        
        .team-member-card:hover {
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }
        
        .member-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: var(--light-gray);
            margin-right: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            background-size: cover;
            background-position: center;
        }
        
        /* Compact layout */
        body.compact .member-avatar {
            width: 40px;
            height: 40px;
            margin-right: 0.75rem;
            font-size: 0.9rem;
        }
        
        .member-details {
            flex: 1;
        }
        
        .member-name {
            font-weight: 500;
            margin-bottom: 0.25rem;
        }
        
        /* Compact layout */
        body.compact .member-name {
            font-size: 0.9rem;
        }
        
        .member-email {
            font-size: 0.9rem;
            color: var(--gray);
        }
        
        /* Compact layout */
        body.compact .member-email {
            font-size: 0.8rem;
        }
        
        .member-role {
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 500;
        }
        
        /* Compact layout */
        body.compact .member-role {
            font-size: 0.7rem;
        }
        
        .role-admin {
            background-color: rgba(239, 68, 68, 0.1);
            color: var(--danger);
        }
        
        .role-senior {
            background-color: rgba(59, 130, 246, 0.1);
            color: #2563eb;
        }
        
        .role-supervisor {
            background-color: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }
        
        .role-member {
            background-color: rgba(16, 185, 129, 0.1);
            color: var(--secondary);
        }
        
        .member-actions {
            display: flex;
            gap: 0.5rem;
        }
        
        .add-member-form {
            margin-top: 2rem;
            padding: 1.5rem;
            border: 1px dashed var(--light-gray);
            border-radius: 8px;
        }
        
        /* Compact layout */
        body.compact .add-member-form {
            margin-top: 1.5rem;
            padding: 1rem;
        }
        
        /* Spacious layout */
        body.spacious .add-member-form {
            margin-top: 3rem;
            padding: 2rem;
        }
        
        /* Theme Classes */
        body.light-theme {
            --primary-light: #f8fafc;
            --light: #ffffff;
            --white: #ffffff;
            --dark: #1e293b;
            background-color: #f8fafc;
        }
        
        body.dark-theme {
            --primary-light: #1e293b;
            --light: #334155;
            --white: #1e293b;
            --dark: #f8fafc;
            background-color: #0f172a;
        }
        
        body.blue-theme {
            --primary-light: #dbeafe;
            --light: #eff6ff;
            --white: #ffffff;
            --dark: #1e293b;
            background-color: #dbeafe;
        }
        
        /* Notifications Modal */
        .notifications-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            display: none;
            justify-content: flex-end;
        }
        
        .notifications-container {
            width: 400px;
            max-width: 100%;
            background-color: var(--white);
            height: 100vh;
            overflow-y: auto;
            animation: slideIn 0.3s ease-out;
            box-shadow: -2px 0 10px rgba(0, 0, 0, 0.1);
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }
        
        .notifications-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--light-gray);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: var(--primary);
            color: white;
        }
        
        .notifications-title {
            font-size: 1.25rem;
            font-weight: 600;
        }
        
        .close-notifications {
            background: none;
            border: none;
            font-size: 1.25rem;
            cursor: pointer;
            color: white;
        }
        
        .notification-item {
            padding: 1rem 1.5rem;
            border-bottom: 1px solid var(--light-gray);
            transition: background-color 0.2s;
            display: flex;
            gap: 1rem;
        }
        
        .notification-item:hover {
            background-color: var(--light);
        }
        
        .notification-item.unread {
            background-color: rgba(37, 99, 235, 0.05);
        }
        
        .notification-icon-wrapper {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: rgba(37, 99, 235, 0.1);
            color: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }
        
        .notification-content {
            flex: 1;
        }
        
        .notification-message {
            margin-bottom: 0.25rem;
        }
        
        .notification-time {
            font-size: 0.8rem;
            color: var(--gray);
        }
        
        .mark-all-read {
            padding: 1rem 1.5rem;
            text-align: center;
            border-bottom: 1px solid var(--light-gray);
        }
        
        /* Confirm Modal */
        .confirm-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1100;
            display: none;
            justify-content: center;
            align-items: center;
        }

        .confirm-container {
            background-color: var(--white);
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            width: 400px;
            max-width: 90%;
            padding: 1.5rem;
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .confirm-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--danger);
        }

        .confirm-message {
            margin-bottom: 1.5rem;
            line-height: 1.5;
        }

        .confirm-actions {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
        }

        /* Success Message */
        .success-message {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: var(--success);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 6px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            z-index: 1200;
            transform: translateX(120%);
            transition: transform 0.3s ease-out;
        }

        .success-message.show {
            transform: translateX(0);
        }

        .success-message i {
            font-size: 1.25rem;
        }
        
        /* Responsive Design */
        @media (max-width: 992px) {
            .sidebar {
                transform: translateX(-100%);
            }
            
            .sidebar.active {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0;
            }
            
            .search-bar {
                width: 250px;
            }
        }
        
        @media (max-width: 768px) {
            .top-nav {
                flex-direction: column;
                gap: 1rem;
                padding: 1rem;
            }
            
            .search-bar {
                width: 100%;
            }
            
            .user-menu {
                width: 100%;
                justify-content: space-between;
            }
            
            .content-area {
                padding: 1.5rem;
            }
            
            .profile-form {
                grid-template-columns: 1fr;
            }
            
            .form-actions {
                grid-column: span 1;
            }
            
            .user-info {
                flex-direction: column;
                text-align: center;
            }
            
            .user-info-avatar {
                margin-bottom: 1rem;
            }
            
            .stats-section {
                grid-template-columns: 1fr;
            }
        }
        
        /* Back button */
        .back-button {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--primary);
            font-weight: 500;
            cursor: pointer;
            margin-bottom: 1rem;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            transition: background-color 0.2s;
        }
        
        .back-button:hover {
            background-color: var(--primary-light);
            text-decoration: none;
        }
        
        /* Notification sound */
        #notificationSound {
            display: none;
        }

        /* Hidden class */
        .d-none {
            display: none !important;
        }

        /* Favicon in URL */
        .favicon-url {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .favicon-url img {
            width: 16px;
            height: 16px;
        }

        /* Connection status */
        .connection-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--success);
            font-size: 0.9rem;
            margin-left: 1.5rem;
            margin-top: 0.5rem;
            opacity: 0.9;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: var(--success);
            animation: pulse 2s infinite;
        }

        /* Admin message styling */
        .admin-message {
            background-color: rgba(239, 68, 68, 0.1);
            border-left: 3px solid var(--danger);
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 4px 4px 0;
        }

        .admin-message p {
            margin: 0;
            color: var(--danger);
            font-weight: 500;
        }
        
        /* Password error message */
        .password-error {
            color: var(--danger);
            font-size: 0.85rem;
            margin-top: 0.25rem;
            display: none;
        }
        
        /* Loading spinner */
        .spinner {
            width: 24px;
            height: 24px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            display: none;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Loading text */
        .loading-text {
            display: none;
            font-size: 0.9rem;
            color: var(--gray);
            margin-left: 0.5rem;
        }
    </style>
</head>
<body class="blue-theme">
    <!-- Notification sound (hidden) -->
    <audio id="notificationSound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-positive-interface-beep-221.mp3" type="audio/mpeg">
    </audio>

    <!-- Success message -->
    <div class="success-message" id="successMessage">
        <i class="fas fa-check-circle"></i>
        <span id="successMessageText">Profile updated successfully!</span>
    </div>

    <!-- Sidebar Navigation -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <i class="fas fa-users-cog logo-icon"></i>
                <span>TeamFlow</span>
            </div>
        </div>
        
        <div class="sidebar-menu">
            <div class="menu-title">Main Features</div>
            
            <a href="#dashboard" class="menu-item active" data-feature="dashboard">
                <i class="fas fa-tachometer-alt"></i>
                <span>Dashboard</span>
            </a>
            
            <div class="menu-divider"></div>
            
            <a href="#file-sharing" class="menu-item" data-feature="file-sharing">
                <i class="fas fa-file-upload"></i>
                <span>File Sharing</span>
            </a>
            
            <a href="#data-management" class="menu-item" data-feature="data-management">
                <i class="fas fa-database"></i>
                <span>Data Management</span>
            </a>
            
            <a href="#project-tracking" class="menu-item" data-feature="project-tracking">
                <i class="fas fa-project-diagram"></i>
                <span>Project Tracking</span>
            </a>
            
            <div class="menu-divider"></div>
            
            <a href="#task-management" class="menu-item" data-feature="task-management">
                <i class="fas fa-tasks"></i>
                <span>Task Management</span>
            </a>
            
            <a href="#employee-scheduling" class="menu-item" data-feature="employee-scheduling">
                <i class="fas fa-users"></i>
                <span>Employee Scheduling</span>
            </a>
            
            <a href="#team-calendar" class="menu-item" data-feature="team-calendar">
                <i class="fas fa-calendar-alt"></i>
                <span>Team Calendar</span>
            </a>
            
            <div class="menu-divider"></div>
            
            <a href="#deadline-tracking" class="menu-item" data-feature="deadline-tracking">
                <i class="fas fa-clock"></i>
                <span>Deadline Tracking</span>
            </a>
            
            <a href="#innovation-hub" class="menu-item" data-feature="innovation-hub">
                <i class="fas fa-lightbulb"></i>
                <span>Innovation Hub</span>
            </a>
            
            <div class="menu-divider"></div>
            
            <a href="#settings" class="menu-item" data-feature="settings">
                <i class="fas fa-cog"></i>
                <span>Settings</span>
            </a>

            <div class="connection-status">
                <div class="status-dot"></div>
                <span>Connected</span>
            </div>
        </div>
    </aside>

    <!-- Main Content Area -->
    <main class="main-content">
        <!-- Top Navigation -->
        <nav class="top-nav">
            <div class="search-bar">
                <i class="fas fa-search search-icon"></i>
                <input type="text" placeholder="Search employees, projects, tasks..." id="searchInput">
                <div class="search-results" id="searchResults"></div>
            </div>
            
            <div class="user-menu">
                <div class="notification-icon" id="notificationIcon">
                    <i class="fas fa-bell"></i>
                    <span class="notification-badge">3</span>
                </div>
                
                <div class="user-profile">
                    <div class="user-avatar" id="userAvatar">ME</div>
                    <div class="user-name" id="userName">Mohamed Elmenisy</div>
                    <div class="user-dropdown" id="userDropdown">
                        <a href="#profile" class="dropdown-item" id="profileLink">
                            <i class="fas fa-user"></i>
                            <span>Profile</span>
                        </a>
                        <a href="#settings" class="dropdown-item" id="settingsLink">
                            <i class="fas fa-cog"></i>
                            <span>Settings</span>
                        </a>
                        <a href="login.html" class="dropdown-item" id="logoutLink">
                            <i class="fas fa-sign-out-alt"></i>
                            <span>Logout</span>
                        </a>
                    </div>
                </div>
            </div>
        </nav>
        
        <!-- Content Area -->
        <div class="content-area">
            <!-- Back button (hidden by default) -->
            <div class="back-button" id="backButton" style="display: none;">
                <i class="fas fa-arrow-left"></i>
                <span>Back to Dashboard</span>
            </div>
            
            <!-- Dashboard Content -->
            <div id="dashboardContent">
                <!-- Welcome Section -->
                <div class="welcome-section">
                    <h2 class="welcome-title">Welcome, <span id="welcomeName">Mohamed</span>!</h2>
                    
                    <div class="user-info">
                        <div class="user-info-avatar" id="profileAvatar">ME</div>
                        <div class="user-info-details">
                            <div class="user-info-name">Mohamed Elmenisy</div>
                            <div class="user-info-title" id="userRoleTitle">Administrator</div>
                            <div class="user-info-email">
                                <i class="fas fa-envelope"></i>
                                <span id="userEmail">m.elsayed@thechefz.co</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Stats Section -->
                <div class="stats-section">
                    <div class="stat-card">
                        <div class="stat-title">
                            <i class="fas fa-users"></i>
                            Team Members
                        </div>
                        <div class="stat-value">
                            <span id="teamMembersCount">3</span>
                            <span class="stat-trend" id="teamMembersTrend">
                                <i class="fas fa-arrow-up"></i> 50%
                            </span>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-title">
                            <i class="fas fa-check-circle"></i>
                            Tasks Completed
                        </div>
                        <div class="stat-value">
                            <span id="tasksCompleted">12</span>
                            <span class="stat-trend" id="tasksCompletedTrend">
                                <i class="fas fa-arrow-up"></i> 20%
                            </span>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-title">
                            <i class="fas fa-project-diagram"></i>
                            Active Projects
                        </div>
                        <div class="stat-value">
                            <span id="activeProjects">5</span>
                            <span class="stat-trend" id="activeProjectsTrend">
                                <i class="fas fa-arrow-down"></i> 10%
                            </span>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-title">
                            <i class="fas fa-calendar-times"></i>
                            Upcoming Deadlines
                        </div>
                        <div class="stat-value">
                            <span id="upcomingDeadlines">2</span>
                            <span class="stat-trend" id="upcomingDeadlinesTrend">
                                <i class="fas fa-arrow-up"></i> 100%
                            </span>
                        </div>
                    </div>
                </div>
                
                <!-- Activity Section -->
                <div class="activity-section">
                    <div class="section-header">
                        <h3 class="section-title">Recent Activity <span class="live-badge">LIVE</span></h3>
                        <div>
                            <span class="view-all" id="viewAllActivity">Show All</span>
                            <span class="delete-all" id="deleteAllActivity">Delete All</span>
                        </div>
                    </div>
                    
                    <ul class="activity-list" id="activityList">
                        <li class="activity-item new-activity">
                            <div class="activity-icon">
                                <i class="fas fa-user-plus"></i>
                            </div>
                            <div class="activity-content">
                                <div class="activity-message">Mohamed Elmenisy added new member: john@teamflow.com</div>
                                <div class="activity-time">Just now</div>
                            </div>
                            <div class="activity-actions">
                                <i class="fas fa-trash delete-activity" data-id="1"></i>
                            </div>
                        </li>
                        <li class="activity-item">
                            <div class="activity-icon">
                                <i class="fas fa-tasks"></i>
                            </div>
                            <div class="activity-content">
                                <div class="activity-message">Ahmed Mohamed completed a task: "Fix UI bugs"</div>
                                <div class="activity-time">5 minutes ago</div>
                            </div>
                            <div class="activity-actions">
                                <i class="fas fa-trash delete-activity" data-id="2"></i>
                            </div>
                        </li>
                        <li class="activity-item">
                            <div class="activity-icon">
                                <i class="fas fa-project-diagram"></i>
                            </div>
                            <div class="activity-content">
                                <div class="activity-message">Sarah Johnson updated project "Dashboard Redesign" to 80% completion</div>
                                <div class="activity-time">15 minutes ago</div>
                            </div>
                            <div class="activity-actions">
                                <i class="fas fa-trash delete-activity" data-id="3"></i>
                            </div>
                        </li>
                        <li class="activity-item">
                            <div class="activity-icon">
                                <i class="fas fa-comment"></i>
                            </div>
                            <div class="activity-content">
                                <div class="activity-message">New message from Ahmed Mohamed</div>
                                <div class="activity-time">30 minutes ago</div>
                            </div>
                            <div class="activity-actions">
                                <i class="fas fa-trash delete-activity" data-id="4"></i>
                            </div>
                        </li>
                        <li class="activity-item">
                            <div class="activity-icon">
                                <i class="fas fa-bell"></i>
                            </div>
                            <div class="activity-content">
                                <div class="activity-message">Sarah Johnson updated her profile</div>
                                <div class="activity-time">1 hour ago</div>
                            </div>
                            <div class="activity-actions">
                                <i class="fas fa-trash delete-activity" data-id="5"></i>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
            
            <!-- Profile Content -->
            <div class="profile-content" id="profileContent">
                <div class="profile-header">
                    <h2 class="profile-title">Profile Settings</h2>
                </div>
                
                <form class="profile-form" id="profileForm">
                    <div class="form-group">
                        <label for="profileAvatarInput">Profile Picture</label>
                        <div class="user-info-avatar" id="profileAvatarLarge">
                            <div class="avatar-upload" id="avatarUploadBtn">
                                <i class="fas fa-camera"></i>
                                <input type="file" id="profileAvatarInput" accept="image/*" style="display: none;">
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="firstName">First Name</label>
                        <input type="text" id="firstName" class="form-control" value="Mohamed">
                    </div>
                    
                    <div class="form-group">
                        <label for="lastName">Last Name</label>
                        <input type="text" id="lastName" class="form-control" value="Elmenisy">
                    </div>
                    
                    <div class="form-group">
                        <label for="jobTitle">Job Title</label>
                        <input type="text" id="jobTitle" class="form-control" value="Administrator">
                    </div>
                    
                    <div class="form-group">
                        <label for="email">Email</label>
                        <input type="email" id="email" class="form-control" value="m.elsayed@thechefz.co" readonly>
                    </div>
                    
                    <div class="form-group">
                        <label for="phone">Phone Number</label>
                        <input type="tel" id="phone" class="form-control" value="+201234567890">
                    </div>
                    
                    <div class="form-group">
                        <label for="department">Department</label>
                        <input type="text" id="department" class="form-control" value="Management">
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" class="btn btn-outline" id="cancelProfileBtn">Cancel</button>
                        <button type="submit" class="btn btn-primary">Save Changes</button>
                    </div>
                </form>
            </div>
            
            <!-- Settings Content -->
            <div class="settings-content" id="settingsContent">
                <div class="profile-header">
                    <h2 class="profile-title">System Settings</h2>
                </div>
                
                <div class="settings-tabs">
                    <div class="settings-tab active" data-tab="account">Account</div>
                    <div class="settings-tab" data-tab="security">Security</div>
                    <div class="settings-tab" data-tab="notifications">Notifications</div>
                    <div class="settings-tab" data-tab="preferences">Preferences</div>
                    <div class="settings-tab" data-tab="team">Team Management</div>
                </div>
                
                <div class="settings-panel active" id="accountPanel">
                    <form class="profile-form" id="accountForm">
                        <div class="form-group">
                            <label for="language">Language</label>
                            <select id="language" class="form-control">
                                <option value="system">System Default</option>
                                <option value="en" selected>English</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="timezone">Timezone</label>
                            <select id="timezone" class="form-control">
                                <option value="utc">UTC</option>
                                <option value="cairo" selected>Cairo (UTC+2)</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="dateFormat">Date Format</label>
                            <select id="dateFormat" class="form-control">
                                <option value="mm/dd/yyyy">MM/DD/YYYY</option>
                                <option value="dd/mm/yyyy" selected>DD/MM/YYYY</option>
                                <option value="yyyy-mm-dd">YYYY-MM-DD</option>
                            </select>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="btn btn-outline" id="cancelAccountBtn">Cancel</button>
                            <button type="submit" class="btn btn-primary" id="saveAccountBtn">
                                <span>Save Settings</span>
                                <div class="spinner" id="accountSpinner"></div>
                                <span class="loading-text" id="accountLoadingText">Saving...</span>
                            </button>
                        </div>
                    </form>
                </div>
                
                <div class="settings-panel" id="securityPanel">
                    <form class="profile-form" id="securityForm">
                        <div class="form-group">
                            <label>Two-Factor Authentication</label>
                            <div style="display: flex; align-items: center; gap: 1rem;">
                                <label class="switch">
                                    <input type="checkbox" id="twoFactorAuth" checked>
                                    <span class="slider round"></span>
                                </label>
                                <span>Enabled</span>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="currentPassword">Current Password</label>
                            <input type="password" id="currentPassword" class="form-control">
                            <div class="password-error" id="currentPasswordError">Current password is incorrect</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="newPassword">New Password</label>
                            <input type="password" id="newPassword" class="form-control">
                        </div>
                        
                        <div class="form-group">
                            <label for="confirmPassword">Confirm Password</label>
                            <input type="password" id="confirmPassword" class="form-control">
                            <div class="password-error" id="passwordMatchError">Passwords do not match</div>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="btn btn-outline" id="cancelSecurityBtn">Cancel</button>
                            <button type="submit" class="btn btn-primary" id="saveSecurityBtn">
                                <span>Update Password</span>
                                <div class="spinner" id="securitySpinner"></div>
                                <span class="loading-text" id="securityLoadingText">Updating...</span>
                            </button>
                        </div>
                    </form>
                </div>
                
                <div class="settings-panel" id="notificationsPanel">
                    <form class="profile-form" id="notificationsForm">
                        <div class="form-group">
                            <label>Email Notifications</label>
                            <div style="margin-top: 0.5rem;">
                                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 0.5rem;">
                                    <span>Task Assignments</span>
                                    <label class="switch">
                                        <input type="checkbox" id="emailTasks" checked>
                                        <span class="slider round"></span>
                                    </label>
                                </div>
                                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 0.5rem;">
                                    <span>Deadline Reminders</span>
                                    <label class="switch">
                                        <input type="checkbox" id="emailDeadlines" checked>
                                        <span class="slider round"></span>
                                    </label>
                                </div>
                                <div style="display: flex; align-items: center; justify-content: space-between;">
                                    <span>System Updates</span>
                                    <label class="switch">
                                        <input type="checkbox" id="emailUpdates">
                                        <span class="slider round"></span>
                                    </label>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>Push Notifications</label>
                            <div style="margin-top: 0.5rem;">
                                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 0.5rem;">
                                    <span>New Messages</span>
                                    <label class="switch">
                                        <input type="checkbox" id="pushMessages" checked>
                                        <span class="slider round"></span>
                                    </label>
                                </div>
                                <div style="display: flex; align-items: center; justify-content: space-between;">
                                    <span>Team Updates</span>
                                    <label class="switch">
                                        <input type="checkbox" id="pushTeamUpdates">
                                        <span class="slider round"></span>
                                    </label>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="btn btn-outline" id="cancelNotificationsBtn">Cancel</button>
                            <button type="submit" class="btn btn-primary" id="saveNotificationsBtn">
                                <span>Save Settings</span>
                                <div class="spinner" id="notificationsSpinner"></div>
                                <span class="loading-text" id="notificationsLoadingText">Saving...</span>
                            </button>
                        </div>
                    </form>
                </div>
                
                <div class="settings-panel" id="preferencesPanel">
                    <form class="profile-form" id="preferencesForm">
                        <div class="form-group">
                            <label>Theme</label>
                            <div style="display: flex; gap: 1rem; margin-top: 0.5rem;">
                                <div class="theme-option" data-theme="light">
                                    <div style="width: 60px; height: 60px; background-color: #f8fafc; border: 2px solid #e2e8f0; border-radius: 6px; cursor: pointer;"></div>
                                    <span style="text-align: center; display: block; margin-top: 0.5rem;">Light</span>
                                </div>
                                <div class="theme-option" data-theme="dark">
                                    <div style="width: 60px; height: 60px; background-color: #1e293b; border: 2px solid #334155; border-radius: 6px; cursor: pointer;"></div>
                                    <span style="text-align: center; display: block; margin-top: 0.5rem;">Dark</span>
                                </div>
                                <div class="theme-option" data-theme="blue">
                                    <div style="width: 60px; height: 60px; background-color: #dbeafe; border: 2px solid #2563eb; border-radius: 6px; cursor: pointer;"></div>
                                    <span style="text-align: center; display: block; margin-top: 0.5rem;">Blue</span>
                                </div>
                            </div>
                            <input type="hidden" id="selectedTheme" value="blue">
                        </div>
                        
                        <div class="form-group">
                            <label>Layout Density</label>
                            <div style="margin-top: 0.5rem;">
                                <select id="layoutDensity" class="form-control">
                                    <option value="compact">Compact</option>
                                    <option value="normal" selected>Normal</option>
                                    <option value="spacious">Spacious</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="btn btn-outline" id="cancelPreferencesBtn">Cancel</button>
                            <button type="submit" class="btn btn-primary" id="savePreferencesBtn">
                                <span>Save Preferences</span>
                                <div class="spinner" id="preferencesSpinner"></div>
                                <span class="loading-text" id="preferencesLoadingText">Saving...</span>
                            </button>
                        </div>
                    </form>
                </div>
                
                <div class="settings-panel" id="teamPanel">
                    <div class="team-management">
                        <h3>Team Members</h3>
                        <div class="team-list" id="teamList">
                            <div class="team-member-card">
                                <div class="member-avatar">AM</div>
                                <div class="member-details">
                                    <div class="member-name">Ahmed Mohamed</div>
                                    <div class="member-email">ahmed@teamflow.com</div>
                                </div>
                                <div class="member-role role-senior">
                                    Senior
                                </div>
                                <div class="member-actions">
                                    <button class="btn btn-outline btn-sm edit-member" data-id="1">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn btn-danger btn-sm delete-member" data-id="1">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="team-member-card">
                                <div class="member-avatar">SJ</div>
                                <div class="member-details">
                                    <div class="member-name">Sarah Johnson</div>
                                    <div class="member-email">sarah@teamflow.com</div>
                                </div>
                                <div class="member-role role-supervisor">
                                    Supervisor
                                </div>
                                <div class="member-actions">
                                    <button class="btn btn-outline btn-sm edit-member" data-id="2">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn btn-danger btn-sm delete-member" data-id="2">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="team-member-card">
                                <div class="member-avatar">JS</div>
                                <div class="member-details">
                                    <div class="member-name">John Smith</div>
                                    <div class="member-email">john@teamflow.com</div>
                                </div>
                                <div class="member-role role-member">
                                    Member
                                </div>
                                <div class="member-actions">
                                    <button class="btn btn-outline btn-sm edit-member" data-id="3">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn btn-danger btn-sm delete-member" data-id="3">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="add-member-form">
                            <h4>Add New Member</h4>
                            <form id="addMemberForm">
                                <div class="form-group">
                                    <label for="memberEmail">Email</label>
                                    <input type="email" id="memberEmail" class="form-control" placeholder="user@example.com" required>
                                </div>
                                
                                <div class="form-group">
                                    <label for="memberRole">Role</label>
                                    <select id="memberRole" class="form-control" required>
                                        <option value="member">Member</option>
                                        <option value="senior">Senior</option>
                                        <option value="supervisor">Supervisor</option>
                                        <option value="admin">Admin</option>
                                    </select>
                                </div>
                                
                                <div class="form-actions">
                                    <button type="submit" class="btn btn-primary">Add Member</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Feature Content Sections -->
            <div id="featureSections">
                <!-- Feature content will be loaded here dynamically -->
            </div>
        </div>
    </main>

    <!-- Notifications Modal -->
    <div class="notifications-modal" id="notificationsModal">
        <div class="notifications-container">
            <div class="notifications-header">
                <h3 class="notifications-title">Notifications</h3>
                <button class="close-notifications" id="closeNotifications">&times;</button>
            </div>
            
            <div class="mark-all-read">
                <button class="btn btn-outline" id="markAllReadBtn">Mark All as Read</button>
                <button class="btn btn-danger" id="deleteAllNotifications" style="margin-left: 10px;">Delete All</button>
            </div>
            
            <div class="notification-item unread">
                <div class="notification-icon-wrapper">
                    <i class="fas fa-user-plus"></i>
                </div>
                <div class="notification-content">
                    <div class="notification-message">
                        <strong>New team member</strong> - John Smith has joined your team
                    </div>
                    <div class="notification-time">Just now</div>
                </div>
                <div class="activity-actions">
                    <i class="fas fa-trash delete-notification"></i>
                </div>
            </div>
            <div class="notification-item unread">
                <div class="notification-icon-wrapper">
                    <i class="fas fa-tasks"></i>
                </div>
                <div class="notification-content">
                    <div class="notification-message">
                        <strong>Task completed</strong> - Ahmed Mohamed completed "Fix UI bugs"
                    </div>
                    <div class="notification-time">5 minutes ago</div>
                </div>
                <div class="activity-actions">
                    <i class="fas fa-trash delete-notification"></i>
                </div>
            </div>
            <div class="notification-item">
                <div class="notification-icon-wrapper">
                    <i class="fas fa-project-diagram"></i>
                </div>
                <div class="notification-content">
                    <div class="notification-message">
                        <strong>Project update</strong> - Dashboard Redesign is now 80% complete
                    </div>
                    <div class="notification-time">15 minutes ago</div>
                </div>
                <div class="activity-actions">
                    <i class="fas fa-trash delete-notification"></i>
                </div>
            </div>
        </div>
    </div>

    <!-- Confirm Modal -->
    <div class="confirm-modal" id="confirmModal">
        <div class="confirm-container">
            <h3 class="confirm-title">Confirm Action</h3>
            <div class="confirm-message" id="confirmMessage">Are you sure you want to delete this team member?</div>
            <div class="confirm-actions">
                <button class="btn btn-outline" id="cancelConfirmBtn">Cancel</button>
                <button class="btn btn-danger" id="confirmBtn">Delete</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // DOM Elements
            const sidebar = document.getElementById('sidebar');
            const menuItems = document.querySelectorAll('.menu-item');
            const searchInput = document.getElementById('searchInput');
            const searchResults = document.getElementById('searchResults');
            const notificationIcon = document.getElementById('notificationIcon');
            const notificationsModal = document.getElementById('notificationsModal');
            const closeNotifications = document.getElementById('closeNotifications');
            const markAllReadBtn = document.getElementById('markAllReadBtn');
            const deleteAllNotifications = document.getElementById('deleteAllNotifications');
            const userAvatar = document.getElementById('userAvatar');
            const userName = document.getElementById('userName');
            const userEmail = document.getElementById('userEmail');
            const welcomeName = document.getElementById('welcomeName');
            const userDropdown = document.getElementById('userDropdown');
            const profileLink = document.getElementById('profileLink');
            const settingsLink = document.getElementById('settingsLink');
            const logoutLink = document.getElementById('logoutLink');
            const dashboardContent = document.getElementById('dashboardContent');
            const profileContent = document.getElementById('profileContent');
            const settingsContent = document.getElementById('settingsContent');
            const featureSections = document.getElementById('featureSections');
            const profileForm = document.getElementById('profileForm');
            const cancelProfileBtn = document.getElementById('cancelProfileBtn');
            const profileAvatarInput = document.getElementById('profileAvatarInput');
            const profileAvatar = document.getElementById('profileAvatar');
            const profileAvatarLarge = document.getElementById('profileAvatarLarge');
            const avatarUploadBtn = document.getElementById('avatarUploadBtn');
            const activityList = document.getElementById('activityList');
            const viewAllActivity = document.getElementById('viewAllActivity');
            const deleteAllActivity = document.getElementById('deleteAllActivity');
            const settingsTabs = document.querySelectorAll('.settings-tab');
            const settingsPanels = document.querySelectorAll('.settings-panel');
            const accountForm = document.getElementById('accountForm');
            const securityForm = document.getElementById('securityForm');
            const notificationsForm = document.getElementById('notificationsForm');
            const preferencesForm = document.getElementById('preferencesForm');
            const teamList = document.getElementById('teamList');
            const addMemberForm = document.getElementById('addMemberForm');
            const themeOptions = document.querySelectorAll('.theme-option');
            const confirmModal = document.getElementById('confirmModal');
            const confirmMessage = document.getElementById('confirmMessage');
            const cancelConfirmBtn = document.getElementById('cancelConfirmBtn');
            const confirmBtn = document.getElementById('confirmBtn');
            const teamMembersCount = document.getElementById('teamMembersCount');
            const tasksCompleted = document.getElementById('tasksCompleted');
            const activeProjects = document.getElementById('activeProjects');
            const upcomingDeadlines = document.getElementById('upcomingDeadlines');
            const userRoleTitle = document.getElementById('userRoleTitle');
            const backButton = document.getElementById('backButton');
            const notificationSound = document.getElementById('notificationSound');
            const successMessage = document.getElementById('successMessage');
            const successMessageText = document.getElementById('successMessageText');
            const cancelAccountBtn = document.getElementById('cancelAccountBtn');
            const cancelSecurityBtn = document.getElementById('cancelSecurityBtn');
            const cancelNotificationsBtn = document.getElementById('cancelNotificationsBtn');
            const cancelPreferencesBtn = document.getElementById('cancelPreferencesBtn');
            const currentPasswordError = document.getElementById('currentPasswordError');
            const passwordMatchError = document.getElementById('passwordMatchError');
            const teamMembersTrend = document.getElementById('teamMembersTrend');
            const tasksCompletedTrend = document.getElementById('tasksCompletedTrend');
            const activeProjectsTrend = document.getElementById('activeProjectsTrend');
            const upcomingDeadlinesTrend = document.getElementById('upcomingDeadlinesTrend');
            
            // API Base URL
            const API_BASE_URL = 'https://your-api-endpoint.com/api';
            
            // Current feature tracking
            let currentFeature = 'dashboard';
            let previousFeature = '';
            let currentTab = 'account';
            
            // Search data
            const searchData = [
                { id: 1, type: 'employee', name: 'Ahmed Mohamed', email: 'ahmed@teamflow.com', department: 'Development' },
                { id: 2, type: 'employee', name: 'Sarah Johnson', email: 'sarah@teamflow.com', department: 'Design' },
                { id: 3, type: 'project', name: 'Dashboard Redesign', status: 'In Progress', due: '2023-12-15' },
                { id: 4, type: 'project', name: 'Mobile App Development', status: 'Planning', due: '2024-02-20' },
                { id: 5, type: 'task', name: 'Implement User Authentication', project: 'Dashboard Redesign', assigned: 'Ahmed Mohamed' },
                { id: 6, type: 'task', name: 'Create Wireframes', project: 'Mobile App Development', assigned: 'Sarah Johnson' }
            ];
            
            // Get user data from localStorage or API
            function getUserData() {
                const savedUser = localStorage.getItem('currentUser');
                if (savedUser) {
                    return JSON.parse(savedUser);
                }
                
                // Default user if not found (admin with all permissions)
                return {
                    id: 1,
                    name: 'Mohamed Elmenisy',
                    email: 'm.elsayed@thechefz.co',
                    title: 'Administrator',
                    department: 'Management',
                    phone: '+201234567890',
                    avatar: '',
                    initials: 'ME',
                    role: 'admin',
                    password: 'password123',
                    preferences: {
                        language: 'en',
                        timezone: 'cairo',
                        dateFormat: 'dd/mm/yyyy',
                        theme: 'blue',
                        layoutDensity: 'normal'
                    },
                    notificationPreferences: {
                        email: {
                            tasks: true,
                            deadlines: true,
                            updates: false
                        },
                        push: {
                            messages: true,
                            teamUpdates: false
                        }
                    },
                    stats: {
                        teamMembers: 3,
                        tasksCompleted: 12,
                        activeProjects: 5,
                        upcomingDeadlines: 2,
                        teamMembersTrend: 'up',
                        tasksCompletedTrend: 'up',
                        activeProjectsTrend: 'down',
                        upcomingDeadlinesTrend: 'up'
                    }
                };
            }
            
            // Save user data to localStorage
            function saveUserData(userData) {
                localStorage.setItem('currentUser', JSON.stringify(userData));
                return userData;
            }
            
            // Get team members from localStorage
            function getTeamMembers() {
                const savedMembers = localStorage.getItem('teamMembers');
                if (savedMembers) {
                    return JSON.parse(savedMembers);
                }
                
                // Default team members if not found
                return [
                    {
                        id: 2,
                        name: 'Ahmed Mohamed',
                        email: 'ahmed@teamflow.com',
                        role: 'senior',
                        initials: 'AM'
                    },
                    {
                        id: 3,
                        name: 'Sarah Johnson',
                        email: 'sarah@teamflow.com',
                        role: 'supervisor',
                        initials: 'SJ'
                    },
                    {
                        id: 4,
                        name: 'John Smith',
                        email: 'john@teamflow.com',
                        role: 'member',
                        initials: 'JS'
                    }
                ];
            }
            
            // Save team members to localStorage
            function saveTeamMembers(members) {
                localStorage.setItem('teamMembers', JSON.stringify(members));
                return members;
            }
            
            // Get activities from localStorage
            function getActivities() {
                const savedActivities = localStorage.getItem('activities');
                if (savedActivities) {
                    return JSON.parse(savedActivities);
                }
                
                // Default activities if not found
                return [
                    {
                        id: Date.now() - 5000,
                        icon: 'fa-info-circle',
                        message: 'Welcome to TeamFlow! Your dashboard is ready.',
                        timestamp: new Date(Date.now() - 5000).toISOString()
                    },
                    {
                        id: Date.now() - 10000,
                        icon: 'fa-tasks',
                        message: 'System initialized successfully',
                        timestamp: new Date(Date.now() - 10000).toISOString()
                    }
                ];
            }
            
            // Save activities to localStorage
            function saveActivities(activities) {
                localStorage.setItem('activities', JSON.stringify(activities));
                return activities;
            }
            
            // Get notifications from localStorage
            function getNotifications() {
                const savedNotifications = localStorage.getItem('notifications');
                if (savedNotifications) {
                    return JSON.parse(savedNotifications);
                }
                
                // Default notifications if not found
                return [
                    {
                        id: Date.now() - 5000,
                        icon: 'fa-user-plus',
                        message: 'New team member - John Smith has joined your team',
                        timestamp: new Date(Date.now() - 5000).toISOString(),
                        read: false
                    },
                    {
                        id: Date.now() - 15000,
                        icon: 'fa-tasks',
                        message: 'Task completed - Ahmed Mohamed completed "Fix UI bugs"',
                        timestamp: new Date(Date.now() - 15000).toISOString(),
                        read: false
                    },
                    {
                        id: Date.now() - 45000,
                        icon: 'fa-project-diagram',
                        message: 'Project update - Dashboard Redesign is now 80% complete',
                        timestamp: new Date(Date.now() - 45000).toISOString(),
                        read: true
                    }
                ];
            }
            
            // Save notifications to localStorage
            function saveNotifications(notifications) {
                localStorage.setItem('notifications', JSON.stringify(notifications));
                return notifications;
            }
            
            // Current user data
            let currentUser = getUserData();
            let teamMembers = getTeamMembers();
            let activities = getActivities();
            let notifications = getNotifications();
            
            // Variables for confirm modal
            let currentAction = null;
            let currentIndex = null;
            
            // Initialize the dashboard
            function initDashboard() {
                // Set user data
                updateUserUI();
                
                // Load team members
                loadTeamMembers();
                
                // Load activities
                loadActivities();
                
                // Load notifications
                loadNotifications();
                
                // Load stats
                updateStats();
                
                // Set active feature based on URL hash or default to dashboard
                const hash = window.location.hash.substring(1);
                if (hash) {
                    if (hash.includes('settings-')) {
                        const parts = hash.split('-');
                        setActiveFeature(parts[0]);
                        currentTab = parts[1];
                        setTimeout(() => {
                            document.querySelector(`.settings-tab[data-tab="${currentTab}"]`).click();
                        }, 100);
                    } else {
                        setActiveFeature(hash);
                    }
                } else {
                    setActiveFeature('dashboard');
                }
                
                // Start activity time updater
                startActivityTimeUpdater();
                
                // Start real-time updates
                startRealTimeUpdates();
                
                // Add system update notification
                addSystemUpdateNotification();
                
                // Apply layout density
                applyLayoutDensity(currentUser.preferences.layoutDensity || 'normal');
                
                // Initialize notification badge
                updateNotificationBadge();
            }
            
            // Update notification badge count
            function updateNotificationBadge() {
                const badge = document.querySelector('.notification-badge');
                const unreadCount = notifications.filter(n => !n.read).length;
                if (unreadCount > 0) {
                    badge.textContent = unreadCount;
                    badge.style.display = 'flex';
                } else {
                    badge.style.display = 'none';
                }
            }
            
            // Apply layout density
            function applyLayoutDensity(density) {
                document.body.classList.remove('compact', 'normal', 'spacious');
                document.body.classList.add(density);
            }
            
            // Add system update notification
            function addSystemUpdateNotification() {
                const systemUpdate = {
                    id: Date.now(),
                    icon: 'fa-info-circle',
                    message: 'System update available - Version 2.1.0',
                    timestamp: new Date().toISOString(),
                    isSystemUpdate: true
                };
                
                activities.unshift(systemUpdate);
                saveActivities(activities);
                loadActivities();
            }
            
            // Play notification sound
            function playNotificationSound() {
                notificationSound.currentTime = 0;
                notificationSound.play().catch(e => console.log('Audio play failed:', e));
            }
            
            // Show success message
            function showSuccessMessage(message) {
                successMessageText.textContent = message;
                successMessage.classList.add('show');
                
                setTimeout(() => {
                    successMessage.classList.remove('show');
                }, 3000);
            }
            
            // Show loading state
            function showLoading(buttonId, spinnerId, textId) {
                document.getElementById(buttonId).disabled = true;
                document.getElementById(spinnerId).style.display = 'inline-block';
                document.getElementById(textId).style.display = 'inline';
                document.querySelector(`#${buttonId} span`).style.display = 'none';
            }
            
            // Hide loading state
            function hideLoading(buttonId, spinnerId, textId) {
                document.getElementById(buttonId).disabled = false;
                document.getElementById(spinnerId).style.display = 'none';
                document.getElementById(textId).style.display = 'none';
                document.querySelector(`#${buttonId} span`).style.display = 'inline';
            }
            
            // Start real-time updates
            function startRealTimeUpdates() {
                // Simulate real-time updates for activities
                setInterval(() => {
                    // Only add activities if we have team members
                    if (teamMembers.length > 0 && Math.random() < 0.2) {
                        const randomMember = teamMembers[Math.floor(Math.random() * teamMembers.length)];
                        const activityTypes = [
                            { icon: 'fa-tasks', message: `${randomMember.name} completed a task: "Fix UI bugs"` },
                            { icon: 'fa-project-diagram', message: `${randomMember.name} updated project "Dashboard Redesign" to 80% completion` },
                            { icon: 'fa-comment', message: `New message from ${randomMember.name}` },
                            { icon: 'fa-bell', message: `${randomMember.name} updated their profile` }
                        ];
                        
                        const randomActivity = activityTypes[Math.floor(Math.random() * activityTypes.length)];
                        
                        const newActivity = {
                            id: Date.now(),
                            icon: randomActivity.icon,
                            message: randomActivity.message,
                            timestamp: new Date().toISOString()
                        };
                        
                        activities.unshift(newActivity);
                        saveActivities(activities);
                        loadActivities(viewAllActivity.style.display === 'none');
                        
                        // Add notification
                        const newNotification = {
                            id: Date.now(),
                            icon: randomActivity.icon,
                            message: randomActivity.message,
                            timestamp: new Date().toISOString(),
                            read: false
                        };
                        
                        notifications.unshift(newNotification);
                        saveNotifications(notifications);
                        updateNotificationBadge();
                        
                        // Highlight new activity
                        const activityItem = document.querySelector('.activity-item:first-child');
                        if (activityItem) {
                            activityItem.classList.add('new-activity');
                        }
                        
                        // Play notification sound
                        playNotificationSound();
                    }
                    
                    // Randomly update stats (30% chance)
                    if (teamMembers.length > 0 && Math.random() < 0.3) {
                        // Update tasks completed
                        const tasksChange = Math.floor(Math.random() * 3);
                        currentUser.stats.tasksCompleted += tasksChange;
                        
                        // Update upcoming deadlines
                        const deadlinesChange = Math.random() < 0.5 ? 1 : -1;
                        currentUser.stats.upcomingDeadlines += deadlinesChange;
                        if (currentUser.stats.upcomingDeadlines < 0) currentUser.stats.upcomingDeadlines = 0;
                        
                        // Update trends
                        currentUser.stats.tasksCompletedTrend = tasksChange > 0 ? 'up' : tasksChange < 0 ? 'down' : 'neutral';
                        currentUser.stats.upcomingDeadlinesTrend = deadlinesChange > 0 ? 'up' : deadlinesChange < 0 ? 'down' : 'neutral';
                        
                        saveUserData(currentUser);
                        updateStats();
                    }
                }, 10000); // Update every 10 seconds
            }
            
            // Update user UI elements
            function updateUserUI() {
                userName.textContent = currentUser.name;
                userEmail.textContent = currentUser.email;
                welcomeName.textContent = currentUser.name.split(' ')[0];
                document.querySelector('.user-info-name').textContent = currentUser.name;
                
                // Update role title based on user role
                const roleTitles = {
                    'admin': 'Administrator',
                    'senior': 'Senior Team Member',
                    'supervisor': 'Project Supervisor',
                    'member': 'Team Member',
                    'guest': 'Guest User'
                };
                const roleTitle = roleTitles[currentUser.role] || 'Team Member';
                document.querySelector('.user-info-title').textContent = roleTitle;
                userRoleTitle.textContent = roleTitle;
                
                document.querySelector('.user-info-email span').textContent = currentUser.email;
                
                // Set form values
                const nameParts = currentUser.name.split(' ');
                document.getElementById('firstName').value = nameParts[0];
                document.getElementById('lastName').value = nameParts.slice(1).join(' ');
                document.getElementById('jobTitle').value = currentUser.title || '';
                document.getElementById('phone').value = currentUser.phone || '';
                document.getElementById('department').value = currentUser.department || '';
                document.getElementById('email').value = currentUser.email;
                
                // Set preferences
                if (currentUser.preferences) {
                    document.getElementById('language').value = currentUser.preferences.language || 'en';
                    document.getElementById('timezone').value = currentUser.preferences.timezone || 'cairo';
                    document.getElementById('dateFormat').value = currentUser.preferences.dateFormat || 'dd/mm/yyyy';
                    document.getElementById('selectedTheme').value = currentUser.preferences.theme || 'blue';
                    document.getElementById('layoutDensity').value = currentUser.preferences.layoutDensity || 'normal';
                }
                
                // Set notification preferences
                if (currentUser.notificationPreferences) {
                    document.getElementById('emailTasks').checked = currentUser.notificationPreferences.email.tasks;
                    document.getElementById('emailDeadlines').checked = currentUser.notificationPreferences.email.deadlines;
                    document.getElementById('emailUpdates').checked = currentUser.notificationPreferences.email.updates;
                    document.getElementById('pushMessages').checked = currentUser.notificationPreferences.push.messages;
                    document.getElementById('pushTeamUpdates').checked = currentUser.notificationPreferences.push.teamUpdates;
                }
                
                // Set avatar if exists
                if (currentUser.avatar) {
                    profileAvatar.style.backgroundImage = `url(${currentUser.avatar})`;
                    profileAvatar.textContent = '';
                    profileAvatarLarge.style.backgroundImage = `url(${currentUser.avatar})`;
                    profileAvatarLarge.textContent = '';
                    userAvatar.style.backgroundImage = `url(${currentUser.avatar})`;
                    userAvatar.textContent = '';
                } else {
                    profileAvatar.textContent = currentUser.initials || 'ME';
                    profileAvatarLarge.textContent = currentUser.initials || 'ME';
                    userAvatar.textContent = currentUser.initials || 'ME';
                }
                
                // Show/hide admin features based on role
                const adminFeatures = document.querySelectorAll('.admin-only');
                adminFeatures.forEach(feature => {
                    feature.style.display = currentUser.role === 'admin' ? 'block' : 'none';
                });
            }
            
            // Update stats
            function updateStats() {
                teamMembersCount.textContent = currentUser.stats.teamMembers || 0;
                tasksCompleted.textContent = currentUser.stats.tasksCompleted || 0;
                activeProjects.textContent = currentUser.stats.activeProjects || 0;
                upcomingDeadlines.textContent = currentUser.stats.upcomingDeadlines || 0;
                
                // Update trend indicators
                updateTrendIndicator(teamMembersTrend, currentUser.stats.teamMembersTrend);
                updateTrendIndicator(tasksCompletedTrend, currentUser.stats.tasksCompletedTrend);
                updateTrendIndicator(activeProjectsTrend, currentUser.stats.activeProjectsTrend);
                updateTrendIndicator(upcomingDeadlinesTrend, currentUser.stats.upcomingDeadlinesTrend);
            }
            
            // Update trend indicator
            function updateTrendIndicator(element, trend) {
                if (trend === 'up') {
                    element.innerHTML = '<i class="fas fa-arrow-up"></i> ' + (Math.floor(Math.random() * 50) + 1) + '%';
                    element.className = 'stat-trend trend-up';
                } else if (trend === 'down') {
                    element.innerHTML = '<i class="fas fa-arrow-down"></i> ' + (Math.floor(Math.random() * 30) + 1) + '%';
                    element.className = 'stat-trend trend-down';
                } else {
                    element.innerHTML = '<i class="fas fa-minus"></i> 0%';
                    element.className = 'stat-trend trend-neutral';
                }
            }
            
            // Load team members
            function loadTeamMembers() {
                teamList.innerHTML = '';
                
                if (teamMembers.length === 0) {
                    teamList.innerHTML = `
                        <div style="text-align: center; padding: 2rem; color: var(--gray);">
                            No team members yet. Add your first team member to get started.
                        </div>
                    `;
                    return;
                }
                
                teamMembers.forEach((member) => {
                    const memberCard = document.createElement('div');
                    memberCard.className = 'team-member-card';
                    memberCard.innerHTML = `
                        <div class="member-avatar">${member.initials || member.email.substring(0, 2).toUpperCase()}</div>
                        <div class="member-details">
                            <div class="member-name">${member.name}</div>
                            <div class="member-email">${member.email}</div>
                        </div>
                        <div class="member-role ${member.role === 'admin' ? 'role-admin' : member.role === 'senior' ? 'role-senior' : member.role === 'supervisor' ? 'role-supervisor' : 'role-member'}">
                            ${member.role === 'admin' ? 'Admin' : member.role === 'senior' ? 'Senior' : member.role === 'supervisor' ? 'Supervisor' : 'Member'}
                        </div>
                        <div class="member-actions ${currentUser.role === 'admin' || currentUser.role === 'supervisor' ? '' : 'd-none'}">
                            <button class="btn btn-outline btn-sm edit-member" data-id="${member.id}">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-danger btn-sm delete-member" data-id="${member.id}" ${currentUser.role === 'admin' ? '' : 'disabled'}>
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    `;
                    teamList.appendChild(memberCard);
                });
                
                // Add event listeners to delete buttons
                document.querySelectorAll('.delete-member').forEach(button => {
                    button.addEventListener('click', function() {
                        const memberId = parseInt(this.getAttribute('data-id'));
                        const member = teamMembers.find(m => m.id === memberId);
                        showConfirmModal(
                            'Delete Team Member',
                            `Are you sure you want to remove ${member.name} (${member.email}) from the team? This action is restricted to administrators only.`,
                            () => deleteTeamMember(memberId)
                        );
                    });
                });
                
                // Add event listeners to edit buttons
                document.querySelectorAll('.edit-member').forEach(button => {
                    button.addEventListener('click', function() {
                        const memberId = parseInt(this.getAttribute('data-id'));
                        const member = teamMembers.find(m => m.id === memberId);
                        editTeamMember(member);
                    });
                });
                
                // Update stats
                currentUser.stats.teamMembers = teamMembers.length;
                saveUserData(currentUser);
                updateStats();
            }
            
            // Edit team member
            function editTeamMember(member) {
                // Create a modal-like form for editing
                const editForm = document.createElement('div');
                editForm.style.position = 'fixed';
                editForm.style.top = '0';
                editForm.style.left = '0';
                editForm.style.width = '100%';
                editForm.style.height = '100%';
                editForm.style.backgroundColor = 'rgba(0,0,0,0.5)';
                editForm.style.display = 'flex';
                editForm.style.justifyContent = 'center';
                editForm.style.alignItems = 'center';
                editForm.style.zIndex = '2000';
                
                editForm.innerHTML = `
                    <div style="background: white; padding: 2rem; border-radius: 8px; width: 400px; max-width: 90%;">
                        <h3 style="margin-bottom: 1.5rem;">Edit Team Member</h3>
                        <div class="form-group">
                            <label>Name</label>
                            <input type="text" id="editMemberName" class="form-control" value="${member.name}" style="width: 100%;">
                        </div>
                        <div class="form-group">
                            <label>Email</label>
                            <input type="email" id="editMemberEmail" class="form-control" value="${member.email}" style="width: 100%;">
                        </div>
                        <div class="form-group">
                            <label>Role</label>
                            <select id="editMemberRole" class="form-control" style="width: 100%;" ${currentUser.role === 'admin' ? '' : 'disabled'}>
                                <option value="member" ${member.role === 'member' ? 'selected' : ''}>Member</option>
                                <option value="senior" ${member.role === 'senior' ? 'selected' : ''}>Senior</option>
                                <option value="supervisor" ${member.role === 'supervisor' ? 'selected' : ''}>Supervisor</option>
                                <option value="admin" ${member.role === 'admin' ? 'selected' : ''}>Admin</option>
                            </select>
                        </div>
                        <div style="display: flex; justify-content: flex-end; gap: 1rem; margin-top: 1.5rem;">
                            <button class="btn btn-outline" id="cancelEditMember">Cancel</button>
                            <button class="btn btn-primary" id="saveEditMember">Save Changes</button>
                        </div>
                    </div>
                `;
                
                document.body.appendChild(editForm);
                
                // Add event listeners
                document.getElementById('cancelEditMember').addEventListener('click', function() {
                    document.body.removeChild(editForm);
                });
                
                document.getElementById('saveEditMember').addEventListener('click', function() {
                    const newName = document.getElementById('editMemberName').value;
                    const newEmail = document.getElementById('editMemberEmail').value;
                    const newRole = document.getElementById('editMemberRole').value;
                    
                    if (!newName || !newEmail) {
                        alert('Please fill in all fields');
                        return;
                    }
                    
                    // Update member
                    member.name = newName;
                    member.email = newEmail;
                    if (currentUser.role === 'admin') {
                        member.role = newRole;
                    }
                    member.initials = newName.split(' ').map(n => n[0]).join('').toUpperCase();
                    
                    // Save changes
                    saveTeamMembers(teamMembers);
                    loadTeamMembers();
                    
                    // Add activity
                    activities.unshift({
                        id: Date.now(),
                        icon: 'fa-user-edit',
                        message: `${currentUser.name} updated team member ${member.name} (${member.email})`,
                        timestamp: new Date().toISOString()
                    });
                    saveActivities(activities);
                    loadActivities();
                    
                    // Show success message
                    showSuccessMessage('Team member updated successfully!');
                    
                    // Remove the edit form
                    document.body.removeChild(editForm);
                });
            }
            
            // Delete team member
            function deleteTeamMember(memberId) {
                // Check if user has permission
                if (currentUser.role !== 'admin') {
                    alert('This option is only available for administrators');
                    return;
                }
                
                // Remove from local array
                const removedMember = teamMembers.find(m => m.id === memberId);
                teamMembers = teamMembers.filter(member => member.id !== memberId);
                saveTeamMembers(teamMembers);
                loadTeamMembers();
                
                // Add activity
                if (removedMember) {
                    activities.unshift({
                        id: Date.now(),
                        icon: 'fa-user-minus',
                        message: `${currentUser.name} removed team member "${removedMember.name}" (${removedMember.email})`,
                        timestamp: new Date().toISOString()
                    });
                    saveActivities(activities);
                    loadActivities();
                }
                
                hideConfirmModal();
            }
            
            // Start activity time updater
            function startActivityTimeUpdater() {
                // Update times immediately
                updateActivityTimes();
                
                // Then update every minute
                setInterval(updateActivityTimes, 60000);
            }
            
            // Update activity times
            function updateActivityTimes() {
                const now = new Date();
                const activityItems = document.querySelectorAll('.activity-item');
                
                activityItems.forEach((item, index) => {
                    const timeElement = item.querySelector('.activity-time');
                    const activity = activities[index];
                    
                    if (activity) {
                        // Update the time display
                        timeElement.textContent = getTimeAgo(activity.timestamp || now);
                    }
                });
            }
            
            // Get time ago string
            function getTimeAgo(timestamp) {
                const now = new Date();
                const date = new Date(timestamp);
                const seconds = Math.floor((now - date) / 1000);
                
                if (seconds < 60) {
                    return 'Just now';
                }
                
                const minutes = Math.floor(seconds / 60);
                if (minutes < 60) {
                    return `${minutes} minute${minutes === 1 ? '' : 's'} ago`;
                }
                
                const hours = Math.floor(minutes / 60);
                if (hours < 24) {
                    return `${hours} hour${hours === 1 ? '' : 's'} ago`;
                }
                
                const days = Math.floor(hours / 24);
                if (days < 7) {
                    return `${days} day${days === 1 ? '' : 's'} ago`;
                }
                
                const weeks = Math.floor(days / 7);
                if (weeks < 4) {
                    return `${weeks} week${weeks === 1 ? '' : 's'} ago`;
                }
                
                return date.toLocaleDateString();
            }
            
            // Load activities
            function loadActivities(showAll = false) {
                activityList.innerHTML = '';
                
                if (activities.length === 0) {
                    activityList.innerHTML = `
                        <li style="text-align: center; padding: 2rem; color: var(--gray);">
                            No recent activity yet. Activities will appear here when you add team members and they make changes.
                        </li>
                    `;
                    return;
                }
                
                const activitiesToShow = showAll ? activities : activities.slice(0, 5);
                
                activitiesToShow.forEach((activity) => {
                    const li = document.createElement('li');
                    li.className = 'activity-item';
                    li.innerHTML = `
                        <div class="activity-icon">
                            <i class="fas ${activity.icon}"></i>
                        </div>
                        <div class="activity-content">
                            <div class="activity-message">${activity.message}</div>
                            <div class="activity-time">${getTimeAgo(activity.timestamp || new Date())}</div>
                        </div>
                        <div class="activity-actions">
                            <i class="fas fa-trash delete-activity" data-id="${activity.id}" 
                               style="${(currentUser.role === 'admin' || currentUser.role === 'supervisor') && !activity.isSystemUpdate ? '' : 'display: none;'}"></i>
                            ${activity.isSystemUpdate ? `<button class="btn btn-danger btn-sm delete-system-update" data-id="${activity.id}">Delete</button>` : ''}
                        </div>
                    `;
                    activityList.appendChild(li);
                });
                
                // Show view all button if there are more activities
                if (activities.length > 5) {
                    viewAllActivity.style.display = 'inline';
                    deleteAllActivity.style.display = currentUser.role === 'admin' || currentUser.role === 'supervisor' ? 'inline' : 'none';
                } else {
                    viewAllActivity.style.display = 'inline';
                    deleteAllActivity.style.display = currentUser.role === 'admin' || currentUser.role === 'supervisor' ? 'inline' : 'none';
                }
                
                // Add event listeners to delete buttons
                document.querySelectorAll('.delete-activity').forEach(button => {
                    button.addEventListener('click', function() {
                        const activityId = parseInt(this.getAttribute('data-id'));
                        showConfirmModal(
                            'Delete Activity',
                            'Are you sure you want to delete this activity? This action is restricted to administrators and supervisors only.',
                            () => deleteActivity(activityId)
                        );
                    });
                });
                
                // Add event listeners to delete system update buttons
                document.querySelectorAll('.delete-system-update').forEach(button => {
                    button.addEventListener('click', function() {
                        const activityId = parseInt(this.getAttribute('data-id'));
                        const activity = activities.find(a => a.id === activityId);
                        
                        if (activity && activity.isSystemUpdate) {
                            showConfirmModal(
                                'Delete System Update',
                                'Are you sure you want to delete this system update notification? This action is restricted to administrators and supervisors only.',
                                () => {
                                    if (currentUser.role === 'admin' || currentUser.role === 'supervisor') {
                                        deleteActivity(activityId);
                                    }
                                }
                            );
                        }
                    });
                });
            }
            
            // Load notifications
            function loadNotifications() {
                const notificationsContainer = document.querySelector('.notifications-container');
                if (!notificationsContainer) return;
                
                const notificationsList = notificationsContainer.querySelectorAll('.notification-item');
                notificationsList.forEach(item => item.remove());
                
                notifications.forEach(notification => {
                    const notificationItem = document.createElement('div');
                    notificationItem.className = `notification-item ${notification.read ? '' : 'unread'}`;
                    notificationItem.innerHTML = `
                        <div class="notification-icon-wrapper">
                            <i class="fas ${notification.icon}"></i>
                        </div>
                        <div class="notification-content">
                            <div class="notification-message">
                                <strong>${notification.message.split(' - ')[0]}</strong> - ${notification.message.split(' - ')[1]}
                            </div>
                            <div class="notification-time">${getTimeAgo(notification.timestamp)}</div>
                        </div>
                        <div class="activity-actions">
                            <i class="fas fa-trash delete-notification" data-id="${notification.id}"></i>
                        </div>
                    `;
                    
                    notificationsContainer.insertBefore(notificationItem, notificationsContainer.querySelector('.mark-all-read').nextSibling);
                    
                    // Add click handler to mark as read
                    notificationItem.addEventListener('click', function(e) {
                        if (!e.target.classList.contains('delete-notification')) {
                            notification.read = true;
                            saveNotifications(notifications);
                            this.classList.remove('unread');
                            updateNotificationBadge();
                        }
                    });
                });
                
                // Add event listeners to delete buttons
                document.querySelectorAll('.delete-notification').forEach(button => {
                    button.addEventListener('click', function(e) {
                        e.stopPropagation();
                        const notificationId = parseInt(this.getAttribute('data-id'));
                        showConfirmModal(
                            'Delete Notification',
                            'Are you sure you want to delete this notification?',
                            () => {
                                notifications = notifications.filter(n => n.id !== notificationId);
                                saveNotifications(notifications);
                                loadNotifications();
                                updateNotificationBadge();
                                hideConfirmModal();
                            }
                        );
                    });
                });
            }
            
            // Delete activity
            function deleteActivity(activityId) {
                // Check if user has permission
                if (currentUser.role !== 'admin' && currentUser.role !== 'supervisor') {
                    alert('This option is only available for supervisors and administrators');
                    return;
                }
                
                // Remove from local array
                activities = activities.filter(activity => activity.id !== activityId);
                saveActivities(activities);
                loadActivities(viewAllActivity.style.display === 'none');
                hideConfirmModal();
            }
            
            // Delete all activities
            function deleteAllActivities() {
                // Check if user has permission
                if (currentUser.role !== 'admin' && currentUser.role !== 'supervisor') {
                    alert('This option is only available for supervisors and administrators');
                    return;
                }
                
                showConfirmModal(
                    'Delete All Activities',
                    'Are you sure you want to delete all activities? This action cannot be undone and is restricted to administrators and supervisors only.',
                    () => {
                        activities = [];
                        saveActivities(activities);
                        loadActivities();
                        hideConfirmModal();
                    }
                );
            }
            
            // Show confirm modal
            function showConfirmModal(title, message, callback, isEdit = false) {
                // Hide any existing modal first
                hideConfirmModal();
                
                document.querySelector('.confirm-title').textContent = title;
                confirmMessage.textContent = message;
                confirmModal.style.display = 'flex';
                
                if (isEdit) {
                    confirmBtn.textContent = 'Save';
                    confirmBtn.className = 'btn btn-primary';
                } else {
                    confirmBtn.textContent = 'Delete';
                    confirmBtn.className = 'btn btn-danger';
                }
                
                // Remove previous click handlers
                confirmBtn.onclick = null;
                
                // Add new click handler
                confirmBtn.onclick = function() {
                    callback();
                };
            }
            
            // Hide confirm modal
            function hideConfirmModal() {
                confirmModal.style.display = 'none';
            }
            
            // Set active feature and update URL
            function setActiveFeature(feature) {
                // Store previous feature for back button
                if (currentFeature !== feature) {
                    previousFeature = currentFeature;
                }
                
                currentFeature = feature;
                
                // Update URL without reloading page
                let newUrl;
                if (feature === 'settings' && currentTab) {
                    newUrl = window.location.pathname + '#' + feature + '-' + currentTab;
                } else {
                    newUrl = window.location.pathname + '#' + feature.replace(' ', '-').toLowerCase();
                }
                window.history.pushState({ feature }, '', newUrl);
                
                // Show/hide back button
                backButton.style.display = feature !== 'dashboard' ? 'flex' : 'none';
                
                // Hide all content sections
                dashboardContent.style.display = 'none';
                profileContent.style.display = 'none';
                settingsContent.style.display = 'none';
                featureSections.style.display = 'none';
                
                // Remove active class from all menu items
                menuItems.forEach(item => item.classList.remove('active'));
                
                // Show the selected content
                if (feature === 'dashboard') {
                    dashboardContent.style.display = 'block';
                    document.querySelector('[data-feature="dashboard"]').classList.add('active');
                } else if (feature === 'profile') {
                    profileContent.style.display = 'block';
                } else if (feature === 'settings') {
                    settingsContent.style.display = 'block';
                    // Set the current tab as active when opening settings
                    document.querySelector(`.settings-tab[data-tab="${currentTab}"]`).click();
                } else {
                    // For other features, we would load their content
                    featureSections.style.display = 'block';
                    document.querySelector(`[data-feature="${feature}"]`).classList.add('active');
                    featureSections.innerHTML = `<h2>${feature.replace('-', ' ')}</h2><p>This is the ${feature.replace('-', ' ')} feature content.</p>`;
                }
            }
            
            // Handle menu item clicks
            menuItems.forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    const feature = this.getAttribute('data-feature');
                    setActiveFeature(feature);
                });
            });
            
            // Search functionality
            searchInput.addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase().trim();
                searchResults.innerHTML = '';
                
                if (searchTerm.length > 0) {
                    const results = searchData.filter(item => 
                        item.name.toLowerCase().includes(searchTerm) || 
                        (item.email && item.email.toLowerCase().includes(searchTerm)) ||
                        (item.department && item.department.toLowerCase().includes(searchTerm)) ||
                        (item.project && item.project.toLowerCase().includes(searchTerm))
                    );
                    
                    if (results.length > 0) {
                        searchResults.classList.add('active');
                        
                        results.forEach(result => {
                            const resultItem = document.createElement('div');
                            resultItem.className = 'search-result-item';
                            
                            if (result.type === 'employee') {
                                resultItem.innerHTML = `
                                    <div><strong>${result.name}</strong></div>
                                    <div>${result.email}  ${result.department}</div>
                                `;
                            } else if (result.type === 'project') {
                                resultItem.innerHTML = `
                                    <div><strong>${result.name}</strong></div>
                                    <div>Status: ${result.status}  Due: ${result.due}</div>
                                `;
                            } else if (result.type === 'task') {
                                resultItem.innerHTML = `
                                    <div><strong>${result.name}</strong></div>
                                    <div>Project: ${result.project}  Assigned: ${result.assigned}</div>
                                `;
                            }
                            
                            resultItem.addEventListener('click', function() {
                                // In a real app, this would navigate to the specific item
                                alert(`Navigating to ${result.type}: ${result.name}`);
                                searchResults.classList.remove('active');
                                searchInput.value = '';
                            });
                            
                            searchResults.appendChild(resultItem);
                        });
                    } else {
                        searchResults.classList.remove('active');
                    }
                } else {
                    searchResults.classList.remove('active');
                }
            });
            
            // Close search results when clicking outside
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.search-bar')) {
                    searchResults.classList.remove('active');
                }
            });
            
            // Notifications
            notificationIcon.addEventListener('click', function() {
                notificationsModal.style.display = 'flex';
                // Mark all notifications as read when opening
                notifications.forEach(n => n.read = true);
                saveNotifications(notifications);
                updateNotificationBadge();
            });
            
            closeNotifications.addEventListener('click', function() {
                notificationsModal.style.display = 'none';
            });
            
            markAllReadBtn.addEventListener('click', function() {
                notifications.forEach(n => n.read = true);
                saveNotifications(notifications);
                loadNotifications();
                updateNotificationBadge();
            });
            
            // Delete all notifications
            deleteAllNotifications.addEventListener('click', function() {
                showConfirmModal(
                    'Delete All Notifications',
                    'Are you sure you want to delete all notifications? This action cannot be undone.',
                    () => {
                        notifications = [];
                        saveNotifications(notifications);
                        loadNotifications();
                        hideConfirmModal();
                        updateNotificationBadge();
                    }
                );
            });
            
            // View all activity
            viewAllActivity.addEventListener('click', function() {
                loadActivities(true);
                viewAllActivity.style.display = 'none';
            });
            
            // Delete all activities
            deleteAllActivity.addEventListener('click', deleteAllActivities);
            
            // User dropdown
            userAvatar.addEventListener('click', function() {
                userDropdown.classList.toggle('active');
            });
            
            userName.addEventListener('click', function() {
                userDropdown.classList.toggle('active');
            });
            
            // Profile link
            profileLink.addEventListener('click', function(e) {
                e.preventDefault();
                userDropdown.classList.remove('active');
                setActiveFeature('profile');
            });
            
            // Settings link
            settingsLink.addEventListener('click', function(e) {
                e.preventDefault();
                userDropdown.classList.remove('active');
                setActiveFeature('settings');
            });
            
            // Logout link
            logoutLink.addEventListener('click', function(e) {
                e.preventDefault();
                // Clear session
                localStorage.removeItem('currentUser');
                localStorage.removeItem('teamMembers');
                localStorage.removeItem('activities');
                localStorage.removeItem('notifications');
                // Redirect to login
                window.location.href = 'login.html';
            });
            
            // Back button
            backButton.addEventListener('click', function() {
                setActiveFeature('dashboard');
            });
            
            // Handle browser back/forward buttons
            window.addEventListener('popstate', function(event) {
                if (event.state && event.state.feature) {
                    setActiveFeature(event.state.feature);
                } else {
                    setActiveFeature('dashboard');
                }
            });
            
            // Profile form
            profileForm.addEventListener('submit', function(e) {
                e.preventDefault();
                // Prepare updated user data
                const updatedUser = {
                    ...currentUser,
                    name: `${document.getElementById('firstName').value} ${document.getElementById('lastName').value}`,
                    title: document.getElementById('jobTitle').value,
                    phone: document.getElementById('phone').value,
                    department: document.getElementById('department').value
                };
                
                // Save to localStorage
                currentUser = saveUserData(updatedUser);
                
                // Update UI
                updateUserUI();
                
                // Add activity
                activities.unshift({
                    id: Date.now(),
                    icon: 'fa-user-edit',
                    message: 'Updated profile information',
                    timestamp: new Date().toISOString()
                });
                saveActivities(activities);
                loadActivities();
                
                // Show success message
                showSuccessMessage('Profile updated successfully!');
                
                // Go back to dashboard after a delay
                setTimeout(() => {
                    setActiveFeature('dashboard');
                }, 1000);
            });
            
            cancelProfileBtn.addEventListener('click', function() {
                // Go back to dashboard
                setActiveFeature('dashboard');
            });
            
            // Avatar upload
            avatarUploadBtn.addEventListener('click', function() {
                profileAvatarInput.click();
            });
            
            profileAvatarInput.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    // Check if file is an image
                    if (!file.type.match('image.*')) {
                        alert('Please select an image file (JPEG, PNG, GIF)');
                        return;
                    }
                    
                    // Check file size (max 2MB)
                    if (file.size > 2 * 1024 * 1024) {
                        alert('Image size should be less than 2MB');
                        return;
                    }
                    
                    // Create a preview of the image
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        // Update all avatar displays
                        profileAvatar.style.backgroundImage = `url(${e.target.result})`;
                        profileAvatar.textContent = '';
                        profileAvatarLarge.style.backgroundImage = `url(${e.target.result})`;
                        profileAvatarLarge.textContent = '';
                        userAvatar.style.backgroundImage = `url(${e.target.result})`;
                        userAvatar.textContent = '';
                        
                        // Save to user data
                        currentUser.avatar = e.target.result;
                        saveUserData(currentUser);
                        
                        // Add activity
                        activities.unshift({
                            id: Date.now(),
                            icon: 'fa-camera',
                            message: 'Changed profile picture',
                            timestamp: new Date().toISOString()
                        });
                        saveActivities(activities);
                        loadActivities();
                        
                        // Show success message
                        showSuccessMessage('Profile picture updated successfully!');
                    };
                    reader.readAsDataURL(file);
                }
            });
            
            // Settings tabs
            settingsTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    currentTab = tabId;
                    
                    // Update URL to include current tab
                    window.history.replaceState({}, '', window.location.pathname + '#settings-' + tabId);
                    
                    // Remove active class from all tabs
                    settingsTabs.forEach(t => t.classList.remove('active'));
                    // Add active class to clicked tab
                    this.classList.add('active');
                    
                    // Hide all panels
                    settingsPanels.forEach(panel => panel.classList.remove('active'));
                    // Show selected panel
                    document.getElementById(`${tabId}Panel`).classList.add('active');
                });
            });
            
            // Account settings form
            accountForm.addEventListener('submit', function(e) {
                e.preventDefault();
                showLoading('saveAccountBtn', 'accountSpinner', 'accountLoadingText');
                
                const language = document.getElementById('language').value;
                const timezone = document.getElementById('timezone').value;
                const dateFormat = document.getElementById('dateFormat').value;
                
                // Simulate API call delay
                setTimeout(() => {
                    // Save to localStorage
                    currentUser.preferences = {
                        ...currentUser.preferences,
                        language,
                        timezone,
                        dateFormat
                    };
                    saveUserData(currentUser);
                    
                    // Hide loading
                    hideLoading('saveAccountBtn', 'accountSpinner', 'accountLoadingText');
                    
                    // Show success message
                    showSuccessMessage('Account settings saved successfully!');
                }, 1000);
            });
            
            cancelAccountBtn.addEventListener('click', function() {
                // Reset form to current user preferences
                document.getElementById('language').value = currentUser.preferences.language || 'en';
                document.getElementById('timezone').value = currentUser.preferences.timezone || 'cairo';
                document.getElementById('dateFormat').value = currentUser.preferences.dateFormat || 'dd/mm/yyyy';
            });
            
            // Security settings form
            securityForm.addEventListener('submit', function(e) {
                e.preventDefault();
                showLoading('saveSecurityBtn', 'securitySpinner', 'securityLoadingText');
                
                const currentPassword = document.getElementById('currentPassword').value;
                const newPassword = document.getElementById('newPassword').value;
                const confirmPassword = document.getElementById('confirmPassword').value;
                
                // Hide any previous errors
                currentPasswordError.style.display = 'none';
                passwordMatchError.style.display = 'none';
                
                // Simulate API call delay
                setTimeout(() => {
                    // Validate current password (in a real app, this would check against the server)
                    if (currentPassword !== currentUser.password) {
                        currentPasswordError.style.display = 'block';
                        hideLoading('saveSecurityBtn', 'securitySpinner', 'securityLoadingText');
                        return;
                    }
                    
                    // Validate new password
                    if (newPassword !== confirmPassword) {
                        passwordMatchError.style.display = 'block';
                        hideLoading('saveSecurityBtn', 'securitySpinner', 'securityLoadingText');
                        return;
                    }
                    
                    if (newPassword.length < 8) {
                        alert('Password must be at least 8 characters');
                        hideLoading('saveSecurityBtn', 'securitySpinner', 'securityLoadingText');
                        return;
                    }
                    
                    // Update password
                    currentUser.password = newPassword;
                    saveUserData(currentUser);
                    
                    // Hide loading
                    hideLoading('saveSecurityBtn', 'securitySpinner', 'securityLoadingText');
                    
                    // Show success message
                    showSuccessMessage('Security settings saved successfully!');
                    
                    // Add activity
                    activities.unshift({
                        id: Date.now(),
                        icon: 'fa-lock',
                        message: 'Changed password',
                        timestamp: new Date().toISOString()
                    });
                    
                    // Reset form
                    securityForm.reset();
                }, 1000);
            });
            
            cancelSecurityBtn.addEventListener('click', function() {
                // Reset form
                securityForm.reset();
                currentPasswordError.style.display = 'none';
                passwordMatchError.style.display = 'none';
            });
            
            // Notifications settings form
            notificationsForm.addEventListener('submit', function(e) {
                e.preventDefault();
                showLoading('saveNotificationsBtn', 'notificationsSpinner', 'notificationsLoadingText');
                
                const emailTasks = document.getElementById('emailTasks').checked;
                const emailDeadlines = document.getElementById('emailDeadlines').checked;
                const emailUpdates = document.getElementById('emailUpdates').checked;
                const pushMessages = document.getElementById('pushMessages').checked;
                const pushTeamUpdates = document.getElementById('pushTeamUpdates').checked;
                
                // Simulate API call delay
                setTimeout(() => {
                    // Save to localStorage
                    currentUser.notificationPreferences = {
                        email: {
                            tasks: emailTasks,
                            deadlines: emailDeadlines,
                            updates: emailUpdates
                        },
                        push: {
                            messages: pushMessages,
                            teamUpdates: pushTeamUpdates
                        }
                    };
                    saveUserData(currentUser);
                    
                    // Hide loading
                    hideLoading('saveNotificationsBtn', 'notificationsSpinner', 'notificationsLoadingText');
                    
                    // Show success message
                    showSuccessMessage('Notifications settings saved successfully!');
                }, 1000);
            });
            
            cancelNotificationsBtn.addEventListener('click', function() {
                // Reset form to current user preferences
                document.getElementById('emailTasks').checked = currentUser.notificationPreferences.email.tasks;
                document.getElementById('emailDeadlines').checked = currentUser.notificationPreferences.email.deadlines;
                document.getElementById('emailUpdates').checked = currentUser.notificationPreferences.email.updates;
                document.getElementById('pushMessages').checked = currentUser.notificationPreferences.push.messages;
                document.getElementById('pushTeamUpdates').checked = currentUser.notificationPreferences.push.teamUpdates;
            });
            
            // Preferences settings form
            preferencesForm.addEventListener('submit', function(e) {
                e.preventDefault();
                showLoading('savePreferencesBtn', 'preferencesSpinner', 'preferencesLoadingText');
                
                const layoutDensity = document.getElementById('layoutDensity').value;
                const theme = document.getElementById('selectedTheme').value;
                
                // Simulate API call delay
                setTimeout(() => {
                    // Save to localStorage
                    currentUser.preferences = {
                        ...currentUser.preferences,
                        layoutDensity,
                        theme
                    };
                    saveUserData(currentUser);
                    
                    // Apply theme
                    document.body.className = `${theme}-theme ${layoutDensity}`;
                    
                    // Hide loading
                    hideLoading('savePreferencesBtn', 'preferencesSpinner', 'preferencesLoadingText');
                    
                    // Show success message
                    showSuccessMessage('Preferences settings saved successfully!');
                    
                    // Add activity
                    activities.unshift({
                        id: Date.now(),
                        icon: 'fa-palette',
                        message: `Changed theme to ${theme}`,
                        timestamp: new Date().toISOString()
                    });
                    saveActivities(activities);
                    loadActivities();
                }, 1000);
            });
            
            cancelPreferencesBtn.addEventListener('click', function() {
                // Reset form to current user preferences
                document.getElementById('layoutDensity').value = currentUser.preferences.layoutDensity || 'normal';
                document.getElementById('selectedTheme').value = currentUser.preferences.theme || 'blue';
            });
            
            // Theme selection
            themeOptions.forEach(option => {
                option.addEventListener('click', function() {
                    const theme = this.getAttribute('data-theme');
                    document.getElementById('selectedTheme').value = theme;
                    
                    // Apply theme temporarily (will be saved when form is submitted)
                    document.body.className = `${theme}-theme ${currentUser.preferences.layoutDensity || 'normal'}`;
                });
            });
            
            // Layout density change
            document.getElementById('layoutDensity').addEventListener('change', function() {
                applyLayoutDensity(this.value);
            });
            
            // Add team member
            addMemberForm.addEventListener('submit', function(e) {
                e.preventDefault();
                const email = document.getElementById('memberEmail').value;
                const role = document.getElementById('memberRole').value;
                
                // Validate email
                if (!email || !email.includes('@')) {
                    alert('Please enter a valid email address');
                    return;
                }
                
                // Check if email already exists
                if (teamMembers.some(member => member.email === email)) {
                    alert('This email is already a team member');
                    return;
                }
                
                // Create new member
                const name = email.split('@')[0].split('.').map(part => 
                    part.charAt(0).toUpperCase() + part.slice(1)
                ).join(' ');
                
                const newMember = {
                    id: Date.now(),
                    name: name,
                    email,
                    role,
                    initials: name.split(' ').map(n => n[0]).join('').toUpperCase()
                };
                
                // Add to team
                teamMembers.push(newMember);
                saveTeamMembers(teamMembers);
                loadTeamMembers();
                
                // Add activity
                activities.unshift({
                    id: Date.now(),
                    icon: 'fa-user-plus',
                    message: `${currentUser.name} added new ${role}: ${newMember.email}`,
                    timestamp: new Date().toISOString()
                });
                saveActivities(activities);
                loadActivities();
                
                // Add notification
                const newNotification = {
                    id: Date.now(),
                    icon: 'fa-user-plus',
                    message: `New team member - ${newMember.name} has joined your team`,
                    timestamp: new Date().toISOString(),
                    read: false
                };
                
                notifications.unshift(newNotification);
                saveNotifications(notifications);
                updateNotificationBadge();
                
                // Reset form
                this.reset();
                
                // Show success message
                showSuccessMessage(`Team member ${email} added successfully!`);
            });
            
            // Confirm modal actions
            cancelConfirmBtn.addEventListener('click', hideConfirmModal);
            
            // Close dropdowns when clicking outside
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.user-profile') && !e.target.closest('.user-dropdown')) {
                    userDropdown.classList.remove('active');
                }
                
                if (e.target === notificationsModal) {
                    notificationsModal.style.display = 'none';
                }
                
                if (e.target === confirmModal) {
                    hideConfirmModal();
                }
            });
            
            // Initialize the dashboard
            initDashboard();
        });
    </script>
</body>
</html>
