<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TeamFlow | Dashboard</title>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="https://img.icons8.com/fluency/48/000000/group-task.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://img.icons8.com/fluency/32/000000/group-task.png">
    <link rel="apple-touch-icon" sizes="180x180" href="https://img.icons8.com/fluency/180/000000/group-task.png">

    <style>
        /* --- Base Variables --- */
        :root {
            --primary: #2563eb;
            --primary-dark: #1e3a8a;
            --primary-light: #dbeafe;
            --secondary: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --dark: #1e293b;
            --light: #f8fafc;
            --gray: #64748b;
            --light-gray: #e2e8f0;
            --white: #ffffff;
            --sidebar-width: 280px;
            --sidebar-bg: #1e3a8a;
            --sidebar-text: rgba(255,255,255,0.9);
            --sidebar-hover: rgba(255,255,255,0.1);
            --sidebar-active: rgba(255,255,255,0.2);
            --sidebar-divider: rgba(255,255,255,0.1);
            --success: #10b981;
            --team-manager: #ef4444;
            --compact-padding: 0.5rem;
            --normal-padding: 1rem;
            --spacious-padding: 1.5rem;
        }
        /* --- Base Styles --- */
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        body { background-color: var(--primary-light); color: var(--dark); display: flex; min-height: 100vh; transition: background-color 0.3s ease, color 0.3s ease; }

        /* --- Sidebar Styles --- */
        .sidebar { width: var(--sidebar-width); background-color: var(--sidebar-bg); height: 100vh; position: fixed; overflow-y: auto; transition: all 0.3s; z-index: 100; display: flex; flex-direction: column; }
        .sidebar-header { padding: 1.5rem; border-bottom: 1px solid var(--sidebar-divider); display: flex; align-items: center; justify-content: space-between; }
        .logo { font-size: 1.25rem; font-weight: 700; color: var(--white); display: flex; align-items: center; gap: 0.75rem; }
        .logo-icon { color: var(--white); font-size: 1.5rem; }
        .sidebar-menu { padding: 1rem 0; flex-grow: 1; overflow-y: auto; }
        .menu-title { padding: 0.75rem 1.5rem; font-size: 0.75rem; font-weight: 600; text-transform: uppercase; color: rgba(255,255,255,0.6); letter-spacing: 0.5px; }
        .menu-item { display: flex; align-items: center; padding: 0.75rem 1.5rem; color: var(--sidebar-text); text-decoration: none; transition: all 0.2s; border-left: 3px solid transparent; margin: 0.25rem 0; cursor: pointer;}
        .menu-item:hover { background-color: var(--sidebar-hover); color: var(--white); }
        .menu-item.active { background-color: var(--sidebar-active); color: var(--white); border-left-color: var(--white); font-weight: 600;}
        .menu-item i { margin-right: 0.75rem; font-size: 1.1rem; width: 24px; text-align: center; }
        .menu-divider { height: 1px; background-color: var(--sidebar-divider); margin: 1rem 1.5rem; }
        .connection-status { padding: 0.75rem 1.5rem; margin-top: auto; border-top: 1px solid var(--sidebar-divider); display: flex; align-items: center; gap: 0.5rem; color: rgba(16, 185, 129, 0.9); font-size: 0.85rem; flex-shrink: 0; }
        .status-dot { width: 8px; height: 8px; border-radius: 50%; background-color: var(--success); animation: pulseStatus 2s infinite; }
        @keyframes pulseStatus { 0%, 100% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.4); } 50% { box-shadow: 0 0 0 5px rgba(16, 185, 129, 0); } }

        /* --- Main Content & Top Nav Styles --- */
        .main-content { flex: 1; margin-left: var(--sidebar-width); transition: all 0.3s; }
        .top-nav { background-color: var(--white); padding: var(--normal-padding) 2rem; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--light-gray); position: sticky; top: 0; z-index: 90; transition: padding 0.3s ease, background-color 0.3s ease, border-color 0.3s ease; }
        body.compact .top-nav { padding: var(--compact-padding) 1rem; }
        body.spacious .top-nav { padding: var(--spacious-padding) 2rem; }
        .search-bar { position: relative; width: 400px; }
        .search-bar input { width: 100%; padding: 0.75rem 1rem 0.75rem 2.5rem; border: 1px solid var(--light-gray); border-radius: 6px; font-size: 0.9rem; transition: all 0.2s; background-color: var(--white); color: var(--dark); }
        .search-bar input:focus { outline: none; border-color: var(--primary); box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1); }
        .search-icon { position: absolute; left: 1rem; top: 50%; transform: translateY(-50%); color: var(--gray); }
        .search-results { position: absolute; top: 100%; left: 0; width: 100%; background-color: var(--white); border: 1px solid var(--light-gray); border-radius: 0 0 6px 6px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); z-index: 100; display: none; max-height: 300px; overflow-y: auto; }
        .search-results.active { display: block; }
        .search-result-item { padding: 0.75rem 1rem; cursor: pointer; transition: background-color 0.2s; color: var(--dark); }
        .search-result-item:hover { background-color: var(--primary-light); }
        .user-menu { display: flex; align-items: center; gap: 1.5rem; }
        .notification-icon { position: relative; color: var(--gray); cursor: pointer; font-size: 1.1rem; }
        .notification-badge { position: absolute; top: -5px; right: -5px; background-color: var(--danger); color: white; border-radius: 50%; width: 18px; height: 18px; display: flex; align-items: center; justify-content: center; font-size: 0.65rem; font-weight: 600; }
        .user-profile { display: flex; align-items: center; gap: 0.75rem; position: relative; }
        .user-avatar { width: 36px; height: 36px; border-radius: 50%; background-color: var(--primary); color: white; display: flex; align-items: center; justify-content: center; font-weight: 600; cursor: pointer; background-size: cover; background-position: center; }
        .user-profile-details { display: flex; align-items: center; cursor: pointer; }
        .user-name { font-weight: 500; color: var(--dark); }
        .user-status { font-size: 0.8rem; color: var(--success); margin-left: 0.5rem; font-weight: 600; text-shadow: 0 0 4px rgba(16, 185, 129, 0.4); }
        .user-dropdown { position: absolute; top: 110%; right: 0; background-color: var(--white); border: 1px solid var(--light-gray); border-radius: 6px; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); width: 200px; z-index: 100; display: none; animation: fadeInDropdown 0.2s ease-out; }
        @keyframes fadeInDropdown { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }
        .user-dropdown.active { display: block; }
        .dropdown-item { padding: 0.75rem 1rem; display: flex; align-items: center; gap: 0.75rem; color: var(--dark); text-decoration: none; transition: background-color 0.2s; font-size: 0.9rem; }
        .dropdown-item:hover { background-color: var(--light); }
        .dropdown-item i { width: 20px; text-align: center; color: var(--gray); }

        /* --- Content Area & Sections Styles --- */
        .content-area { padding: 2rem; min-height: calc(100vh - 70px); transition: padding 0.3s ease; }
        body.compact .content-area { padding: 1rem; }
        body.spacious .content-area { padding: 3rem; }
        .welcome-section { background-color: var(--primary-dark); color: var(--white); padding: 2rem; border-radius: 8px; margin-bottom: 2rem; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); transition: padding 0.3s ease, margin-bottom 0.3s ease, background-color 0.3s ease; }
        body.compact .welcome-section { padding: 1rem; margin-bottom: 1rem; }
        body.spacious .welcome-section { padding: 3rem; margin-bottom: 3rem; }
        .welcome-title { font-size: 1.5rem; font-weight: 700; margin-bottom: 0.5rem; }
        body.compact .welcome-title { font-size: 1.25rem; }
        .welcome-subtitle { font-size: 1rem; opacity: 0.9; margin-top: 0.25rem; margin-bottom: 1.5rem; font-weight: 400; }
        body.compact .welcome-subtitle { font-size: 0.9rem; margin-bottom: 1rem;}
        .user-info { display: flex; align-items: center; gap: 1.5rem; margin-top: 1.5rem; }
        body.compact .user-info { flex-direction: column; text-align: center; gap: 1rem; margin-top: 1rem; }
        .user-info-avatar { width: 80px; height: 80px; border-radius: 50%; background-color: var(--primary-light); color: var(--primary); display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 1.75rem; background-size: cover; background-position: center; position: relative; cursor: default; }
        body.compact .user-info-avatar { width: 60px; height: 60px; font-size: 1.25rem; }
        .user-info-details { flex: 1; }
        .user-info-name { font-weight: 600; font-size: 1.25rem; margin-bottom: 0.25rem; }
        body.compact .user-info-name { font-size: 1rem; }
        .user-info-title { opacity: 0.9; font-size: 0.9rem; margin-bottom: 0.5rem; color: var(--light-gray); font-weight: 600; }
        .user-info-title.role-admin { color: var(--team-manager); }
        body.compact .user-info-title { font-size: 0.8rem; }
        .user-info-email { display: flex; align-items: center; gap: 0.5rem; font-size: 0.9rem; opacity: 0.9; }
        .stats-section { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin-bottom: 2rem; transition: gap 0.3s ease, margin-bottom 0.3s ease; }
        body.compact .stats-section { gap: 1rem; margin-bottom: 1rem; }
        body.spacious .stats-section { gap: 2rem; margin-bottom: 3rem; }
        .stat-card { background-color: var(--white); border-radius: 8px; padding: 1.5rem; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.08); transition: transform 0.2s, box-shadow 0.2s, padding 0.3s ease, background-color 0.3s ease; position: relative; overflow: hidden; }
        body.compact .stat-card { padding: 1rem; }
        body.spacious .stat-card { padding: 2rem; }
        .stat-card:hover { transform: translateY(-4px); box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1); }
        .stat-card::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 5px; background: linear-gradient(90deg, var(--primary), var(--secondary)); opacity: 0.9; }
        .stat-title { font-size: 0.9rem; color: var(--gray); margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem; }
        body.compact .stat-title { font-size: 0.8rem; }
        .stat-title i { color: var(--primary); }
        .stat-value { font-size: 1.75rem; font-weight: 700; color: var(--primary-dark); display: flex; align-items: center; justify-content: space-between; }
        body.compact .stat-value { font-size: 1.5rem; }
        .stat-trend { display: flex; align-items: center; font-size: 0.9rem; font-weight: 500; }
        body.compact .stat-trend { font-size: 0.8rem; }
        .trend-up { color: var(--secondary); }
        .trend-down { color: var(--danger); }
        .trend-neutral { color: var(--gray); }
        .activity-section { background-color: var(--white); border-radius: 8px; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1); padding: 1.5rem; transition: padding 0.3s ease, background-color 0.3s ease; }
        body.compact .activity-section { padding: 1rem; }
        body.spacious .activity-section { padding: 2rem; }
        .section-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; transition: margin-bottom 0.3s ease; flex-wrap: wrap; gap: 0.5rem; }
        body.compact .section-header { margin-bottom: 1rem; }
        body.spacious .section-header { margin-bottom: 2rem; }
        .section-title { font-size: 1.25rem; font-weight: 600; color: var(--dark); }
        body.compact .section-title { font-size: 1.1rem; }
        .live-badge { display: inline-flex; align-items: center; background-color: var(--danger); color: white; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.75rem; font-weight: 600; margin-left: 0.5rem; animation: pulse 2s infinite; }
        @keyframes pulse { 0% { transform: scale(1); opacity: 1; } 50% { transform: scale(1.05); opacity: 0.8; } 100% { transform: scale(1); opacity: 1; } }
        .section-header > div { display: flex; align-items: center; gap: 1rem;}
        .view-all, .delete-all { font-weight: 500; cursor: pointer; transition: color 0.2s, background-color 0.2s; padding: 0.5rem; border-radius: 4px; font-size: 0.9rem; }
        .view-all { color: var(--primary); }
        .view-all:hover { color: var(--primary-dark); text-decoration: underline; background-color: var(--primary-light); }
        .delete-all { color: var(--danger); }
        .delete-all:hover { color: #dc2626; text-decoration: underline; background-color: rgba(239, 68, 68, 0.1); }
        .activity-list { list-style: none; padding-left: 0;}
        .activity-item { display: flex; padding: 1rem 0; border-bottom: 1px solid var(--light-gray); align-items: center; transition: background-color 0.3s, padding 0.3s ease, border-color 0.3s ease; }
        body.compact .activity-item { padding: 0.75rem 0; }
        body.spacious .activity-item { padding: 1.25rem 0; }
        .activity-item:last-child { border-bottom: none; }
        .activity-item.new-activity { background-color: rgba(37, 99, 235, 0.08); animation: highlightNewActivity 2.5s ease-out forwards; }
        @keyframes highlightNewActivity { 0% { background-color: rgba(37, 99, 235, 0.15); } 100% { background-color: transparent; } }
        .activity-icon { width: 40px; height: 40px; border-radius: 50%; background-color: rgba(37, 99, 235, 0.1); color: var(--primary); display: flex; align-items: center; justify-content: center; margin-right: 1rem; flex-shrink: 0; transition: width 0.3s, height 0.3s, margin-right 0.3s, font-size 0.3s; }
        body.compact .activity-icon { width: 32px; height: 32px; margin-right: 0.75rem; font-size: 0.9rem; }
        .activity-content { flex: 1; }
        .activity-message { margin-bottom: 0.25rem; color: var(--dark); }
        body.compact .activity-message { font-size: 0.9rem; }
        .activity-time { font-size: 0.8rem; color: var(--gray); }
        body.compact .activity-time { font-size: 0.7rem; }
        .activity-actions { display: flex; gap: 0.5rem; margin-left: auto; padding-left: 1rem; }
        .delete-activity { color: var(--danger); cursor: pointer; opacity: 0.6; transition: opacity 0.2s, background-color 0.2s; padding: 0.5rem; border-radius: 4px; }
        .delete-activity:hover { opacity: 1; background-color: rgba(239, 68, 68, 0.1); }

        /* --- Profile & Settings Sections Styles --- */
        .content-section { /* Shared styles already applied */ background-color: var(--white); border-radius: 8px; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1); padding: 2rem; transition: padding 0.3s ease, background-color 0.3s ease; }
        body.compact .content-section { padding: 1rem; }
        body.spacious .content-section { padding: 3rem; }
        .section-main-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; transition: margin-bottom 0.3s ease; }
        body.compact .section-main-header { margin-bottom: 1.5rem; }
        body.spacious .section-main-header { margin-bottom: 3rem; }
        .section-main-title { font-size: 1.5rem; font-weight: 600; color: var(--primary-dark); }
        body.compact .section-main-title { font-size: 1.25rem; }
        .profile-header-text { margin-bottom: 2rem; color: var(--gray); font-size: 0.95rem;}
        .profile-avatar-section { text-align: center; margin-bottom: 2rem; }
        #profileAvatarLarge { width: 120px; height: 120px; border-radius: 50%; background-color: var(--primary-light); color: var(--primary-dark); display: inline-flex; align-items: center; justify-content: center; font-weight: 600; font-size: 3rem; background-size: cover; background-position: center; margin-bottom: 1rem; border: 3px solid var(--white); box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        #uploadPhotoButton { margin-top: 0.5rem;}
        .data-form { display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; transition: gap 0.3s ease; }
        body.compact .data-form { gap: 1rem; }
        body.spacious .data-form { gap: 2rem; }
        .form-group { margin-bottom: 1rem; transition: margin-bottom 0.3s ease; }
        body.compact .form-group { margin-bottom: 0.75rem; }
        body.spacious .form-group { margin-bottom: 1.5rem; }
        .form-group label { display: block; margin-bottom: 0.5rem; font-weight: 500; color: var(--dark); transition: margin-bottom 0.3s ease, font-size 0.3s ease; }
        body.compact .form-group label { margin-bottom: 0.25rem; font-size: 0.9rem; }
        .form-control { width: 100%; padding: 0.75rem; border: 1px solid var(--light-gray); border-radius: 6px; font-size: 1rem; background-color: var(--white); color: var(--dark); transition: border-color 0.2s, box-shadow 0.2s, padding 0.3s ease, font-size 0.3s ease, background-color 0.3s ease, color 0.3s ease; }
        body.compact .form-control { padding: 0.5rem; font-size: 0.9rem; }
        body.spacious .form-control { padding: 1rem; }
        .form-control:focus { outline: none; border-color: var(--primary); box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1); }
        .form-control[readonly] { background-color: var(--light-gray); cursor: not-allowed; }
        .form-actions { grid-column: span 2; display: flex; justify-content: flex-end; gap: 1rem; margin-top: 1rem; transition: margin-top 0.3s ease; }
        body.compact .form-actions { margin-top: 0.5rem; }
        body.spacious .form-actions { margin-top: 2rem; }
        .btn { padding: 0.75rem 1.5rem; border-radius: 6px; font-weight: 500; cursor: pointer; transition: all 0.2s; border: none; display: inline-flex; align-items: center; gap: 0.5rem; }
        body.compact .btn { padding: 0.5rem 1rem; font-size: 0.9rem; }
        body.spacious .btn { padding: 1rem 2rem; }
        .btn-primary { background-color: var(--primary); color: white; }
        .btn-primary:hover:not(:disabled) { background-color: var(--primary-dark); }
        .btn-outline { background-color: transparent; border: 1px solid var(--primary); color: var(--primary); }
        .btn-outline:hover:not(:disabled) { background-color: var(--primary-light); }
        .btn-danger { background-color: var(--danger); color: white; }
        .btn-danger:hover:not(:disabled) { background-color: #dc2626; }
        .btn-success { background-color: var(--success); color: white; }
        .btn-success:hover:not(:disabled) { background-color: #0d9f6e; }
        .btn:disabled { opacity: 0.6; cursor: not-allowed; }
        .settings-tabs { display: flex; border-bottom: 1px solid var(--light-gray); margin-bottom: 2rem; transition: margin-bottom 0.3s ease, border-color 0.3s ease; overflow-x: auto; }
        body.compact .settings-tabs { margin-bottom: 1.5rem; }
        body.spacious .settings-tabs { margin-bottom: 3rem; }
        .settings-tab { padding: 0.75rem 1.5rem; cursor: pointer; border-bottom: 2px solid transparent; font-weight: 500; color: var(--gray); transition: all 0.2s; white-space: nowrap; }
        body.compact .settings-tab { padding: 0.5rem 1rem; font-size: 0.9rem; }
        body.spacious .settings-tab { padding: 1rem 2rem; }
        .settings-tab:hover { color: var(--primary); }
        .settings-tab.active { color: var(--primary); border-bottom-color: var(--primary); font-weight: 600;}
        .settings-tab.disabled { color: var(--light-gray); cursor: not-allowed; pointer-events: none; }
        .settings-panel { display: none; }
        .settings-panel.active { display: block; animation: fadeInPanel 0.5s ease-out; }
        @keyframes fadeInPanel { from { opacity: 0; } to { opacity: 1; } }
        .switch { position: relative; display: inline-block; width: 50px; height: 24px; flex-shrink: 0; }
        body.compact .switch { width: 40px; height: 20px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; }
        .slider:before { position: absolute; content: ""; height: 16px; width: 16px; left: 4px; bottom: 4px; background-color: white; transition: .4s; }
        body.compact .slider:before { height: 14px; width: 14px; left: 3px; bottom: 3px; }
        input:checked + .slider { background-color: var(--primary); }
        input:checked + .slider:before { transform: translateX(26px); }
        body.compact input:checked + .slider:before { transform: translateX(20px); }
        .slider.round { border-radius: 34px; }
        .slider.round:before { border-radius: 50%; }
        .team-management { margin-top: 1.5rem; }
        body.compact .team-management { margin-top: 1rem; }
        body.spacious .team-management { margin-top: 2rem; }
        .team-management h3, .add-member-form h4 { color: var(--dark); margin-bottom: 1rem; }
        .team-list { margin-top: 1rem; }
        body.compact .team-list { margin-top: 0.75rem; }
        body.spacious .team-list { margin-top: 1.5rem; }
        .team-member-card { display: flex; align-items: center; padding: 1rem; border: 1px solid var(--light-gray); border-radius: 8px; margin-bottom: 1rem; transition: all 0.2s; background-color: var(--white); }
        body.compact .team-member-card { padding: 0.75rem; margin-bottom: 0.75rem; }
        body.spacious .team-member-card { padding: 1.25rem; margin-bottom: 1.25rem; }
        .team-member-card:hover { box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05); border-color: var(--primary); }
        .member-avatar { width: 50px; height: 50px; border-radius: 50%; background-color: var(--light-gray); margin-right: 1rem; display: flex; align-items: center; justify-content: center; font-weight: 600; background-size: cover; background-position: center; color: var(--primary-dark); transition: width 0.3s, height 0.3s, margin-right 0.3s, font-size 0.3s; flex-shrink: 0; }
        body.compact .member-avatar { width: 40px; height: 40px; margin-right: 0.75rem; font-size: 0.9rem; }
        .member-details { flex: 1; min-width: 0; }
        .member-name { font-weight: 500; margin-bottom: 0.25rem; color: var(--dark); white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}
        body.compact .member-name { font-size: 0.9rem; }
        .member-email { font-size: 0.9rem; color: var(--gray); white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}
        body.compact .member-email { font-size: 0.8rem; }
        .member-role { padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.8rem; font-weight: 500; margin: 0 1rem; flex-shrink: 0; }
        body.compact .member-role { font-size: 0.7rem; margin: 0 0.75rem; }
        .role-admin { background-color: rgba(239, 68, 68, 0.1); color: var(--danger); }
        .role-senior { background-color: rgba(37, 99, 235, 0.1); color: var(--primary); }
        .role-supervisor { background-color: rgba(245, 158, 11, 0.1); color: var(--warning); }
        .role-member { background-color: rgba(16, 185, 129, 0.1); color: var(--secondary); }
        .member-actions { display: flex; gap: 0.5rem; flex-shrink: 0; }
        .member-actions .btn-sm { padding: 0.3rem 0.6rem; font-size: 0.8rem; }
        .add-member-form { margin-top: 2rem; padding: 1.5rem; border: 1px dashed var(--light-gray); border-radius: 8px; background-color: var(--light); }
        body.compact .add-member-form { margin-top: 1.5rem; padding: 1rem; }
        body.spacious .add-member-form { margin-top: 3rem; padding: 2rem; }
        .password-error { color: var(--danger); font-size: 0.85rem; margin-top: 0.25rem; display: none; }
        .spinner { width: 18px; height: 18px; border: 2px solid rgba(255,255,255,0.3); border-radius: 50%; border-top-color: white; animation: spin 1s ease-in-out infinite; display: none; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .btn-outline .spinner { border-color: rgba(37, 99, 235, 0.3); border-top-color: var(--primary); }
        .loading-text { display: none; font-size: 0.9rem; color: var(--gray); margin-left: 0.5rem; }

        /* --- Theme Styles & Responsive --- */
        body.light-theme { --primary-light: #f1f5f9; --light: #ffffff; --white: #ffffff; --dark: #1e293b; --gray: #64748b; --light-gray: #e2e8f0; background-color: var(--primary-light); }
        body.dark-theme { --primary: #3b82f6; --primary-dark: #1e40af; --primary-light: #1e293b; --light: #334155; --white: #0f172a; --dark: #e2e8f0; --gray: #94a3b8; --light-gray: #334155; background-color: var(--white); }
        body.dark-theme .top-nav { background-color: var(--primary-light); border-bottom-color: var(--light-gray); }
        body.dark-theme .stat-card, body.dark-theme .activity-section, body.dark-theme .content-section, body.dark-theme .team-member-card, body.dark-theme .add-member-form { background-color: var(--primary-light); }
        body.dark-theme .search-bar input, body.dark-theme .form-control { background-color: var(--light); border-color: var(--light-gray); color: var(--dark); }
        body.dark-theme .form-control[readonly] { background-color: var(--primary-light); }
        body.dark-theme .search-results { background-color: var(--light); border-color: var(--light-gray); }
        body.dark-theme .search-result-item:hover { background-color: var(--primary-light); }
        body.dark-theme .user-dropdown { background-color: var(--light); border-color: var(--light-gray); }
        body.dark-theme .dropdown-item:hover { background-color: var(--primary-light); }
        body.dark-theme .notifications-container { background-color: var(--primary-light); }
        body.dark-theme .notification-list-item:hover { background-color: var(--light); }
        body.dark-theme .notification-list-item.unread { background-color: rgba(59, 130, 246, 0.1); }
        body.dark-theme .confirm-container { background-color: var(--light); }
        body.dark-theme .theme-option div { border-color: var(--light-gray); }
        body.dark-theme .theme-option[data-theme="dark"] div { border-color: var(--primary); }
        body.dark-theme .back-button:hover { background-color: var(--light); }
        body.dark-theme .notifications-footer { background-color: var(--primary-light); }
        body.dark-theme .welcome-section { background-color: var(--primary-dark); color: var(--white); }
        body.dark-theme .user-info-title { color: var(--light-gray); }
        body.dark-theme .user-info-title.role-admin { color: var(--team-manager); }
        body.dark-theme .user-info-email { color: var(--light-gray); }
        body.dark-theme .welcome-subtitle { color: var(--light-gray); }
        body.blue-theme { --primary-light: #dbeafe; --light: #eff6ff; --white: #ffffff; --dark: #1e293b; background-color: var(--primary-light); }
        .theme-option { display: flex; flex-direction: column; align-items: center; }
        .theme-option div { width: 60px; height: 40px; border: 2px solid var(--light-gray); border-radius: 6px; cursor: pointer; transition: border-color 0.2s; }
        .theme-option span { text-align: center; display: block; margin-top: 0.5rem; font-size: 0.9rem; color: var(--dark); }
        .theme-option:hover div { border-color: var(--primary); }
        .theme-option.selected div { border-color: var(--primary); border-width: 3px; }
        .notifications-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); z-index: 1000; display: none; justify-content: flex-end; }
        .notifications-container { width: 400px; max-width: 100%; background-color: var(--white); height: 100vh; overflow-y: auto; animation: slideIn 0.3s ease-out; box-shadow: -2px 0 10px rgba(0, 0, 0, 0.1); display: flex; flex-direction: column; }
        @keyframes slideIn { from { transform: translateX(100%); } to { transform: translateX(0); } }
        .notifications-header { padding: 1.5rem; border-bottom: 1px solid var(--light-gray); display: flex; justify-content: space-between; align-items: center; background-color: var(--primary); color: white; flex-shrink: 0; }
        .notifications-title { font-size: 1.25rem; font-weight: 600; }
        .close-notifications { background: none; border: none; font-size: 1.25rem; cursor: pointer; color: white; }
        .notifications-body { flex-grow: 1; overflow-y: auto; }
        .notification-list-item { padding: 1rem 1.5rem; border-bottom: 1px solid var(--light-gray); transition: background-color 0.2s; display: flex; gap: 1rem; align-items: center; cursor: pointer; }
        .notification-list-item:hover { background-color: var(--light); }
        .notification-list-item.unread { background-color: rgba(37, 99, 235, 0.05); font-weight: 500; }
        .notification-list-item:last-child { border-bottom: none; }
        .notification-icon-wrapper { width: 40px; height: 40px; border-radius: 50%; background-color: rgba(37, 99, 235, 0.1); color: var(--primary); display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
        .notification-content { flex: 1; min-width: 0; }
        .notification-message { margin-bottom: 0.25rem; color: var(--dark); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .notification-time { font-size: 0.8rem; color: var(--gray); }
        .delete-notification { color: var(--danger); cursor: pointer; opacity: 0.6; transition: opacity 0.2s; margin-left: auto; padding: 0.5rem; flex-shrink: 0; }
        .delete-notification:hover { opacity: 1; }
        .no-notifications-message { text-align: center; padding: 2rem; color: var(--gray); }
        .notifications-footer { padding: 1rem 1.5rem; border-top: 1px solid var(--light-gray); display: flex; justify-content: space-between; flex-shrink: 0; background-color: var(--light); }
        .confirm-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.6); z-index: 1100; display: none; justify-content: center; align-items: center; backdrop-filter: blur(3px); }
        .confirm-container { background-color: var(--white); border-radius: 8px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15); width: 400px; max-width: 90%; padding: 2rem; animation: fadeInScale 0.3s ease-out; }
        @keyframes fadeInScale { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }
        .confirm-title { font-size: 1.25rem; font-weight: 600; margin-bottom: 1rem; color: var(--dark); }
        .confirm-message { margin-bottom: 1.5rem; line-height: 1.5; color: var(--gray); }
        .confirm-actions { display: flex; justify-content: flex-end; gap: 1rem; }
        .success-message { position: fixed; top: 20px; right: 20px; background-color: var(--success); color: white; padding: 1rem 1.5rem; border-radius: 6px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); display: flex; align-items: center; gap: 0.75rem; z-index: 1200; transform: translateX(120%); transition: transform 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55); }
        .success-message.show { transform: translateX(0); }
        .success-message i { font-size: 1.25rem; }
        .back-button { display: inline-flex; align-items: center; gap: 0.75rem; color: var(--primary); font-weight: 500; cursor: pointer; margin-bottom: 1.5rem; padding: 0.6rem 1.2rem; border-radius: 6px; transition: background-color 0.2s, border-color 0.2s, color 0.2s; border: 1px solid transparent; font-size: 0.9rem; }
        .back-button:hover { background-color: var(--primary-light); border-color: var(--primary); color: var(--primary-dark); }
        .back-button i { transition: transform 0.2s; font-size: 0.8rem; }
        .back-button:hover i { transform: translateX(-3px); }
        #notificationSound { display: none; }
        .d-none { display: none !important; }
        .placeholder-content { text-align: center; padding: 4rem 2rem; color: var(--gray); border: 2px dashed var(--light-gray); border-radius: 8px; margin-top: 2rem; min-height: 300px; display: flex; flex-direction: column; justify-content: center; align-items: center; transition: border-color 0.3s, color 0.3s; }
        .placeholder-content h2 { color: var(--dark); margin-bottom: 1rem; }
        .placeholder-content .loading-indicator { font-size: 1.2rem; margin-top: 1rem; }
        .placeholder-content .error-message { color: var(--danger); font-weight: 500; margin-top: 1rem; white-space: pre-wrap; text-align: left; padding: 1rem; background: rgba(239, 68, 68, 0.05); border: 1px solid rgba(239, 68, 68, 0.2); border-radius: 4px; max-width: 100%; overflow-wrap: break-word; }

        /* --- New styles for section management --- */
        .content-section { display: none; animation: fadeInContent 0.4s ease-in-out; }
        .content-section.active { display: block; }
        @keyframes fadeInContent { from { opacity: 0; } to { opacity: 1; } }

        /* --- Additional styles from employee-schedule.txt (Scoped) --- */
        #featureSectionsContainer .schedule-page-header { margin-bottom: 1.5rem; }
        #featureSectionsContainer .schedule-page-title { font-size: 1.5rem; font-weight: 600; border-bottom: none; margin-bottom: 0; }
        #featureSectionsContainer .schedule-controls { margin-bottom: 1.5rem; }
        #featureSectionsContainer .schedule-container { margin-top: 1rem; }
        #featureSectionsContainer .schedule-table { width: 100%; min-width: 800px; border-collapse: collapse; border-spacing: 0; }
        #featureSectionsContainer .schedule-table thead th { padding: 1rem 0.75rem; text-align: center; background-color: var(--primary); color: white; font-weight: 600; position: sticky; top: 0; z-index: 10; border-bottom: 2px solid var(--primary-dark); }
        #featureSectionsContainer .schedule-table tbody td { padding: 0.75rem; text-align: center; border: 1px solid var(--light-gray); vertical-align: middle; }
        #featureSectionsContainer .schedule-table tbody tr:nth-child(even) td { background-color: #f9fafb; }
        #featureSectionsContainer .schedule-table tbody tr:hover td { background-color: #f0f9ff; }
        #featureSectionsContainer .employee-name { font-weight: 600; text-align: left; position: sticky; left: 0; background-color: var(--white); z-index: 5; border-right: 2px solid var(--light-gray); white-space: nowrap; }
        #featureSectionsContainer .schedule-table tbody tr:nth-child(even) td.employee-name { background-color: #f9fafb; }
        #featureSectionsContainer .schedule-table tbody tr:hover td.employee-name { background-color: #f0f9ff; }
        #featureSectionsContainer .shift { padding: 0.3rem 0.6rem; border-radius: 12px; font-size: 0.8rem; font-weight: 500; white-space: nowrap; display: inline-block; min-width: 60px; border: 1px solid transparent; }
        #featureSectionsContainer .shift-morning { background-color: #dbeafe; color: #1e40af; border-color: #bfdbfe; }
        #featureSectionsContainer .shift-afternoon { background-color: #e0f2fe; color: #0c4a6e; border-color: #bae6fd;}
        #featureSectionsContainer .shift-night { background-color: #ede9fe; color: #5b21b6; border-color: #ddd6fe; }
        #featureSectionsContainer .day-off { background-color: #f0fdf4; color: #166534; border-color: #bbf7d0; }
        #featureSectionsContainer .sick-leave { background-color: #fee2e2; color: #991b1b; border-color: #fecaca; }
        #featureSectionsContainer .vacation { background-color: #ffedd5; color: #9a3412; border-color: #fed7aa; }
        #featureSectionsContainer .day-header { display: flex; flex-direction: column; gap: 0.25rem; align-items: center; }
        #featureSectionsContainer .day-name { font-weight: 600; font-size: 0.9rem; }
        #featureSectionsContainer .day-date { font-size: 0.8rem; opacity: 0.8; }
        #featureSectionsContainer .modal { /* Styles for modals loaded dynamically */ /* These might need to be global or loaded with the component */ display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.6); z-index: 1000; justify-content: center; align-items: center; padding: 20px; }
        #featureSectionsContainer .modal.active { display: flex; }
        #featureSectionsContainer .modal-content { background-color: var(--white); width: 100%; max-width: 600px; border-radius: 8px; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2); padding: 2rem; max-height: 90vh; overflow-y: auto; animation: zoomIn 0.3s ease-out; }
        #featureSectionsContainer .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 1px solid var(--light-gray); }
        #featureSectionsContainer .modal-title { font-size: 1.5rem; font-weight: 600; color: var(--primary-dark); }
        #featureSectionsContainer .close-modal { background: none; border: none; font-size: 1.8rem; cursor: pointer; color: var(--gray); line-height: 1;}
        #featureSectionsContainer .close-modal:hover { color: var(--danger); }
        #featureSectionsContainer .admin-controls { position: relative; padding: 5px 0; }
        #featureSectionsContainer .edit-shift { cursor: pointer; color: var(--primary); font-size: 0.75rem; display: none; margin-left: 5px; font-weight: 500; }
        #featureSectionsContainer .admin-controls:hover .edit-shift, #featureSectionsContainer .admin-controls.editable .edit-shift { display: inline; }
        #featureSectionsContainer .toast { /* This should likely remain global, defined outside */ }
        @keyframes zoomIn { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }


        /* Responsive Overrides */
        @media (max-width: 992px) { .sidebar { transform: translateX(-100%); width: 250px; } .sidebar.active { transform: translateX(0); box-shadow: 2px 0 10px rgba(0,0,0,0.1); } .main-content { margin-left: 0; } .search-bar { width: 250px; } .team-member-card { flex-wrap: wrap; } }
        @media (max-width: 768px) { .top-nav { flex-direction: column; gap: 1rem; padding: 1rem; } .search-bar { width: 100%; order: 2; } .user-menu { width: 100%; justify-content: space-between; order: 1; } .content-area { padding: 1.5rem; } .data-form { grid-template-columns: 1fr; } .form-actions { grid-column: span 1; } .user-info { flex-direction: column; text-align: center; } .user-info-avatar { margin-bottom: 1rem; } .stats-section { grid-template-columns: 1fr; } .settings-tabs { flex-wrap: wrap; } .settings-tab { padding: 0.5rem 1rem; } .confirm-container { width: 90%; } .team-member-card { flex-direction: column; align-items: flex-start; gap: 0.5rem; } .member-role { margin: 0.5rem 0; } .member-actions { margin-top: 0.5rem; } .profile-avatar-section { margin-bottom: 1.5rem; } #profileAvatarLarge { width: 100px; height: 100px; font-size: 2.5rem; } .add-member-form .data-form { grid-template-columns: 1fr; align-items: stretch; } .add-member-form .data-form > div { margin-bottom: 1rem; } .add-member-form .data-form > div:last-child { margin-top: 0; } /* Schedule mobile fixes */ #featureSectionsContainer .schedule-controls { flex-direction: column; gap: 1rem; align-items: flex-start; } #featureSectionsContainer .schedule-page-header { flex-direction: column; align-items: flex-start; gap: 1rem; } #featureSectionsContainer .employee-name { position: static !important; /* Ensure it's not sticky */ } #featureSectionsContainer .modal-content { width: 95%; padding: 1.5rem;} }
        @media (max-width: 480px) { .section-header > div { justify-content: center; width: 100%; } .welcome-section { padding: 1.5rem; } .stats-section { gap: 0.75rem; } .stat-card { padding: 1rem; } }

    </style>
</head>
<body class="blue-theme">

    <audio id="notificationSound" preload="auto">
        <source src="assets/notification.mp3" type="audio/mpeg"> <!-- Modified audio file path -->
        Your browser does not support the audio element.
    </audio>

    <!-- Success message, sidebar, main-content, top-nav, modals -->
    <div class="success-message" id="successMessage"> <i class="fas fa-check-circle"></i> <span id="successMessageText">Action successful!</span> </div>
    <aside class="sidebar" id="sidebar"> <!-- Sidebar HTML --> <div class="sidebar-header"> <div class="logo"> <i class="fas fa-users-cog logo-icon"></i> <span>TeamFlow</span> </div> </div> <div class="sidebar-menu"> <div class="menu-title">Navigation</div> <a href="#dashboard" class="menu-item active" data-feature="dashboard"> <i class="fas fa-tachometer-alt"></i><span>Dashboard</span> </a> <a href="#projects" class="menu-item" data-feature="projects"> <i class="fas fa-briefcase"></i><span>Projects</span> </a> <a href="#reports-analytics" class="menu-item" data-feature="reports-analytics"> <i class="fas fa-chart-line"></i><span>Reports & Analytics</span> </a> <a href="#team-members-view" class="menu-item" data-feature="team-members-view"> <i class="fas fa-users"></i><span>Team Members</span> </a> <div class="menu-title">Core Features</div> <a href="#file-sharing" class="menu-item" data-feature="file-sharing"><i class="fas fa-file-upload"></i><span>File Sharing</span></a> <a href="#data-management" class="menu-item" data-feature="data-management"><i class="fas fa-database"></i><span>Data Management</span></a> <a href="#project-tracking" class="menu-item" data-feature="project-tracking"><i class="fas fa-project-diagram"></i><span>Project Tracking</span></a> <a href="#task-management" class="menu-item" data-feature="task-management"><i class="fas fa-tasks"></i><span>Task Management</span></a> <div class="menu-title">Team Tools</div> <a href="#employee-scheduling" class="menu-item" data-feature="employee-scheduling"><i class="fas fa-user-clock"></i><span>Employee Scheduling</span></a> <a href="#team-calendar" class="menu-item" data-feature="team-calendar"><i class="fas fa-calendar-alt"></i><span>Team Calendar</span></a> <a href="#deadline-tracking" class="menu-item" data-feature="deadline-tracking"><i class="fas fa-clock"></i><span>Deadline Tracking</span></a> <a href="#innovation-hub" class="menu-item" data-feature="innovation-hub"><i class="fas fa-lightbulb"></i><span>Innovation Hub</span></a> <div class="menu-divider"></div> <a href="#settings" class="menu-item" data-feature="settings"> <i class="fas fa-cog"></i><span>Settings</span> </a> <a href="#profile" class="menu-item" data-feature="profile"> <i class="fas fa-user-circle"></i><span>Profile</span> </a> </div> <div class="connection-status"> <div class="status-dot"></div> <span>Online</span> </div> </aside>
    <main class="main-content"> <nav class="top-nav"> <!-- Top Nav HTML --> <div class="search-bar"> <i class="fas fa-search search-icon"></i> <input type="text" placeholder="Search employees, projects, tasks..." id="searchInput" autocomplete="off"> <div class="search-results" id="searchResults"></div> </div> <div class="user-menu"> <div class="notification-icon" id="notificationIcon"> <i class="fas fa-bell"></i> <span class="notification-badge" style="display: none;">0</span> </div> <div class="user-profile"> <div class="user-avatar" id="userAvatar">ME</div> <div class="user-profile-details"> <span class="user-name" id="userName">Loading...</span> <span class="user-status"> • Connected</span> </div> <div class="user-dropdown" id="userDropdown"> <a href="#profile" class="dropdown-item" id="profileLink" data-feature="profile"><i class="fas fa-user"></i><span>Profile</span></a> <a href="#settings" class="dropdown-item" id="settingsLink" data-feature="settings"><i class="fas fa-cog"></i><span>Settings</span></a> <a href="#" class="dropdown-item" id="logoutLink"><i class="fas fa-sign-out-alt"></i><span>Logout</span></a> </div> </div> </div> </nav>
       <div class="content-area"> <div class="back-button" id="backButton" style="display: none;"> <i class="fas fa-arrow-left"></i> <span>Back</span> </div>
            <div id="dashboardContent" class="content-section active"> <!-- Dashboard Content HTML --> <div class="welcome-section"> <h2 class="welcome-title">Welcome, <span id="welcomeName">User</span>!</h2> <p class="welcome-subtitle">Here's what's happening with your team today.</p> <div class="user-info"> <div class="user-info-avatar" id="profileAvatar">U</div> <div class="user-info-details"> <div class="user-info-name">Loading User...</div> <div class="user-info-title" id="userInfoRoleTitle">Loading Role...</div> <div class="user-info-email"> <i class="fas fa-envelope"></i> <span id="userEmail">loading@email.com</span> </div> </div> </div> </div> <div class="stats-section"> <div class="stat-card"> <div class="stat-title"><i class="fas fa-users"></i>Team Members</div> <div class="stat-value"> <span id="teamMembersCount">0</span> <span class="stat-trend trend-neutral" id="teamMembersTrend"><i class="fas fa-minus"></i> 0%</span> </div> </div> <div class="stat-card"> <div class="stat-title"><i class="fas fa-check-circle"></i>Tasks Completed</div> <div class="stat-value"> <span id="tasksCompleted">0</span> <span class="stat-trend trend-neutral" id="tasksCompletedTrend"><i class="fas fa-minus"></i> 0%</span> </div> </div> <div class="stat-card"> <div class="stat-title"><i class="fas fa-project-diagram"></i>Active Projects</div> <div class="stat-value"> <span id="activeProjects">0</span> <span class="stat-trend trend-neutral" id="activeProjectsTrend"><i class="fas fa-minus"></i> 0%</span> </div> </div> <div class="stat-card"> <div class="stat-title"><i class="fas fa-calendar-times"></i>Upcoming Deadlines</div> <div class="stat-value"> <span id="upcomingDeadlines">0</span> <span class="stat-trend trend-neutral" id="upcomingDeadlinesTrend"><i class="fas fa-minus"></i> 0%</span> </div> </div> </div> <div class="activity-section"> <div class="section-header"> <h3 class="section-title">Recent Activity <span class="live-badge">LIVE</span></h3> <div> <span class="view-all" id="viewAllActivity" style="display: none;">Show All</span> <span class="delete-all" id="deleteAllActivity" style="display: none;">Delete All</span> </div> </div> <ul class="activity-list" id="activityList"> <li style="text-align: center; padding: 2rem; color: var(--gray);"> Loading activities... </li> </ul> </div> </div>
            <div class="content-section" id="profileContent"> <!-- Profile Content HTML --> <div class="section-main-header"> <h2 class="section-main-title">Profile</h2> </div> <p class="profile-header-text">Your personal information and account security settings.</p> <div class="profile-avatar-section"> <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: var(--dark);">Avatar</label> <div id="profileAvatarLarge">ME</div> <button type="button" class="btn btn-outline btn-sm" id="uploadPhotoButton"> <i class="fas fa-upload"></i> Upload Photo </button> <input type="file" id="profileAvatarInput" accept="image/*" style="display: none;"> </div> <form class="data-form" id="profileForm"> <div class="form-group"> <label for="firstName">First Name</label> <input type="text" id="firstName" class="form-control" value=""> </div> <div class="form-group"> <label for="lastName">Last Name</label> <input type="text" id="lastName" class="form-control" value=""> </div> <div class="form-group" style="grid-column: span 2;"> <label for="fullNameDisplay">Full Name</label> <input type="text" id="fullNameDisplay" class="form-control" value="" readonly> </div> <div class="form-group"> <label for="jobTitle">Job Title</label> <input type="text" id="jobTitle" class="form-control" value=""> </div> <div class="form-group"> <label for="email">Email</label> <input type="email" id="email" class="form-control" value="" readonly> </div> <div class="form-group"> <label for="phone">Phone Number</label> <input type="tel" id="phone" class="form-control" value=""> </div> <div class="form-group"> <label for="department">Department</label> <input type="text" id="department" class="form-control" value=""> </div> <div class="form-actions"> <button type="button" class="btn btn-outline" id="cancelProfileBtn">Cancel</button> <button type="submit" class="btn btn-primary">Save Changes</button> </div> </form> </div>
            <div class="content-section" id="settingsContent"> <!-- Settings Content HTML --> <div class="section-main-header"> <h2 class="section-main-title">System Settings</h2> </div> <div class="settings-tabs"> <div class="settings-tab active" data-tab="preferences">Preferences</div> <div class="settings-tab" data-tab="account">Account</div> <div class="settings-tab" data-tab="security">Security</div> <div class="settings-tab" data-tab="notifications">Notifications</div> <div class="settings-tab" data-tab="team" id="teamSettingsTab">Team Management</div> <div class="settings-tab" data-tab="collaboration">Collaboration</div> <div class="settings-tab" data-tab="danger" id="dangerZoneTab">Danger Zone</div> </div> <div class="settings-panel active" id="preferencesPanel"> <h3 class="section-title">Preferences</h3> <form class="data-form" id="preferencesForm"> <!-- Preferences Form --> </form> </div> <div class="settings-panel" id="accountPanel"> <h3 class="section-title">Account Settings</h3> <form class="data-form" id="accountForm"> <!-- Account Form --> </form> </div> <div class="settings-panel" id="securityPanel"> <h3 class="section-title">Security Settings</h3> <form class="data-form" id="securityForm"> <!-- Security Form --> </form> </div> <div class="settings-panel" id="notificationsPanel"> <h3 class="section-title">Notification Settings</h3> <form class="data-form" id="notificationsForm"> <!-- Notifications Form --> </form> </div> <div class="settings-panel" id="teamPanel"> <div class="team-management"> <h3>Team Members</h3> <div class="team-list" id="teamList"> <!-- Team List --> </div> <div class="add-member-form"> <h4>Invite New Member</h4> <form id="inviteMemberForm" class="data-form" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); align-items: end; gap: 1rem;"> <!-- Invite Form --> </form> </div> </div> </div> <div class="settings-panel" id="collaborationPanel"> <h3 class="section-title">Collaboration Settings</h3> <form class="data-form" id="collaborationForm"> <!-- Collaboration Form --> </form> </div> <div class="settings-panel" id="dangerPanel"> <h3 class="section-title" style="color: var(--danger);">Danger Zone</h3> <!-- Danger Zone Content --> </div> </div>
            <div id="featureSectionsContainer" class="content-section"> <div id="featureSections"> <div class="placeholder-content" id="featurePlaceholder"> <h2 id="featureTitle">Feature Content Area</h2> <p id="featureDescription">Select a feature from the sidebar.</p> <div class="loading-indicator" style="display: none;"> <i class="fas fa-spinner fa-spin"></i> Loading... </div> <div class="error-message" style="display: none;"> Failed to load content. </div> </div> </div> </div>
       </div>
    </main>
    <div class="notifications-modal" id="notificationsModal"> <!-- Notification Modal HTML --> <div class="notifications-container"> <div class="notifications-header"> <h3 class="notifications-title">Notifications</h3> <button class="close-notifications" id="closeNotifications">×</button> </div> <div class="notifications-body" id="notificationsBody"> <div class="no-notifications-message">Loading notifications...</div> </div> <div class="notifications-footer"> <button class="btn btn-outline btn-sm" id="markAllReadBtn">Mark All as Read</button> <button class="btn btn-danger btn-sm" id="deleteAllNotificationsBtn">Delete All</button> </div> </div> </div>
    <div class="confirm-modal" id="confirmModal"> <!-- Confirm Modal HTML --> <div class="confirm-container"> <h3 class="confirm-title" id="confirmTitle">Confirm Action</h3> <div class="confirm-message" id="confirmMessage">Are you sure you want to proceed?</div> <div class="confirm-actions"> <button class="btn btn-outline" id="cancelConfirmBtn">Cancel</button> <button class="btn btn-danger" id="confirmBtn">Confirm</button> </div> </div> </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Main variables and elements
            const sidebar = document.getElementById('sidebar');
            const menuItems = document.querySelectorAll('.menu-item');
            const contentSections = document.querySelectorAll('.content-section');
            const dashboardContent = document.getElementById('dashboardContent');
            const profileContent = document.getElementById('profileContent');
            const settingsContent = document.getElementById('settingsContent');
            const featureSectionsContainer = document.getElementById('featureSectionsContainer');
            const backButton = document.getElementById('backButton');
            const userDropdown = document.getElementById('userDropdown');
            const profileLink = document.getElementById('profileLink');
            const settingsLink = document.getElementById('settingsLink');
            
            // Default user data
            const DEFAULT_USER = {
                id: 1,
                name: 'Mohamed Elmenisy',
                email: 'm.elsayed@thechefz.co',
                title: 'Administrator',
                department: 'Management',
                phone: '+201234567890',
                avatar: '',
                initials: 'ME',
                role: 'admin'
            };
            
            let currentUser = DEFAULT_USER;
            let currentFeature = 'dashboard';
            
            // Initialize the dashboard
            function initDashboard() {
                updateUserUI();
                setupEventListeners();
                handleInitialNavigation();
            }
            
            // Update user interface with current user data
            function updateUserUI() {
                document.getElementById('userName').textContent = currentUser.name;
                document.getElementById('welcomeName').textContent = currentUser.name.split(' ')[0];
                document.getElementById('userEmail').textContent = currentUser.email;
                document.getElementById('userAvatar').textContent = currentUser.initials;
                document.getElementById('profileAvatar').textContent = currentUser.initials;
                document.getElementById('profileAvatarLarge').textContent = currentUser.initials;
                
                // Update profile form fields
                const nameParts = currentUser.name.split(' ');
                document.getElementById('firstName').value = nameParts[0] || '';
                document.getElementById('lastName').value = nameParts.slice(1).join(' ') || '';
                document.getElementById('fullNameDisplay').value = currentUser.name;
                document.getElementById('jobTitle').value = currentUser.title || '';
                document.getElementById('email').value = currentUser.email || '';
                document.getElementById('phone').value = currentUser.phone || '';
                document.getElementById('department').value = currentUser.department || '';
                
                // Update role title
                const roleTitle = document.getElementById('userInfoRoleTitle');
                roleTitle.textContent = currentUser.role === 'admin' ? 'Team Manager' : 
                                      currentUser.role === 'supervisor' ? 'Team Supervisor' : 'Team Member';
                if (currentUser.role === 'admin') {
                    roleTitle.classList.add('role-admin');
                }
            }
            
            // Set active feature/section
            function setActiveFeature(featureId, settingsTab = null) {
                console.log(`Setting active feature: ${featureId} with tab: ${settingsTab}`);
                
                // Update menu items
                menuItems.forEach(item => {
                    item.classList.remove('active');
                    if (item.getAttribute('data-feature') === featureId) {
                        item.classList.add('active');
                    }
                });
                
                // Hide all content sections
                contentSections.forEach(section => {
                    section.classList.remove('active');
                });
                
                // Show the appropriate content section
                if (featureId === 'dashboard') {
                    dashboardContent.classList.add('active');
                    backButton.style.display = 'none';
                } 
                else if (featureId === 'profile') {
                    profileContent.classList.add('active');
                    backButton.style.display = 'flex';
                } 
                else if (featureId === 'settings') {
                    settingsContent.classList.add('active');
                    backButton.style.display = 'flex';
                    if (settingsTab) {
                        activateSettingsTab(settingsTab);
                    }
                } 
                else {
                    // For other features, show the feature container
                    featureSectionsContainer.classList.add('active');
                    backButton.style.display = 'flex';
                    
                    // Update feature placeholder content
                    const featureTitle = document.getElementById('featureTitle');
                    const featureDesc = document.getElementById('featureDescription');
                    
                    // Find the menu item to get the feature name
                    const menuItem = Array.from(menuItems).find(item => 
                        item.getAttribute('data-feature') === featureId);
                    
                    if (menuItem) {
                        const featureName = menuItem.querySelector('span').textContent;
                        featureTitle.textContent = featureName;
                        featureDesc.textContent = `This is the ${featureName} section. Content will be loaded here.`;
                    }
                    
                    // Special handling for employee scheduling
                    if (featureId === 'employee-scheduling') {
                        initializeEmployeeSchedule(currentUser, [
                            {id: 1, name: 'Mohamed Elmenisy', email: 'm.elsayed@thechefz.co', role: 'admin'},
                            {id: 2, name: 'Yousef Ahmed', email: 'yousef@example.com', role: 'supervisor'},
                            {id: 3, name: 'Esraa Lashin', email: 'esraa@example.com', role: 'member'},
                            {id: 4, name: 'Bassant Badr', email: 'bassant@example.com', role: 'member'}
                        ]);
                    }
                }
                
                currentFeature = featureId;
                updateBrowserHistory(featureId, settingsTab);
            }
            
            // Activate settings tab
            function activateSettingsTab(tabId) {
                console.log(`Activating settings tab: ${tabId}`);
                
                // Update tabs
                document.querySelectorAll('.settings-tab').forEach(tab => {
                    tab.classList.remove('active');
                    if (tab.getAttribute('data-tab') === tabId) {
                        tab.classList.add('active');
                    }
                });
                
                // Update panels
                document.querySelectorAll('.settings-panel').forEach(panel => {
                    panel.classList.remove('active');
                    if (panel.id === `${tabId}Panel`) {
                        panel.classList.add('active');
                    }
                });
            }
            
            // Update browser history
            function updateBrowserHistory(featureId, settingsTab = null) {
                let hash = `#${featureId}`;
                if (featureId === 'settings' && settingsTab) {
                    hash += `-${settingsTab}`;
                }
                
                if (window.location.hash !== hash) {
                    window.history.pushState(null, null, hash);
                }
            }
            
            // Handle initial navigation based on URL hash
            function handleInitialNavigation() {
                const hash = window.location.hash.substring(1);
                console.log(`Initial hash: ${hash}`);
                
                if (!hash) {
                    setActiveFeature('dashboard');
                    return;
                }
                
                // Check if it's a settings tab
                if (hash.startsWith('settings-')) {
                    const tabId = hash.split('-')[1];
                    setActiveFeature('settings', tabId);
                } 
                else if (hash === 'profile' || hash === 'settings' || hash === 'dashboard') {
                    setActiveFeature(hash);
                } 
                else {
                    // For other features, set as active
                    setActiveFeature(hash);
                }
            }
            
            // Setup event listeners
            function setupEventListeners() {
                // Sidebar menu items
                menuItems.forEach(item => {
                    item.addEventListener('click', function(e) {
                        e.preventDefault();
                        const featureId = this.getAttribute('data-feature');
                        setActiveFeature(featureId);
                    });
                });
                
                // Settings tabs
                document.querySelectorAll('.settings-tab').forEach(tab => {
                    tab.addEventListener('click', function() {
                        const tabId = this.getAttribute('data-tab');
                        activateSettingsTab(tabId);
                        updateBrowserHistory('settings', tabId);
                    });
                });
                
                // Back button
                backButton.addEventListener('click', function() {
                    setActiveFeature('dashboard');
                });
                
                // User dropdown
                document.querySelector('.user-profile').addEventListener('click', function() {
                    userDropdown.classList.toggle('active');
                });
                
                // Profile and settings links in dropdown
                profileLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    setActiveFeature('profile');
                    userDropdown.classList.remove('active');
                });
                
                settingsLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    setActiveFeature('settings');
                    userDropdown.classList.remove('active');
                });
                
                // Handle window hash changes
                window.addEventListener('hashchange', function() {
                    handleInitialNavigation();
                });
            }
            
            // Initialize employee scheduling (simplified version)
            function initializeEmployeeSchedule(user, members) {
                console.log("Initializing employee schedule...");
                const featureContainer = document.getElementById('featureSections');
                
                // Create a simple schedule interface
                const scheduleHTML = `
                    <div class="section-main-header">
                        <h2 class="section-main-title">Employee Scheduling</h2>
                    </div>
                    <div class="schedule-controls">
                        <button class="btn btn-outline" id="prevWeekBtn">
                            <i class="fas fa-chevron-left"></i> Previous Week
                        </button>
                        <span id="weekDisplay" style="margin: 0 1rem; font-weight: 500;">Loading...</span>
                        <button class="btn btn-outline" id="nextWeekBtn">
                            Next Week <i class="fas fa-chevron-right"></i>
                        </button>
                        ${user.role === 'admin' ? `
                        <button class="btn btn-primary" id="addEmployeeBtn" style="margin-left: auto;">
                            <i class="fas fa-user-plus"></i> Add Employee
                        </button>
                        <button class="btn btn-success" id="sendRemindersBtn">
                            <i class="fas fa-envelope"></i> Send Reminders
                        </button>
                        <button class="btn btn-primary" id="saveScheduleBtn">
                            <i class="fas fa-save"></i> Save Schedule
                        </button>` : ''}
                    </div>
                    <div class="schedule-container">
                        <div style="overflow-x: auto;">
                            <table class="schedule-table">
                                <thead>
                                    <tr>
                                        <th>Employee</th>
                                        <th>Monday</th>
                                        <th>Tuesday</th>
                                        <th>Wednesday</th>
                                        <th>Thursday</th>
                                        <th>Friday</th>
                                        <th>Saturday</th>
                                        <th>Sunday</th>
                                    </tr>
                                </thead>
                                <tbody id="scheduleTableBody">
                                    <!-- Schedule content will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                `;
                
                featureContainer.innerHTML = scheduleHTML;
                
                // Simulate loading schedule data
                setTimeout(() => {
                    const tableBody = document.getElementById('scheduleTableBody');
                    if (tableBody) {
                        tableBody.innerHTML = members.map(member => `
                            <tr>
                                <td class="employee-name">${member.name}</td>
                                <td class="admin-controls ${user.role === 'admin' ? 'editable' : ''}">
                                    <div class="shift shift-morning">9AM-5PM</div>
                                </td>
                                <td class="admin-controls ${user.role === 'admin' ? 'editable' : ''}">
                                    <div class="shift shift-afternoon">12PM-8PM</div>
                                </td>
                                <td class="admin-controls ${user.role === 'admin' ? 'editable' : ''}">
                                    <div class="shift shift-morning">9AM-5PM</div>
                                </td>
                                <td class="admin-controls ${user.role === 'admin' ? 'editable' : ''}">
                                    <div class="shift shift-day-off">OFF</div>
                                </td>
                                <td class="admin-controls ${user.role === 'admin' ? 'editable' : ''}">
                                    <div class="shift shift-morning">9AM-5PM</div>
                                </td>
                                <td class="admin-controls ${user.role === 'admin' ? 'editable' : ''}">
                                    <div class="shift shift-day-off">OFF</div>
                                </td>
                                <td class="admin-controls ${user.role === 'admin' ? 'editable' : ''}">
                                    <div class="shift shift-day-off">OFF</div>
                                </td>
                            </tr>
                        `).join('');
                        
                        // Update week display
                        const weekDisplay = document.getElementById('weekDisplay');
                        if (weekDisplay) {
                            const today = new Date();
                            const startOfWeek = new Date(today);
                            startOfWeek.setDate(today.getDate() - today.getDay() + 1);
                            
                            const endOfWeek = new Date(startOfWeek);
                            endOfWeek.setDate(startOfWeek.getDate() + 6);
                            
                            weekDisplay.textContent = `${startOfWeek.toLocaleDateString()} - ${endOfWeek.toLocaleDateString()}`;
                        }
                    }
                }, 500);
            }
            
            // Start the application
            initDashboard();
        });
    </script>
</body>
</html>
